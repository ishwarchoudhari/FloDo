(()=>{(function(){function a(e,n){return(n||document).querySelector(e)}function u(e,n){return Array.from((n||document).querySelectorAll(e))}function c(e){try{e==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",e),l(e)}catch{}}function l(e){try{var n=e?e==="dark":document.documentElement.classList.contains("dark"),s=a("#icon-sun"),t=a("#icon-moon"),i=a("#icon-sun-mobile"),o=a("#icon-moon-mobile");s&&(s.style.display=n?"":"none"),t&&(t.style.display=n?"none":""),i&&(i.style.display=n?"":"none"),o&&(o.style.display=n?"none":"")}catch{}}function r(){var e=a("#user-menu-btn"),n=a("#user-menu-panel"),s=a("#user-menu-btn-mobile"),t=a("#user-menu-panel-mobile");function i(d){d&&d.classList.toggle("hidden")}function o(d){d&&d.classList.remove("hidden")}function v(d){d&&d.classList.add("hidden")}e&&n&&e.addEventListener("click",function(d){d.preventDefault(),d.stopPropagation(),i(n),e.setAttribute("aria-expanded",String(!n.classList.contains("hidden")))}),s&&t&&s.addEventListener("click",function(d){d.preventDefault(),d.stopPropagation(),i(t),s.setAttribute("aria-expanded",String(!t.classList.contains("hidden")))}),document.addEventListener("click",function(d){var h=d.target;n&&!n.contains(h)&&e&&!e.contains(h)&&v(n),t&&!t.contains(h)&&s&&!s.contains(h)&&v(t)}),document.addEventListener("keydown",function(d){d.key==="Escape"&&(v(n),v(t))})}function f(){try{var e=localStorage.getItem("theme");if(e==="dark"||e==="light")return e;if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}catch{}return"light"}function m(){var e=[a("#btn-theme"),a("#btn-theme-mobile")].filter(Boolean);e.length&&e.forEach(function(n){n.addEventListener("click",function(){var s=document.documentElement.classList.contains("dark")?"light":"dark";c(s)})})}function w(){var e=a("#btn-mobile"),n=a("#mobile-nav");!e||!n||e.addEventListener("click",function(){var s=n.classList.contains("hidden");s?n.classList.remove("hidden"):n.classList.add("hidden");try{e.setAttribute("aria-expanded",String(s))}catch{}})}function p(){var e=a("#notif-dot"),n=a("#btn-bell");if(n){var s=location.protocol==="https:"?"wss://":"ws://",t=s+location.host+"/ws/notifications/";try{var i=new WebSocket(t);i.onopen=function(){},i.onmessage=function(o){try{var v=JSON.parse(o.data);e&&e.classList.remove("hidden")}catch{e&&e.classList.remove("hidden")}},i.onclose=function(){},n.addEventListener("click",function(o){e&&e.classList.add("hidden")})}catch{}}}function y(e){var n="; "+document.cookie,s=n.split("; "+e+"=");if(s.length===2)return s.pop().split(";").shift()}function g(e,n){if(n=n||{},n.headers=n.headers||{},(n.method||"GET").toUpperCase()!=="GET"){var s=y("csrftoken");s&&(n.headers["X-CSRFToken"]=s)}return fetch(e,n)}window.PortalAjax=g;function b(){c(f()),l(),m(),w(),p(),r(),initStickySearch(),initFiltersDrawer(),initAjaxNavigation()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",b):b()})();(function(){if(window.initAjaxNavigation)return;function a(t,i){return(i||document).querySelector(t)}var u,c;function l(){return u||(u=document.createElement("div"),u.id="ajax-progress",Object.assign(u.style,{position:"fixed",top:"0",left:"0",width:"0%",height:"2px",background:"linear-gradient(90deg,#10b981,#22d3ee,#a78bfa)",boxShadow:"0 0 8px rgba(16,185,129,.6)",zIndex:"99999",transition:"width .2s ease, opacity .2s ease",opacity:"0"}),document.body.appendChild(u),u)}function r(){l(),u.style.opacity="1",f(5),c&&clearInterval(c),c=setInterval(function(){var t=parseFloat(u.style.width)||0;t<90&&f(t+Math.max(1,(90-t)*.05))},200)}function f(t){l(),u.style.width=Math.max(0,Math.min(100,t))+"%"}function m(){u&&(f(100),setTimeout(function(){u.style.opacity="0",u.style.width="0%",c&&(clearInterval(c),c=null)},250))}function w(t){try{var i=new URL(t,location.href);return i.origin===location.origin}catch{return!1}}function p(t){if(t.defaultPrevented||t.button!==0||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return!1;var i=t.target.closest("a");if(!i||i.target&&i.target!==""&&i.target!=="_self")return!1;var o=i.getAttribute("href");return!(!o||o.startsWith("#")||i.hasAttribute("download")||i.getAttribute("rel")==="external"||i.dataset.noAjax==="true"||!w(o))}function y(){document.body.setAttribute("aria-busy","true"),document.documentElement.style.cursor="progress"}function g(){document.body.removeAttribute("aria-busy"),document.documentElement.style.cursor=""}function b(t){var i=t.querySelector("#content-root"),o=a("#content-root");if(!i||!o)return!1;o.innerHTML=i.innerHTML;try{var v=Array.from(o.querySelectorAll("script"));v.forEach(function(h){for(var L=document.createElement("script"),S=0;S<h.attributes.length;S++){var k=h.attributes[S];try{L.setAttribute(k.name,k.value)}catch{}}L.textContent=h.textContent||"",document.body.appendChild(L),setTimeout(function(){try{L.remove()}catch{}},0)})}catch{}try{o.classList.add("pjax-fade"),o.addEventListener("animationend",function h(){o.classList.remove("pjax-fade"),o.removeEventListener("animationend",h)},{once:!0})}catch{}var d=t.querySelector("title");d&&(document.title=d.textContent);try{window.initStickySearch&&window.initStickySearch(),window.initFiltersDrawer&&window.initFiltersDrawer(),typeof initUserMenu=="function"&&initUserMenu(),typeof updateThemeIcons=="function"&&updateThemeIcons(),typeof window.initAuthPage=="function"&&window.initAuthPage(),typeof window.initStandaloneSignup=="function"&&window.initStandaloneSignup()}catch{}return!0}function e(t,i){return y(),r(),fetch(t,{headers:{"X-Requested-With":"fetch"},credentials:"same-origin"}).then(function(o){if(!o.ok)throw new Error("HTTP "+o.status);return o.text()}).then(function(o){var v=new DOMParser().parseFromString(o,"text/html");if(!b(v)){location.href=t;return}i&&history.pushState({url:t},"",t)}).catch(function(){location.href=t}).finally(function(){g(),m()})}function n(t){if(p(t)){var i=t.target.closest("a"),o=new URL(i.getAttribute("href"),location.href).toString();t.preventDefault(),e(o,!0)}}function s(){e(location.href,!1)}window.initAjaxNavigation=function(){document.addEventListener("click",n),window.addEventListener("popstate",s)}})();(function(){function a(c,l){return(l||document).querySelector(c)}function u(c,l){let r=0;return function(){let f=Date.now();if(f-r>l)return r=f,c.apply(this,arguments)}}window.initStickySearch=function(){var c=a("header"),l=!1;if(c){var r=u(function(){var f=window.scrollY||window.pageYOffset||0;f>80&&!l?(l=!0,c.classList.add("shadow-lg")):f<=80&&l&&(l=!1,c.classList.remove("shadow-lg"))},100);window.addEventListener("scroll",r,{passive:!0})}},window.initFiltersDrawer=function(){var c=a("#btn-filters"),l=a("#filters-drawer");!c||!l||c.addEventListener("click",function(){l.classList.toggle("hidden")})}})();(function(){function a(r,f){return(f||document).querySelector(r)}function u(){var r=document.getElementById("toast-root");return r||(r=document.createElement("div"),r.id="toast-root",r.style.position="fixed",r.style.right="1rem",r.style.bottom="1rem",r.style.zIndex="9999",document.body.appendChild(r),r)}function c(r){var f=u(),m=document.createElement("div");m.className="mb-2 px-4 py-3 rounded-lg text-sm text-white shadow-lg bg-gradient-to-tr from-pink-600 to-fuchsia-600 opacity-0 translate-y-2 transition duration-300",m.textContent=r||"Notification",f.appendChild(m),requestAnimationFrame(function(){m.classList.remove("opacity-0","translate-y-2")}),setTimeout(function(){m.classList.add("opacity-0","translate-y-2"),setTimeout(function(){m.remove()},300)},4e3)}var l=window.initNotifications;window.initNotifications=function(){var r=a("#notif-dot"),f=a("#btn-bell"),m=location.protocol==="https:"?"wss://":"ws://",w=m+location.host+"/ws/notifications/";try{var p=new WebSocket(w);p.onmessage=function(y){try{var g=JSON.parse(y.data);c(g.title||"Update")}catch{c("Update")}r&&r.classList.remove("hidden")},p.onopen=function(){},p.onclose=function(){},f&&f.addEventListener("click",function(){r&&r.classList.add("hidden")})}catch{}}})();})();
//# sourceMappingURL=portal_base.js.map
