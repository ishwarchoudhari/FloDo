(()=>{(function(){function i(e,t){return(t||document).querySelector(e)}function v(e,t){return Array.from((t||document).querySelectorAll(e))}function a(e){try{e==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",e)}catch{}}function c(){var e=i("#user-menu-btn"),t=i("#user-menu-panel"),r=i("#user-menu-btn-mobile"),l=i("#user-menu-panel-mobile");function u(o){o&&o.classList.toggle("hidden")}function w(o){o&&o.classList.remove("hidden")}function m(o){o&&o.classList.add("hidden")}e&&t&&e.addEventListener("click",function(o){o.preventDefault(),o.stopPropagation(),u(t),e.setAttribute("aria-expanded",String(!t.classList.contains("hidden")))}),r&&l&&r.addEventListener("click",function(o){o.preventDefault(),o.stopPropagation(),u(l),r.setAttribute("aria-expanded",String(!l.classList.contains("hidden")))}),document.addEventListener("click",function(o){var y=o.target;t&&!t.contains(y)&&e&&!e.contains(y)&&m(t),l&&!l.contains(y)&&r&&!r.contains(y)&&m(l)}),document.addEventListener("keydown",function(o){o.key==="Escape"&&(m(t),m(l))})}function n(){try{var e=localStorage.getItem("theme");if(e==="dark"||e==="light")return e;if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}catch{}return"light"}function s(){var e=i("#btn-theme");e&&e.addEventListener("click",function(){var t=n()==="dark"?"light":"dark";a(t);try{i("#icon-sun")&&(i("#icon-sun").style.display=t==="dark"?"":"none"),i("#icon-moon")&&(i("#icon-moon").style.display=t==="dark"?"none":"")}catch{}})}function d(){var e=i("#btn-mobile"),t=i("#mobile-nav");!e||!t||e.addEventListener("click",function(){var r=t.classList.contains("hidden");r?t.classList.remove("hidden"):t.classList.add("hidden")})}function g(){var e=i("#notif-dot"),t=i("#btn-bell");if(t){var r=location.protocol==="https:"?"wss://":"ws://",l=r+location.host+"/ws/notifications/";try{var u=new WebSocket(l);u.onopen=function(){},u.onmessage=function(w){try{var m=JSON.parse(w.data);e&&e.classList.remove("hidden")}catch{e&&e.classList.remove("hidden")}},u.onclose=function(){},t.addEventListener("click",function(w){e&&e.classList.add("hidden")})}catch{}}}function f(e){var t="; "+document.cookie,r=t.split("; "+e+"=");if(r.length===2)return r.pop().split(";").shift()}function h(e,t){if(t=t||{},t.headers=t.headers||{},(t.method||"GET").toUpperCase()!=="GET"){var r=f("csrftoken");r&&(t.headers["X-CSRFToken"]=r)}return fetch(e,t)}window.PortalAjax=h;function p(){a(n()),s(),d(),g(),c(),initStickySearch(),initFiltersDrawer()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p()})();(function(){function i(a,c){return(c||document).querySelector(a)}function v(a,c){let n=0;return function(){let s=Date.now();if(s-n>c)return n=s,a.apply(this,arguments)}}window.initStickySearch=function(){var a=i("header"),c=!1;if(a){var n=v(function(){var s=window.scrollY||window.pageYOffset||0;s>80&&!c?(c=!0,a.classList.add("shadow-lg")):s<=80&&c&&(c=!1,a.classList.remove("shadow-lg"))},100);window.addEventListener("scroll",n,{passive:!0})}},window.initFiltersDrawer=function(){var a=i("#btn-filters"),c=i("#filters-drawer");!a||!c||a.addEventListener("click",function(){c.classList.toggle("hidden")})}})();(function(){function i(n,s){return(s||document).querySelector(n)}function v(){var n=document.getElementById("toast-root");return n||(n=document.createElement("div"),n.id="toast-root",n.style.position="fixed",n.style.right="1rem",n.style.bottom="1rem",n.style.zIndex="9999",document.body.appendChild(n),n)}function a(n){var s=v(),d=document.createElement("div");d.className="mb-2 px-4 py-3 rounded-lg text-sm text-white shadow-lg bg-gradient-to-tr from-pink-600 to-fuchsia-600 opacity-0 translate-y-2 transition duration-300",d.textContent=n||"Notification",s.appendChild(d),requestAnimationFrame(function(){d.classList.remove("opacity-0","translate-y-2")}),setTimeout(function(){d.classList.add("opacity-0","translate-y-2"),setTimeout(function(){d.remove()},300)},4e3)}var c=window.initNotifications;window.initNotifications=function(){var n=i("#notif-dot"),s=i("#btn-bell"),d=location.protocol==="https:"?"wss://":"ws://",g=d+location.host+"/ws/notifications/";try{var f=new WebSocket(g);f.onmessage=function(h){try{var p=JSON.parse(h.data);a(p.title||"Update")}catch{a("Update")}n&&n.classList.remove("hidden")},f.onopen=function(){},f.onclose=function(){},s&&s.addEventListener("click",function(){n&&n.classList.add("hidden")})}catch{}}})();})();
//# sourceMappingURL=portal_base.js.map
