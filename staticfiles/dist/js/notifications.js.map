{
  "version": 3,
  "sources": ["../../js/notifications.js"],
  "sourcesContent": ["// notifications.js\r\n// Lightweight header notifications with polling and badge update.\r\n\r\n(function(){\r\n  // Enforce top padding 6rem when sidebar layout is present\r\n  function ensureContentTopPadding(){\r\n    try {\r\n      const root = document.getElementById('content-root');\r\n      if (!root) return;\r\n      // Sidebar layout indicator: main has md:ml-64 class in this project\r\n      const hasSidebarLayout = root.classList.contains('md:ml-64');\r\n      if (!hasSidebarLayout) return;\r\n      // Only adjust if Tailwind pt-16 is present\r\n      if (!root.classList.contains('pt-16')) return;\r\n      // Inject a scoped override style once\r\n      if (!document.getElementById('contentPaddingOverride')){\r\n        const style = document.createElement('style');\r\n        style.id = 'contentPaddingOverride';\r\n        style.textContent = '#content-root.pt-16{padding-top:6rem !important;}';\r\n        document.head.appendChild(style);\r\n      }\r\n    } catch(_){ }\r\n  }\r\n  if (document.readyState === 'loading'){\r\n    document.addEventListener('DOMContentLoaded', ensureContentTopPadding);\r\n  } else {\r\n    ensureContentTopPadding();\r\n  }\r\n  const POLL_MS = 3000; // unified 3s\r\n  const LS_TS_KEY = 'notifLastSeen'; // legacy timestamp-based\r\n  const LS_ID_KEY = 'notifLastSeenId'; // preferred when API returns stable log IDs\r\n  const DEBUG = (typeof window !== 'undefined' && window.DEBUG_NOTIF === true);\r\n  function dlog(){ try { if (DEBUG && typeof console !== 'undefined' && console.debug) console.debug('[notif]', ...arguments); } catch(_){} }\r\n\r\n  function qs(id){ return document.getElementById(id); }\r\n  function initials(name){\r\n    if (!name || typeof name !== 'string') return '?';\r\n    return name.trim().charAt(0).toUpperCase();\r\n  }\r\n  function timeAgo(iso){\r\n    try {\r\n      const d = new Date(iso);\r\n      const now = new Date();\r\n      const sec = Math.max(0, Math.floor((now - d) / 1000));\r\n      if (sec < 10) return 'just now';\r\n      if (sec < 60) return `${sec}s ago`;\r\n      const min = Math.floor(sec / 60);\r\n      if (min < 60) return `${min} min ago`;\r\n      const hr = Math.floor(min / 60);\r\n      if (hr < 24) return `${hr} h ago`;\r\n      const day = Math.floor(hr / 24);\r\n      if (day < 7) return `${day} d ago`;\r\n      // fallback to locale for older items\r\n      return d.toLocaleString();\r\n    } catch { return iso; }\r\n  }\r\n\r\n  async function fetchRecent(perPage){\r\n    try{\r\n      const nocache = Date.now();\r\n      const res = await fetch(`/dashboard/api/logs/?per_page=${perPage||10}&_=${nocache}`, {\r\n        headers: { 'X-Requested-With': 'XMLHttpRequest' },\r\n        credentials: 'same-origin',\r\n        cache: 'no-store'\r\n      });\r\n      if (!res.ok){\r\n        try { dlog('fetchRecent non-ok', { status: res.status }); } catch(_){ }\r\n      }\r\n      let data = null;\r\n      try { data = await res.json(); }\r\n      catch(e){ try { dlog('fetchRecent json parse error', e); } catch(_){ } }\r\n      if (!data || !data.success){\r\n        try { dlog('fetchRecent no data or success=false', data); } catch(_){ }\r\n        return [];\r\n      }\r\n      return data.results || [];\r\n    }catch(e){ try { dlog('fetchRecent failed', e); } catch(_){ } return []; }\r\n  }\r\n\r\n  function dedupeItems(items){\r\n    if (!Array.isArray(items) || items.length === 0) return [];\r\n    const out = [];\r\n    const seen = new Set();\r\n    // Prefer unique key by stable id; fallback to a composite signature\r\n    for (const it of items){\r\n      const key = (typeof it.id !== 'undefined') ? `id:${it.id}` : `sig:${it.timestamp}|${it.action}|${it.table_name}|${it.row_id}|${it.admin_user}`;\r\n      if (seen.has(key)) continue;\r\n      seen.add(key);\r\n      out.push(it);\r\n    }\r\n    return out;\r\n  }\r\n\r\n  function ensureNotifStyles(){\r\n    if (document.getElementById('notifGlowStyles')) return;\r\n    const style = document.createElement('style');\r\n    style.id = 'notifGlowStyles';\r\n    style.textContent = `\r\n@keyframes notifPulse{0%{box-shadow:0 0 0 0 rgba(59,130,246,.28)}70%{box-shadow:0 0 0 10px rgba(59,130,246,0)}100%{box-shadow:0 0 0 0 rgba(59,130,246,0)}}\r\n@keyframes notifGlowOut{0%{background-color:rgba(59,130,246,0.06)}100%{background-color:transparent}}\r\n.notif-new{background-color:rgba(59,130,246,0.06); animation:notifPulse 1800ms ease-out infinite}\r\n.dark .notif-new{background-color:rgba(59,130,246,0.12)}\r\n.notif-fade{animation:notifGlowOut 600ms ease-out 1}\r\n/* Bell attention/fade visuals (SOC: notifications-only) */\r\n#notifBtn svg{ transition: color 400ms ease, fill 800ms ease, stroke 400ms ease; }\r\n.notif-bell-attn{ color:#FF9B00 !important; }\r\n.notif-bell-attn path{ fill: rgba(255,155,0,0.25) !important; }\r\n@keyframes notifBellFade { 0%{ color:#FF9B00; } 100%{ color:#374151; } }\r\n@keyframes notifBellFillFade { 0%{ fill: rgba(255,155,0,0.25); } 100%{ fill: transparent; } }\r\n.notif-bell-fade{ animation: notifBellFade 1200ms ease forwards; }\r\n.notif-bell-fade path{ animation: notifBellFillFade 1200ms ease forwards; }\r\n`;\r\n    document.head.appendChild(style);\r\n  }\r\n\r\n  function renderList(items){\r\n    const list = qs('notifList');\r\n    const empty = qs('notifEmpty');\r\n    if (!list || !empty) return;\r\n    dlog('renderList', { count: (items && items.length) || 0 });\r\n    list.innerHTML = '';\r\n    if (!items.length){\r\n      empty.classList.remove('hidden');\r\n      return;\r\n    }\r\n    empty.classList.add('hidden');\r\n    ensureNotifStyles();\r\n\r\n    // Determine which items are new relative to last seen (prefer ID)\r\n    const last = getLastSeen();\r\n    const newIdSet = new Set();\r\n    if (items.length && typeof items[0].id !== 'undefined' && last.id){\r\n      for (const it of items){\r\n        if (String(it.id) === String(last.id)) break;\r\n        newIdSet.add(String(it.id));\r\n      }\r\n    }\r\n\r\n    const now = Date.now();\r\n    items.forEach(it => {\r\n      const li = document.createElement('li');\r\n      const unseenById = (typeof it.id !== 'undefined') ? newIdSet.has(String(it.id)) : false;\r\n      const unseenByTs = (!unseenById && last.ts) ? (it.timestamp > last.ts) : false;\r\n      // Persist pulsing highlight for up to 1 minute after arrival, even if marked as seen\r\n      let withinOneMinute = false;\r\n      try { withinOneMinute = Math.abs(now - new Date(it.timestamp).getTime()) <= 60 * 1000; } catch {}\r\n      const shouldHighlight = withinOneMinute;\r\n      li.className = [\r\n        'p-3 rounded-lg border shadow-sm transition-all duration-200 hover:shadow-md hover:-translate-y-px will-change-transform',\r\n        // Base backgrounds (light + dark)\r\n        'bg-white dark:bg-gray-800',\r\n        // Borders (light + dark)\r\n        'border-gray-200 dark:border-gray-700',\r\n        // Text color (ensure readability in dark)\r\n        'text-gray-900 dark:text-gray-100',\r\n        // Hover backgrounds respecting theme\r\n        'hover:bg-white dark:hover:bg-gray-800',\r\n        shouldHighlight ? 'notif-new' : ''\r\n      ].join(' ').trim();\r\n\r\n      const admin = it.admin_user || 'Admin';\r\n      const actionRaw = (it.action || '').toUpperCase();\r\n      const name = it.name || (it.row_details && it.row_details.name) || '';\r\n      const city = it.city || (it.row_details && it.row_details.city) || '';\r\n      const phone = it.phone || (it.row_details && it.row_details.phone) || '';\r\n      const uid = it.row_id;\r\n      const table = (it.table_name || '').toString();\r\n      const statusVal = (it.row_details && (it.row_details.status || it.row_details.application_status)) || '';\r\n\r\n      const row = document.createElement('div');\r\n      row.className = 'flex items-start gap-3';\r\n\r\n      const avatar = document.createElement('div');\r\n      // Match sidebar avatar size and shape (w-12 h-12) and default bg\r\n      avatar.className = 'w-12 h-12 rounded-full overflow-hidden bg-gray-300 flex items-center justify-center text-sm font-semibold shrink-0 shadow-sm';\r\n      avatar.setAttribute('aria-hidden', 'true');\r\n      if (window.__admin_avatar_url){\r\n        const img = document.createElement('img');\r\n        img.src = window.__admin_avatar_url;\r\n        img.alt = 'Avatar';\r\n        img.loading = 'lazy';\r\n        img.className = 'w-full h-full object-cover';\r\n        avatar.appendChild(img);\r\n      } else {\r\n        // Default SVG avatar (same as sidebar)\r\n        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n        svg.setAttribute('class', 'w-8 h-8 text-gray-600');\r\n        svg.setAttribute('fill', 'currentColor');\r\n        svg.setAttribute('viewBox', '0 0 20 20');\r\n        svg.setAttribute('aria-hidden', 'true');\r\n        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n        path.setAttribute('fill-rule', 'evenodd');\r\n        path.setAttribute('d', 'M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z');\r\n        path.setAttribute('clip-rule', 'evenodd');\r\n        svg.appendChild(path);\r\n        avatar.appendChild(svg);\r\n      }\r\n\r\n      const right = document.createElement('div');\r\n      right.className = 'flex-1 min-w-0';\r\n\r\n      const line = document.createElement('div');\r\n      line.className = 'text-[0.94rem] leading-5 sm:text-sm whitespace-normal break-words';\r\n      // Special case: Artist Application created (Table6 or humanized label)\r\n      const isArtistApp = (table === 'Table6') || /artist\\s*application/i.test(table);\r\n      // Friendly action mapping for Artist Applications (SOC: client-side only)\r\n      const actionMap = {\r\n        CREATE: 'applied',\r\n        UPDATE: 'status updated',\r\n        APPROVE: 'approved',\r\n        REJECT: 'rejected'\r\n      };\r\n      if (isArtistApp && actionRaw === 'CREATE') {\r\n        // \"<Name> applied for Artist Application \u2022 ID #<uid>\" (+optional city/phone bullets)\r\n        const frag = document.createDocumentFragment();\r\n        const nameStrong = document.createElement('span');\r\n        nameStrong.className = 'font-semibold';\r\n        nameStrong.textContent = name || 'Applicant';\r\n        frag.appendChild(nameStrong);\r\n        frag.append(' applied for Artist Application');\r\n        if (uid !== undefined && uid !== null) {\r\n          frag.append(' \u2022 ID #');\r\n          const idSpan = document.createElement('span'); idSpan.className = 'font-normal'; idSpan.textContent = String(uid); frag.appendChild(idSpan);\r\n        }\r\n        if (city) { frag.append(' \u2022 ' + city); }\r\n        if (phone) { frag.append(' \u2022 ' + phone); }\r\n        line.appendChild(frag);\r\n      } else if (isArtistApp && (actionRaw === 'APPROVE' || actionRaw === 'REJECT' || actionRaw === 'UPDATE')) {\r\n        // \"<Name>'s application was approved/rejected/updated (to <status>) \u2022 ID #<uid>\"\r\n        const frag = document.createDocumentFragment();\r\n        // Optional decorative icon for approved/rejected (accessibility: aria-hidden)\r\n        if (actionRaw === 'APPROVE' || actionRaw === 'REJECT') {\r\n          const icon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n          icon.setAttribute('class', actionRaw === 'APPROVE' ? 'w-4 h-4 text-emerald-600 inline-block align-[-2px] mr-1.5' : 'w-4 h-4 text-rose-600 inline-block align-[-2px] mr-1.5');\r\n          icon.setAttribute('viewBox', '0 0 20 20');\r\n          icon.setAttribute('fill', 'currentColor');\r\n          icon.setAttribute('aria-hidden', 'true');\r\n          const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n          if (actionRaw === 'APPROVE') {\r\n            // check circle\r\n            path.setAttribute('d', 'M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293A1 1 0 106.293 10.707l2 2a1 1 0 001.414 0l3.999-4z');\r\n          } else {\r\n            // x circle\r\n            path.setAttribute('d', 'M10 18a8 8 0 100-16 8 8 0 000 16zm2.828-10.828a1 1 0 10-1.414-1.414L10 7.172 8.586 5.758a1 1 0 10-1.414 1.414L8.586 8.586 7.172 10a1 1 0 101.414 1.414L10 9.999l1.414 1.415A1 1 0 1012.828 10l-1.414-1.414 1.414-1.414z');\r\n          }\r\n          icon.appendChild(path);\r\n          frag.appendChild(icon);\r\n        }\r\n        const nameStrong = document.createElement('span');\r\n        nameStrong.className = 'font-semibold';\r\n        nameStrong.textContent = name || 'Applicant';\r\n        frag.appendChild(nameStrong);\r\n        frag.append(\"'s application was \");\r\n        if (actionRaw === 'APPROVE') {\r\n          frag.append('approved');\r\n        } else if (actionRaw === 'REJECT') {\r\n          frag.append('rejected');\r\n        } else {\r\n          // UPDATE\r\n          const statusPretty = (statusVal || '').toString().replace(/_/g,' ').toLowerCase();\r\n          frag.append('updated');\r\n          if (statusPretty) { frag.append(' to ' + statusPretty); }\r\n        }\r\n        if (uid !== undefined && uid !== null) {\r\n          frag.append(' \u2022 ID #');\r\n          const idSpan = document.createElement('span'); idSpan.className = 'font-normal'; idSpan.textContent = String(uid); frag.appendChild(idSpan);\r\n        }\r\n        if (city) { frag.append(' \u2022 ' + city); }\r\n        if (phone) { frag.append(' \u2022 ' + phone); }\r\n        line.appendChild(frag);\r\n      } else {\r\n        // Default: (Admin) has <action> <name> with ID ... from ... with Phone ...\r\n        const action = isArtistApp ? (actionMap[actionRaw] || actionRaw.toLowerCase()) : actionRaw.toLowerCase();\r\n        const frag = document.createDocumentFragment();\r\n        const adminSpan = document.createElement('span'); adminSpan.className = 'font-semibold'; adminSpan.textContent = admin; frag.appendChild(adminSpan);\r\n        frag.append(' has ');\r\n        const actionSpan = document.createElement('span'); actionSpan.className = 'font-normal'; actionSpan.textContent = action; frag.appendChild(actionSpan);\r\n        frag.append(' ');\r\n        const nameSpan = document.createElement('span'); nameSpan.className = 'font-normal'; nameSpan.textContent = (name || '-'); frag.appendChild(nameSpan);\r\n        if (uid !== undefined && uid !== null) {\r\n          frag.append(' with ID ');\r\n          const idSpan = document.createElement('span'); idSpan.className = 'font-normal'; idSpan.textContent = String(uid); frag.appendChild(idSpan);\r\n        }\r\n        if (city) { frag.append(' from '); const citySpan = document.createElement('span'); citySpan.className = 'font-normal'; citySpan.textContent = city; frag.appendChild(citySpan); }\r\n        if (phone) { frag.append(' with Phone '); const phoneSpan = document.createElement('span'); phoneSpan.className = 'font-normal'; phoneSpan.textContent = phone; frag.appendChild(phoneSpan); }\r\n        frag.append('.');\r\n        line.appendChild(frag);\r\n      }\r\n\r\n      const meta = document.createElement('div');\r\n      meta.className = 'text-xs text-gray-500 dark:text-gray-400 mt-1';\r\n      meta.textContent = timeAgo(it.timestamp);\r\n\r\n      right.appendChild(line);\r\n      right.appendChild(meta);\r\n      row.appendChild(avatar);\r\n      row.appendChild(right);\r\n      li.appendChild(row);\r\n      list.appendChild(li);\r\n    });\r\n  }\r\n\r\n  function updateBadge(newCount){\r\n    const badge = qs('notifBadge');\r\n    if (!badge) return;\r\n    dlog('updateBadge', { newCount });\r\n    if (newCount > 0){\r\n      badge.textContent = String(newCount);\r\n      badge.classList.remove('hidden');\r\n      // Visual: highlight bell when there are unseen notifications\r\n      try {\r\n        const bell = document.querySelector('#notifBtn svg');\r\n        if (bell){ bell.classList.add('notif-bell-attn'); bell.classList.remove('notif-bell-fade'); }\r\n      } catch(_){ }\r\n    } else {\r\n      badge.textContent = '';\r\n      badge.classList.add('hidden');\r\n      // Do not immediately strip highlight here; let openMenu trigger a smooth fade when user opens dropdown\r\n    }\r\n  }\r\n\r\n  function getLastSeen(){\r\n    try {\r\n      return {\r\n        id: localStorage.getItem(LS_ID_KEY) || '',\r\n        ts: localStorage.getItem(LS_TS_KEY) || ''\r\n      };\r\n    } catch { return { id:'', ts:'' }; }\r\n  }\r\n  function setLastSeenById(id){\r\n    try { localStorage.setItem(LS_ID_KEY, id ? String(id) : ''); } catch {}\r\n  }\r\n  function setLastSeenByTs(ts){\r\n    try { localStorage.setItem(LS_TS_KEY, ts || ''); } catch {}\r\n  }\r\n\r\n  // Shared pause flag with tables/logs\r\n  function isPaused(){\r\n    try { return Date.now() <= (window.__autoPauseUntil || window.__tablesPauseUntil || 0); } catch(_) { return false; }\r\n  }\r\n\r\n  // Prevent overlapping polls\r\n  if (typeof window.__notifInFlight === 'undefined') window.__notifInFlight = false;\r\n\r\n  async function tick(){\r\n    if (isPaused()) { dlog('tick skipped: paused'); return; }\r\n    if (window.__notifInFlight) { dlog('tick skipped: in-flight'); return; }\r\n    window.__notifInFlight = true;\r\n    try {\r\n      const raw = await fetchRecent(10);\r\n      const items = dedupeItems(raw);\r\n      renderList(items);\r\n      const last = getLastSeen();\r\n      let newCount = 0;\r\n      // Prefer ID-based unseen computation if each item has an 'id'\r\n      if (items.length && items[0] && typeof items[0].id !== 'undefined'){\r\n        const lastId = last.id;\r\n        if (lastId){\r\n          // count items before we hit lastId\r\n          for (const it of items){\r\n            if (String(it.id) === String(lastId)) break;\r\n            newCount++;\r\n          }\r\n        } else {\r\n          newCount = items.length;\r\n        }\r\n        // remember latest identifiers for open action\r\n        window.__notif_latest_id = items[0]?.id;\r\n        window.__notif_latest_ts = items[0]?.timestamp;\r\n      } else {\r\n        // Fallback to timestamp logic\r\n        const lastTs = last.ts;\r\n        const newestTs = items[0]?.timestamp || lastTs;\r\n        newCount = lastTs ? items.filter(x => x.timestamp > lastTs).length : items.length;\r\n        window.__notif_latest_ts = newestTs;\r\n        window.__notif_latest_id = undefined;\r\n      }\r\n      updateBadge(newCount);\r\n    } finally {\r\n      // Always clear in-flight guard to keep polling alive\r\n      try { window.__notifInFlight = false; } catch(_){ }\r\n    }\r\n  }\r\n\r\n  // Expose a safe immediate bump to fetch notifications now (used after CRUD success)\r\n  window.bumpNotificationsNow = function(){\r\n    try {\r\n      if (isPaused()) return;\r\n      if (window.__notifInFlight) return;\r\n      window.__notifInFlight = true;\r\n      Promise.resolve(tick()).catch(()=>{}).finally(()=>{ try { window.__notifInFlight = false; } catch(_){} });\r\n    } catch(_){ }\r\n  };\r\n\r\n  function handleBellClick(){\r\n    const btn = qs('notifBtn');\r\n    const menu = qs('notifMenu');\r\n    if (!btn || !menu) return;\r\n    // Idempotent guard: avoid double-binding which can cause immediate open-then-close\r\n    if (btn.getAttribute('data-notif-bound') === '1') { dlog('bell already bound'); return; }\r\n\r\n    // Ensure initial closed state classes for smooth animation\r\n    try {\r\n      if (!menu.classList.contains('is-open') && !menu.classList.contains('is-closed')) {\r\n        menu.classList.add('is-closed');\r\n      }\r\n    } catch(_){ }\r\n\r\n    function openMenu(){\r\n      if (menu.classList.contains('is-open') && !menu.classList.contains('hidden')) return;\r\n      dlog('openMenu');\r\n      // Step 1: unhide so transition can play\r\n      menu.classList.remove('hidden');\r\n      // Step 2: next frame, switch to open state for smooth animation\r\n      requestAnimationFrame(()=>{\r\n        menu.classList.add('is-open');\r\n        menu.classList.remove('is-closed');\r\n      });\r\n      try { btn.setAttribute('aria-expanded','true'); } catch(_){ }\r\n      try { window.__notif_menu_opened_at = Date.now(); } catch(_){ }\r\n      const latestId = window.__notif_latest_id;\r\n      const latestTs = window.__notif_latest_ts;\r\n      if (typeof latestId !== 'undefined' && latestId !== null){ setLastSeenById(latestId); }\r\n      if (latestTs){ setLastSeenByTs(latestTs); }\r\n      // Start bell fade-out to original color\r\n      try {\r\n        const bell = document.querySelector('#notifBtn svg');\r\n        if (bell){\r\n          bell.classList.remove('notif-bell-attn');\r\n          // Force reflow to restart animation if needed\r\n          void bell.offsetWidth;\r\n          bell.classList.add('notif-bell-fade');\r\n          // Cleanup after fade completes\r\n          bell.addEventListener('animationend', function onEnd(){\r\n            try { bell.classList.remove('notif-bell-fade'); } catch(_){ }\r\n            bell.removeEventListener('animationend', onEnd);\r\n          });\r\n        }\r\n      } catch(_){ }\r\n      // Badge clears to 0\r\n      updateBadge(0);\r\n    }\r\n\r\n    function closeMenu(){\r\n      if (menu.classList.contains('hidden') && !menu.classList.contains('is-open')) return;\r\n      dlog('closeMenu');\r\n      // Switch to closed state for transition, then hide after transition ends\r\n      menu.classList.remove('is-open');\r\n      menu.classList.add('is-closed');\r\n      const TRANSITION_MS = 170; // keep in sync with CSS ~160ms\r\n      setTimeout(()=>{ try { menu.classList.add('hidden'); } catch(_){ } }, TRANSITION_MS);\r\n      try { btn.setAttribute('aria-expanded','false'); } catch(_){ }\r\n    }\r\n\r\n    btn.addEventListener('click', (e) => {\r\n      dlog('btn click');\r\n      if (e && typeof e.preventDefault === 'function') e.preventDefault();\r\n      if (e && typeof e.stopImmediatePropagation === 'function') e.stopImmediatePropagation();\r\n      const willOpen = menu.classList.contains('hidden');\r\n      if (willOpen) { openMenu(); } else { closeMenu(); }\r\n    });\r\n\r\n    // Prevent clicks inside menu from closing it\r\n    menu.addEventListener('click', (e) => { e.stopPropagation(); });\r\n\r\n    // Close on outside click anywhere in document (ignore clicks on button or within menu)\r\n    if (!window.__notif_doc_bound) {\r\n      document.addEventListener('click', (ev) => {\r\n        try {\r\n          const target = ev.target;\r\n          if (btn.contains(target) || menu.contains(target)) return;\r\n          dlog('outside click -> close');\r\n          closeMenu();\r\n        } catch(_){ }\r\n      });\r\n      window.__notif_doc_bound = true;\r\n    }\r\n\r\n    // Close on Escape for accessibility (bind once)\r\n    if (!window.__notif_escape_bound) {\r\n      document.addEventListener('keydown', (ev) => {\r\n        if (ev.key === 'Escape') { closeMenu(); }\r\n      });\r\n      window.__notif_escape_bound = true;\r\n    }\r\n\r\n    // Mark as bound\r\n    try { btn.setAttribute('data-notif-bound','1'); } catch(_){ }\r\n  }\r\n    \r\n\r\nfunction __initNotifications(){\r\n  // If header not present (e.g., login page), do nothing\r\n  if (!qs('notifBtn')) return;\r\n  handleBellClick();\r\n  // Global activity listeners to pause auto-refresh while admin is working\r\n  try {\r\n    if (!window.noteGlobalActivity){\r\n      const MAX_PAUSE_MS = 3 * 60 * 1000; // 3 minutes\r\n      window.noteGlobalActivity = function(){\r\n        try {\r\n          const now = Date.now();\r\n          if (typeof window.__autoPauseUntil === 'undefined') window.__autoPauseUntil = 0;\r\n          window.__autoPauseUntil = now + MAX_PAUSE_MS;\r\n          if (window.__tablesInactivityTimer) { clearTimeout(window.__tablesInactivityTimer); window.__tablesInactivityTimer = null; }\r\n        } catch(_){ }\r\n      };\r\n      // Generic input/typing across the app\r\n      document.addEventListener('input', function(e){\r\n        const t = e && e.target;\r\n        if (!t) return;\r\n        if (t.matches && (t.matches('input, textarea, select, [contenteditable=\"true\"]'))) {\r\n          window.noteGlobalActivity();\r\n        }\r\n      });\r\n      // Clicks on common CRUD/action/search buttons\r\n      document.addEventListener('click', function(e){\r\n        const btn = e && e.target && e.target.closest && e.target.closest('button, a');\r\n        if (!btn) return;\r\n        const label = (btn.textContent || '').toLowerCase();\r\n        const hasAction = btn.getAttribute && (btn.getAttribute('data-action') || btn.getAttribute('onclick'));\r\n        if (hasAction || /add|edit|update|delete|save|action|search/.test(label)) {\r\n          window.noteGlobalActivity();\r\n        }\r\n      });\r\n      // Focus into forms also counts as activity\r\n      document.addEventListener('focusin', function(e){\r\n        const t = e && e.target;\r\n        if (!t) return;\r\n        if (t.matches && (t.matches('input, textarea, select, [contenteditable=\"true\"]'))) {\r\n          window.noteGlobalActivity();\r\n        }\r\n      });\r\n    }\r\n  } catch(_){ }\r\n\r\n  // Initial tick and interval with pause and race guards\r\n  tick().catch(()=>{}).finally(()=>{ try { window.__notifInFlight = false; } catch(_){} });\r\n  setInterval(function(){ Promise.resolve(tick()).finally(()=>{ /* flag cleared in tick finally */ }); }, POLL_MS);\r\n}\r\n\r\nif (!window.__notif_inited) {\r\n  if (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', function(){ if (!window.__notif_inited) { __initNotifications(); window.__notif_inited = true; } });\r\n  } else {\r\n    // DOM is already ready when script is loaded late (scripts at end of body)\r\n    __initNotifications();\r\n    window.__notif_inited = true;\r\n  }\r\n} else {\r\n  dlog('notifications already initialized');\r\n}\r\n})();\r\n\r\n// --- Real-time Notifications via WebSocket (additive; falls back to polling) ---\r\n(function(){\r\n  try {\r\n    // Prevent double init\r\n    if (window.__notif_ws_inited) return;\r\n    window.__notif_ws_inited = true;\r\n\r\n    const DEBUG = (typeof window !== 'undefined' && window.DEBUG_NOTIF === true);\r\n    function dlog(){ try { if (DEBUG && typeof console !== 'undefined' && console.debug) console.debug('[notif-ws]', ...arguments); } catch(_){} }\r\n\r\n    const proto = (location.protocol === 'https:') ? 'wss' : 'ws';\r\n    const endpoint = `${proto}://${location.host}/ws/notifications/`;\r\n\r\n    let ws = null;\r\n    let reconnectDelay = 1000; // backoff starts at 1s\r\n    const maxDelay = 20000; // cap at 20s\r\n\r\n    function scheduleReconnect(){\r\n      const delay = reconnectDelay;\r\n      reconnectDelay = Math.min(maxDelay, Math.floor(reconnectDelay * 1.8));\r\n      dlog('reconnect in ms', delay);\r\n      setTimeout(connect, delay);\r\n    }\r\n\r\n    function connect(){\r\n      try {\r\n        dlog('connecting', endpoint);\r\n        ws = new WebSocket(endpoint);\r\n\r\n        ws.onopen = function(){\r\n          dlog('connected');\r\n          reconnectDelay = 1000; // reset backoff\r\n        };\r\n\r\n        ws.onmessage = function(evt){\r\n          try {\r\n            const msg = JSON.parse(evt.data || '{}');\r\n            if (msg && msg.type === 'activity_log'){\r\n              // Hint unseen computation and trigger a gentle refresh\r\n              try { window.__notif_latest_ts = (msg.data && msg.data.timestamp) || new Date().toISOString(); } catch(_){ }\r\n              if (typeof window.bumpNotificationsNow === 'function') {\r\n                window.bumpNotificationsNow();\r\n              }\r\n            }\r\n          } catch(e){ dlog('onmessage parse error', e); }\r\n        };\r\n\r\n        ws.onerror = function(e){ dlog('ws error', e); };\r\n\r\n        ws.onclose = function(){\r\n          dlog('closed');\r\n          // Allow polling to continue; attempt to reconnect in background\r\n          scheduleReconnect();\r\n        };\r\n      } catch(e){\r\n        dlog('connect error', e);\r\n        scheduleReconnect();\r\n      }\r\n    }\r\n\r\n    // Kick off connection shortly after load to avoid competing with initial requests\r\n    setTimeout(connect, 250);\r\n  } catch(_){ /* no-op: polling remains active */ }\r\n})();\r\n\r\n"],
  "mappings": "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",
  "names": ["ensureContentTopPadding", "root", "style", "POLL_MS", "LS_TS_KEY", "LS_ID_KEY", "DEBUG", "dlog", "qs", "id", "initials", "name", "timeAgo", "iso", "d", "sec", "min", "hr", "day", "fetchRecent", "perPage", "nocache", "res", "data", "e", "dedupeItems", "items", "out", "seen", "it", "key", "ensureNotifStyles", "renderList", "list", "empty", "last", "getLastSeen", "newIdSet", "now", "li", "unseenByTs", "withinOneMinute", "shouldHighlight", "admin", "actionRaw", "city", "phone", "uid", "table", "statusVal", "row", "avatar", "img", "svg", "path", "right", "line", "isArtistApp", "actionMap", "frag", "nameStrong", "idSpan", "icon", "statusPretty", "action", "adminSpan", "actionSpan", "nameSpan", "citySpan", "phoneSpan", "meta", "updateBadge", "newCount", "badge", "bell", "setLastSeenById", "setLastSeenByTs", "ts", "isPaused", "tick", "raw", "lastId", "lastTs", "newestTs", "x", "handleBellClick", "btn", "menu", "openMenu", "latestId", "latestTs", "onEnd", "closeMenu", "ev", "target", "__initNotifications", "t", "label", "scheduleReconnect", "delay", "reconnectDelay", "maxDelay", "connect", "endpoint", "ws", "evt", "msg"]
}
