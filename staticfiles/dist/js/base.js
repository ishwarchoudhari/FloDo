(()=>{(function(){try{window.getCSRFToken||(window.getCSRFToken=function(){try{var n=window.getCookie&&window.getCookie("csrftoken");if(n)return n}catch{}try{var i=document.querySelector('meta[name="csrf-token"]');if(i&&(i.content||"").trim())return i.content.trim()}catch{}try{var d=document.getElementById("csrf-token-global");if(d&&(d.value||d.content))return d.value||d.content}catch{}try{var s=document.querySelector('#csrf-holder input[name="csrfmiddlewaretoken"]');if(s&&s.value)return s.value}catch{}return""})}catch{}})();var P="/Super-Admin",H=P+"/auth";(function(){function t(){try{let o=localStorage.getItem("theme");if(o==="dark"||o==="light")return o}catch{}try{return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch{return"light"}}function n(o){try{let l=document.documentElement,e=document.body;if(o==="dark"){l.classList.add("dark");try{l.setAttribute("data-theme","dark")}catch{}e&&e.classList.add("dark")}else{l.classList.remove("dark");try{l.setAttribute("data-theme","light")}catch{}e&&e.classList.remove("dark")}let c=document.getElementById("themeToggle");if(c){c.setAttribute("aria-pressed",o==="dark"?"true":"false");let a=c.querySelector('[data-icon="sun"]'),r=c.querySelector('[data-icon="moon"]');a&&r&&(o==="dark"?(a.classList.remove("hidden"),r.classList.add("hidden")):(a.classList.add("hidden"),r.classList.remove("hidden")))}}catch{}}function i(o){try{localStorage.setItem("theme",o)}catch{}try{document.cookie="theme="+encodeURIComponent(o)+"; Path=/; Max-Age=31536000"}catch{}n(o)}let d=t();n(d);try{let o=window.matchMedia("(prefers-color-scheme: dark)");o&&typeof o.addEventListener=="function"&&o.addEventListener("change",l=>{try{let e=localStorage.getItem("theme");e!=="dark"&&e!=="light"&&n(l.matches?"dark":"light")}catch{}})}catch{}window.__setTheme=i;try{let o=function(){try{var l=document.getElementById("themeToggle");if(!l||l.getAttribute("data-theme-bound")==="1")return;var e=function(){return document.documentElement.classList.contains("dark")?"dark":"light"};l.addEventListener("click",function(){try{var c=e()==="dark"?"light":"dark";i(c)}catch{}}),l.setAttribute("data-theme-bound","1")}catch{}};var s=o;o(),document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",o),window.__themeToggleDelegated||(document.addEventListener("click",function(l){try{var e=l.target&&(l.target.closest?l.target.closest("#themeToggle"):null);if(!e)return;var c=document.documentElement.classList.contains("dark");i(c?"light":"dark");try{e.setAttribute("aria-pressed",c?"false":"true")}catch{}}catch{}}),window.__themeToggleDelegated=!0)}catch{}})();(function(){function t(){try{typeof window.initAdminOverview=="function"&&window.initAdminOverview()}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()})();window.updateAriaStatus=function(t){var n=document.getElementById("aria-status");n&&(n.textContent=t||"")};window.initDashboardStatsWS=function(){try{if(window.__dashWS&&(window.__dashWS.readyState===0||window.__dashWS.readyState===1))return;var t=window.location.protocol==="https:"?"wss://":"ws://",n=t+window.location.host+"/ws/notifications/",i=new WebSocket(n);window.__dashWS=i,i.onopen=function(){},i.onmessage=function(d){try{var s=JSON.parse(d.data||"{}");typeof window.refreshDashboardCharts=="function"&&window.refreshDashboardCharts()}catch{}},i.onclose=function(){setTimeout(function(){try{window.initDashboardStatsWS()}catch{}},2500)},i.onerror=function(){try{i.close()}catch{}}}catch{}};window.__dashboardChart=null;window.initDashboardCharts=function(){try{let e=function(){try{return JSON.parse(t.getAttribute("data-stats")||"[]")||[]}catch{return[]}},c=function(){var m=document.documentElement.classList.contains("dark");return m?{bg:"transparent",axis:"#9CA3AF",grid:"#374151",bar:"#60A5FA",text:"#E5E7EB"}:{bg:"transparent",axis:"#6B7280",grid:"#E5E7EB",bar:"#2563EB",text:"#111827"}},a=function(){t.innerHTML=""},r=function(){var m=e();if(!m||!m.length){t.innerHTML='<div class="text-sm text-gray-500 dark:text-gray-400">No data</div>';return}a();var v=t.getBoundingClientRect(),g=Math.max(300,Math.floor(v.width)),y=Math.max(220,Math.floor(v.height)),u={t:18,r:12,b:36,l:110},f=g-u.l-u.r,p=y-u.t-u.b,x=m.map(function(O){return String(O.label||"")}),q=m.map(function(O){return Math.max(0,Number(O.count)||0)}),I=Math.max.apply(null,q.concat([1])),_=document.createElementNS("http://www.w3.org/2000/svg","svg");_.setAttribute("viewBox","0 0 "+g+" "+y),_.setAttribute("width","100%"),_.setAttribute("height","100%");var T=document.createElementNS(_.namespaceURI,"g");T.setAttribute("transform","translate("+u.l+","+u.t+")");for(var D=4,k=c(),S=0;S<=D;S++){var C=Math.round(f*S/D),A=document.createElementNS(_.namespaceURI,"line");A.setAttribute("x1",C),A.setAttribute("y1",0),A.setAttribute("x2",C),A.setAttribute("y2",p),A.setAttribute("stroke",k.grid),A.setAttribute("stroke-width","1"),A.setAttribute("opacity","0.6"),T.appendChild(A)}for(var M=10,R=Math.floor((p-M*(x.length-1))/x.length),L=0;L<x.length;L++){var h=q[L],E=Math.round(h/I*f),F=L*(R+M),B=document.createElementNS(_.namespaceURI,"rect");B.setAttribute("x","0"),B.setAttribute("y",String(F)),B.setAttribute("width",String(Math.max(1,E))),B.setAttribute("height",String(R)),B.setAttribute("rx","6"),B.setAttribute("ry","6"),B.setAttribute("fill",k.bar),B.setAttribute("class","transition-all duration-200"),T.appendChild(B);var b=document.createElementNS(_.namespaceURI,"text");b.setAttribute("x",String(-8)),b.setAttribute("y",String(F+R/2+4)),b.setAttribute("text-anchor","end"),b.setAttribute("fill",k.text),b.setAttribute("font-size","12"),b.textContent=x[L],T.appendChild(b);var N=document.createElementNS(_.namespaceURI,"text");N.setAttribute("x",String(Math.max(12,E+6))),N.setAttribute("y",String(F+R/2+4)),N.setAttribute("fill",k.text),N.setAttribute("font-size","12"),N.textContent=q[L],T.appendChild(N)}_.appendChild(T),t.appendChild(_)},w=function(){window.__dashboardChartRaf&&cancelAnimationFrame(window.__dashboardChartRaf),window.__dashboardChartRaf=requestAnimationFrame(r)};var i=e,d=c,s=a,o=r,l=w,t=document.getElementById("chart-table-distribution");if(!t)return;window.__dashboardChart={render:r},r(),window.addEventListener("resize",w);try{var n=window.__setTheme;n&&!n._patchedForChart&&(window.__setTheme=function(m){n(m);try{window.__dashboardChart&&window.__dashboardChart.render()}catch{}},window.__setTheme._patchedForChart=!0)}catch{}}catch{}};window.refreshDashboardCharts=async function(){try{var t=document.getElementById("chart-table-distribution");if(!t)return;try{let d=await fetch("/dashboard/api/stats/table_distribution/",{headers:{"X-Requested-With":"XMLHttpRequest"}});if(d.ok){var n=await d.json();Array.isArray(n)?t.setAttribute("data-stats",JSON.stringify(n)):n&&Array.isArray(n.results)&&t.setAttribute("data-stats",JSON.stringify(n.results))}}catch{}try{var i=document.getElementById("donut-cards");i&&t&&i.setAttribute("data-stats",t.getAttribute("data-stats")||"[]")}catch{}window.__dashboardChart&&window.__dashboardChart.render(),window.__dashboardDonuts&&typeof window.__dashboardDonuts.render=="function"&&window.__dashboardDonuts.render()}catch{}};window.__dashboardDonuts=null;window.initDashboardDonuts=function(){try{let a=function(){try{return JSON.parse(t.getAttribute("data-stats")||"[]")||[]}catch{return[]}},r=function(){var u=document.documentElement.classList.contains("dark");return u?{text:"#E5E7EB",track:"#374151",users:"#60A5FA",artists:"#34D399",bookings:"#FBBF24"}:{text:"#111827",track:"#E5E7EB",users:"#2563EB",artists:"#10B981",bookings:"#F59E0B"}},w=function(u){var f=String(u||"").trim().toLowerCase();return f==="user"?"users":f==="verified-artist"||f==="artist"||f==="artists"?"artists":f==="booking"||f==="bookings"?"bookings":null},m=function(){for(var u=a(),f={users:0,artists:0,bookings:0},p=0;p<u.length;p++){var x=w(u[p].label);x&&(f[x]+=Math.max(0,Number(u[p].count)||0))}return f},v=function(u,f,p,x){var q=document.getElementById(u);if(q){q.innerHTML="";var I=Math.max(120,Math.min(q.clientWidth||160,q.clientHeight||160)),_=Math.floor(I/2-8),T=10,D=2*Math.PI*_,k=r(),S=document.createElementNS("http://www.w3.org/2000/svg","svg");S.setAttribute("viewBox","0 0 "+I+" "+I),S.setAttribute("width","100%"),S.setAttribute("height","100%");var C=I/2,A=I/2,M=document.createElementNS(S.namespaceURI,"circle");M.setAttribute("cx",C),M.setAttribute("cy",A),M.setAttribute("r",_),M.setAttribute("fill","none"),M.setAttribute("stroke",k.track),M.setAttribute("stroke-width",T),S.appendChild(M);var R=p>0?f/p:0;R=Math.max(0,Math.min(1,R));var L=document.createElementNS(S.namespaceURI,"circle");L.setAttribute("cx",C),L.setAttribute("cy",A),L.setAttribute("r",_),L.setAttribute("fill","none"),L.setAttribute("stroke",x),L.setAttribute("stroke-width",T),L.setAttribute("stroke-linecap","round"),L.setAttribute("stroke-dasharray",D.toString()),L.setAttribute("stroke-dashoffset",String(D*(1-R))),L.setAttribute("transform","rotate(-90 "+C+" "+A+")"),S.appendChild(L);var h=document.createElementNS(S.namespaceURI,"text");h.setAttribute("x",C),h.setAttribute("y",A+4),h.setAttribute("text-anchor","middle"),h.setAttribute("fill",k.text),h.setAttribute("font-size","14"),h.setAttribute("font-weight","700"),h.textContent=p>0?Math.round(R*100)+"%":"\u2014",S.appendChild(h),q.appendChild(S)}},g=function(){var u=m(),f=u.users+u.artists+u.bookings,p=r();v("donut-users",u.users,f,p.users),v("donut-artists",u.artists,f,p.artists),v("donut-bookings",u.bookings,f,p.bookings)},y=function(){window.__dashboardDonutRaf&&cancelAnimationFrame(window.__dashboardDonutRaf),window.__dashboardDonutRaf=requestAnimationFrame(g)};var i=a,d=r,s=w,o=m,l=v,e=g,c=y,t=document.getElementById("donut-cards");if(!t)return;window.__dashboardDonuts={render:g},g(),window.addEventListener("resize",y);try{var n=window.__setTheme;n&&!n._patchedForDonut&&(window.__setTheme=function(u){n(u);try{window.__dashboardDonuts&&window.__dashboardDonuts.render()}catch{}},window.__setTheme._patchedForDonut=!0)}catch{}}catch{}};(function(){function n(a){return document.getElementById(a)}function i(a){try{return a=String(a||""),a.trim().charAt(0).toUpperCase()||"?"}catch{return"?"}}function d(a){try{let r=document.createElement("div");return r.textContent=String(a??""),r.innerHTML}catch{return String(a||"")}}function s(a){var r=document.createElement("li");r.className="p-2.5 rounded-xl border bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition flex items-center gap-3.5";var w=document.createElement("div");if(w.className="w-9 h-9 rounded-full overflow-hidden bg-gray-300 dark:bg-gray-700 flex items-center justify-center text-sm font-semibold shrink-0 relative ring-1 ring-gray-900/5 dark:ring-white/10",a.avatar){var m=document.createElement("img");m.src=a.avatar,m.alt="Avatar",m.loading="lazy",m.className="w-full h-full object-cover",w.appendChild(m)}else w.textContent=i(a.name||a.user_name||a.username||a.full_name||"");var v=document.createElement("span");v.className="absolute -right-0 -bottom-0 w-3 h-3 rounded-full border-2 border-white dark:border-gray-800 bg-green-500";var g=document.createElement("span");g.className="absolute -right-0 -bottom-0 w-3 h-3 rounded-full bg-green-400/60 dark:bg-green-300/50 animate-ping",w.appendChild(g),w.appendChild(v);var y=document.createElement("div");y.className="flex-1 min-w-0";var u=document.createElement("div");u.className="text-[13px] md:text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",u.textContent=a.full_name||a.username||a.user_name||"Admin",y.appendChild(u);var f=document.createElement("button");return f.type="button",f.className="ml-auto px-2.5 py-1 text-xs font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700",f.textContent="Message",f.addEventListener("click",function(p){p.preventDefault();try{if(typeof window.openMessageOverlay=="function"){window.openMessageOverlay(a);return}typeof window.loadAdminManagement=="function"&&(window.loadAdminManagement(),setTimeout(function(){try{typeof window.openMessageOverlay=="function"&&window.openMessageOverlay(a)}catch{}},700))}catch{}}),r.appendChild(w),r.appendChild(y),r.appendChild(f),r}async function o(){try{let r=await(await fetch("/dashboard/api/admins/",{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json();return(r&&r.results?r.results:Array.isArray(r)?r:[]).filter(function(v){return String(v&&v.status).toLowerCase()==="online"})}catch{return[]}}function l(a){try{var r=n("online-admins-list");if(!r)return;if(r.setAttribute("aria-busy","true"),r.innerHTML="",!a||!a.length){var w=document.createElement("li");w.className="text-xs text-gray-500 dark:text-gray-400 px-2 py-1",w.textContent="No one online",r.appendChild(w)}else{var m=document.createDocumentFragment();a.forEach(function(v){m.appendChild(s(v))}),r.appendChild(m)}r.setAttribute("aria-busy","false")}catch{}}async function e(){l(await o())}window.refreshOnlineAdmins=e;function c(){try{if(!n("right-sidebar"))return;try{var a=window.matchMedia&&window.matchMedia("(min-width: 768px)");if(a&&a.matches){var r=n("right-sidebar");r&&r.classList.remove("hidden");var w=document.getElementById("content-root");w&&!w.classList.contains("md:mr-64")&&w.classList.add("md:mr-64")}}catch{}e(),window.__onlineAdminsTimer&&clearInterval(window.__onlineAdminsTimer),window.__onlineAdminsTimer=setInterval(e,8e3);var m=document.getElementById("toggleRightSidebar");m&&m.addEventListener("click",function(){var v=n("right-sidebar");v&&v.classList.toggle("hidden")})}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c(),(function(){function r(){try{var v=document.getElementById("right-sidebar"),g=document.querySelector("footer");if(!v||!g)return;var y=g.getBoundingClientRect(),u=window.innerHeight||document.documentElement.clientHeight,f=y.top<u;v.style.bottom=f?(g.offsetHeight||0)+"px":"0px"}catch{}}var w;function m(){w&&cancelAnimationFrame(w),w=requestAnimationFrame(r)}window.addEventListener("scroll",m,{passive:!0}),window.addEventListener("resize",m);try{new ResizeObserver(m).observe(document.querySelector("footer"))}catch{}document.addEventListener("DOMContentLoaded",r),setTimeout(r,0)})()})();(function(){try{window.__TABLE_LABELS_DEFAULT=window.__TABLE_LABELS_DEFAULT||{1:"Admin",2:"User",3:"Verified-Artist",4:"Payment",5:"Artist Service",6:"Artist Application",7:"Artist Availability",8:"Artist-Calendar",9:"Booking",10:"Message"},typeof window.getTableLabel!="function"&&(window.getTableLabel=function(n){var i=parseInt(n,10),d=window.TABLE_LABELS||window.__TABLE_LABELS_DEFAULT||{};return d[i]||"Table "+i})}catch{}})();(function(){try{var n=document.querySelector("[data-admin-avatar-url]"),i=n?n.getAttribute("data-admin-avatar-url"):"";i&&(window.__admin_avatar_url=i)}catch{}})();window.loadTables=async function(){try{let e=function(){try{let m=function(g){try{if(typeof window.refreshTable=="function"&&typeof window.setActiveTable=="function"){g&&g();return}var y=document.querySelector("script[data-dash-js]");if(y){setTimeout(function(){m(g)},0);return}var u=document.createElement("script");u.src="/static/js/dashboard.js?v=dev",u.setAttribute("data-dash-js","1"),u.onload=function(){g&&g()},document.head.appendChild(u)}catch{}};var c=m;let a=document.getElementById("tablePicker"),r=document.getElementById("loadTableBtn"),w=document.getElementById("refreshActiveBtn"),v=a?a.value:1;m(()=>{typeof window.setActiveTable=="function"&&window.setActiveTable(v)}),r&&r.addEventListener("click",()=>m(()=>window.setActiveTable(a.value))),w&&w.addEventListener("click",()=>m(()=>window.refreshTable(parseInt(a.value)))),a&&a.addEventListener("change",()=>m(()=>window.setActiveTable(a.value))),(function(){try{let h=function(){p.classList.remove("hidden"),f.setAttribute("aria-expanded","true")},E=function(){p.classList.add("hidden"),f.setAttribute("aria-expanded","false")},F=function(){p.classList.contains("hidden")?h():E()},B=function(b){if(b){u.value=String(b),x.textContent=window.getTableLabel?window.getTableLabel(b):"Table "+b;var N=document.createEvent("HTMLEvents");N.initEvent("change",!0,!1),u.dispatchEvent(N),E()}};var A=h,M=E,R=F,L=B,y=document.getElementById("tablePickerWrapper");if(!y||y.getAttribute("data-initialized")==="1")return;var u=document.getElementById("tablePicker"),f=document.getElementById("tablePickerDisplay"),p=document.getElementById("tablePickerList"),x=document.getElementById("tablePickerSelectedText");if(!u||!f||!p||!x)return;x.textContent=(function(){var b=u&&u.value?u.value:u&&u.options[0]?u.options[0].value:"1";return window.getTableLabel?window.getTableLabel(b):"Table "+b})();try{for(var q=p.querySelectorAll('li[role="option"]'),I=0;I<q.length;I++){var _=q[I].getAttribute("data-value"),T=q[I].querySelector('[data-role="label"]');T&&(T.textContent=window.getTableLabel(_))}}catch{}try{for(var D=document.querySelectorAll("[data-table-card]"),k=0;k<D.length;k++){var S=D[k].getAttribute("data-table-card"),C=D[k].querySelector("h2.font-semibold");C&&(C.textContent=window.getTableLabel(S))}}catch{}f.addEventListener("click",function(){F()}),p.addEventListener("click",function(b){var N=b.target.closest('li[role="option"]');N&&B(N.getAttribute("data-value"))}),f.addEventListener("keydown",function(b){(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),F()),b.key==="Escape"&&E()}),p.addEventListener("keydown",function(b){b.key==="Escape"&&E()}),document.addEventListener("click",function(b){y.contains(b.target)||E()}),y.setAttribute("data-initialized","1")}catch{}})();try{document.title=(document.title||"").replace(/\s·\s.*$/,"")+" \xB7 Tables"}catch{}window.showNotification&&window.showNotification("Tables","info");try{window.history&&window.history.pushState&&window.history.pushState({page:"tables"},"",P+"/tables/")}catch{}typeof window.setActiveSidebar=="function"&&window.setActiveSidebar(P+"/tables/"),window.__tablesAutoTimer&&(clearInterval(window.__tablesAutoTimer),window.__tablesAutoTimer=null),window.__tablesAutoTimer=setInterval(function(){try{var g=document.getElementById("tablePicker"),y=g?parseInt(g.value,10):1,u=typeof window.__tablesPauseUntil<"u"?window.__tablesPauseUntil:0;if(Date.now()<=(u||0))return;typeof refreshTable=="function"&&refreshTable(y)}catch{}},12e4)}catch{window.location.href="/dashboard/tables/"}};var s=e;window.startLoading&&window.startLoading(),window.updateAriaStatus&&window.updateAriaStatus("Loading tables\u2026");let o=await fetch(P+"/tables/",{headers:{"X-Requested-With":"XMLHttpRequest"}});try{var t=o.headers&&o.headers.get("X-Label-Map");t&&(window.TABLE_LABELS=JSON.parse(t))}catch{}let l=await o.text();var n=document.getElementById("content-root");if(n&&(n.innerHTML=l),typeof window.refreshTable!="function"||typeof window.refreshLogs!="function"){var i=document.querySelector("script[data-dash-js]");if(i)setTimeout(e,0);else{var d=document.createElement("script");d.src="/static/js/dashboard.js?v=dev",d.async=!0,d.setAttribute("data-dash-js","1"),d.onload=e,d.onerror=function(){window.location.href=P+"/tables/"},document.head.appendChild(d)}}else e();window.toggleSidebar&&window.toggleSidebar(!1),window.updateAriaStatus&&window.updateAriaStatus("Tables loaded")}catch{window.updateAriaStatus&&window.updateAriaStatus("Failed to load tables"),window.showNotification&&window.showNotification("Failed to load tables","error"),window.location.href=P+"/tables/"}finally{window.stopLoading&&window.stopLoading()}};window.navToTables=function(t){try{return t&&t.preventDefault&&t.preventDefault(),window.loadTables&&window.loadTables(),!1}catch{return!0}};window.toggleSidebar=function(t){var n=document.getElementById("sidebar"),i=document.getElementById("sidebar-overlay");if(n){var d=n.classList.contains("hidden"),s=t===!0||t===void 0&&d?!0:t===!1?!1:!d;s?(n.classList.remove("hidden"),i&&i.classList.remove("hidden")):(n.classList.add("hidden"),i&&i.classList.add("hidden"))}};document.addEventListener("keydown",function(t){t.key==="Escape"&&window.toggleSidebar(!1)});window.loadAdminProfile=async function(){try{window.startLoading&&window.startLoading(),window.updateAriaStatus&&window.updateAriaStatus("Loading profile\u2026");let i=await(await fetch(H+"/profile/",{headers:{"X-Requested-With":"XMLHttpRequest"}})).text();var t=document.getElementById("content-root");t&&(t.innerHTML=i),(function(){try{let r=document.getElementById("content-root");if(!r)return;let w=r.querySelector("#profile-edit-btn");w&&w.addEventListener("click",function(){typeof window.profileEnterEditMode=="function"&&window.profileEnterEditMode()});let m=r.querySelector("#profile-cancel-btn");m&&m.addEventListener("click",function(){typeof window.profileCancelEdit=="function"&&window.profileCancelEdit()});let v=r.querySelector("#avatar-input");v&&v.addEventListener("change",function(){typeof window.profileUploadAvatar=="function"&&window.profileUploadAvatar(v)});let g=r.querySelector("#avatar-input-edit");g&&g.addEventListener("change",function(){typeof window.profileUploadAvatar=="function"&&window.profileUploadAvatar(g)}),r.querySelectorAll("button").forEach(function(f){(f.textContent||"").trim().toLowerCase()==="delete"&&f.addEventListener("click",function(){typeof window.profileDeleteAvatar=="function"&&window.profileDeleteAvatar()})});let y=r.querySelector("#profile-edit-form");y&&y.addEventListener("submit",function(f){typeof window.profileSave=="function"&&window.profileSave(f)});let u=r.querySelector("#password-form");u&&u.addEventListener("submit",function(f){typeof window.profileChangePassword=="function"&&window.profileChangePassword(f)});try{let f=r.querySelector('#profile-edit-form input[name="birth_date"]');f&&attachTailwindDatepicker(f)}catch{}try{var s=r.querySelector(".w-36.h-36 img, img[alt='Avatar']"),o=document.querySelector(".user-profile-card");if(o){var l=o.querySelector(".w-12.h-12.rounded-full.overflow-hidden"),e=l?l.querySelector("img"):null,c=s&&s.getAttribute("src");if(c){if(e)e.src=c;else if(l){l.innerHTML="";var a=document.createElement("img");a.alt="Profile",a.loading="lazy",a.className="w-full h-full object-cover",a.src=c,l.appendChild(a)}try{o.setAttribute("data-admin-avatar-url",c)}catch{}}else l&&e&&l.removeChild(e)}}catch{}}catch{}})(),window.updateAriaStatus&&window.updateAriaStatus("Profile loaded"),window.toggleSidebar&&window.toggleSidebar(!1),window.showNotification&&window.showNotification("Profile","info")}catch{window.updateAriaStatus&&window.updateAriaStatus("Failed to load profile"),window.showNotification&&window.showNotification("Failed to load profile","error")}finally{window.stopLoading&&window.stopLoading()}};window.profileEnterEditMode=function(){var t=document.getElementById("profile-view-mode"),n=document.getElementById("profile-edit-mode");if(!(!t||!n)){t.classList.add("hidden"),n.classList.remove("hidden");try{var i=document.getElementById("profile-edit-btn");i&&i.setAttribute("aria-expanded","true")}catch{}window.updateAriaStatus&&window.updateAriaStatus("Edit mode enabled")}};window.profileCancelEdit=function(){var t=document.getElementById("profile-view-mode"),n=document.getElementById("profile-edit-mode");if(!(!t||!n)){n.classList.add("hidden"),t.classList.remove("hidden");try{var i=document.getElementById("profile-edit-btn");i&&i.setAttribute("aria-expanded","false")}catch{}window.updateAriaStatus&&window.updateAriaStatus("Edit mode cancelled")}};window.profileSave=async function(t){t&&t.preventDefault&&t.preventDefault();var n=document.getElementById("profile-edit-form");if(!n)return;let i=new FormData(n);try{var d=window.getCSRFToken&&window.getCSRFToken();d&&!i.has("csrfmiddlewaretoken")&&i.append("csrfmiddlewaretoken",d)}catch{}try{(await(await(window.fetchWithCSRF||window.fetch)(H+"/profile/update/",{method:"POST",body:i})).json()).success?(window.updateAriaStatus&&window.updateAriaStatus("Profile saved"),window.showNotification&&window.showNotification("Profile updated","success"),window.loadAdminProfile&&window.loadAdminProfile()):window.showNotification&&window.showNotification("Save failed","error")}catch{window.showNotification&&window.showNotification("Network error","error")}};window.profileUploadAvatar=async function(t){if(!t||!t.files||!t.files[0])return;let n=new FormData;n.append("avatar",t.files[0]);try{var i=window.getCSRFToken&&window.getCSRFToken();i&&n.append("csrfmiddlewaretoken",i)}catch{}try{let w=await(await(window.fetchWithCSRF||window.fetch)(H+"/profile/avatar/",{method:"POST",body:n})).json();if(w.success){window.updateAriaStatus&&window.updateAriaStatus("Avatar updated");try{var d=document.querySelector(".user-profile-card");if(d){var s=d.querySelector(".w-12.h-12.rounded-full.overflow-hidden"),o=s?s.querySelector("img"):null,l=URL.createObjectURL(t.files[0]);if(o)o.src=l;else if(s){s.innerHTML="";var e=document.createElement("img");e.alt="Profile",e.loading="lazy",e.className="w-full h-full object-cover",e.src=l,s.appendChild(e)}try{d.setAttribute("data-admin-avatar-url",l)}catch{}}}catch{}window.loadAdminProfile&&window.loadAdminProfile()}else{var c=w&&(w.error||w.message)||"Avatar upload failed";window.showNotification&&window.showNotification(c,"error")}}catch{window.showNotification&&window.showNotification("Avatar upload error","error")}};window.profileDeleteAvatar=async function(){try{let o=window.fetchWithCSRF||window.fetch;var t=new FormData;try{var n=window.getCSRFToken&&window.getCSRFToken();n&&t.append("csrfmiddlewaretoken",n)}catch{}if((await(await o(H+"/profile/avatar/delete/",{method:"POST",body:t})).json()).success){window.updateAriaStatus&&window.updateAriaStatus("Avatar removed");try{var i=document.querySelector(".user-profile-card"),d=i&&i.querySelector(".w-12.h-12.rounded-full.overflow-hidden"),s=d&&d.querySelector("img");d&&s&&d.removeChild(s),i&&i.setAttribute("data-admin-avatar-url","")}catch{}window.loadAdminProfile&&window.loadAdminProfile()}else window.showNotification&&window.showNotification("Avatar delete failed","error")}catch{window.showNotification&&window.showNotification("Avatar delete error","error")}};window.profileChangePassword=async function(t){t&&t.preventDefault&&t.preventDefault();var n=document.getElementById("password-form");if(!n)return;let i=new FormData(n);try{let s=await(await fetch(H+"/profile/password/",{method:"POST",headers:{"X-CSRFToken":window.getCookie&&window.getCookie("csrftoken")},body:i})).json();s.success?(window.updateAriaStatus&&window.updateAriaStatus("Password updated"),window.showNotification&&window.showNotification("Password updated","success"),n.reset()):window.showNotification&&window.showNotification(s.error||"Password update failed","error")}catch{window.showNotification&&window.showNotification("Password update error","error")}};window.attachTailwindDatepicker=function(t){try{let _=function(h){return(h<10?"0":"")+h},T=function(h){return h?h.getFullYear()+"-"+_(h.getMonth()+1)+"-"+_(h.getDate()):""},D=function(h){try{if(!h)return null;var E=String(h).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!E)return null;var F=new Date(parseInt(E[1],10),parseInt(E[2],10)-1,parseInt(E[3],10));return isNaN(F.getTime())?null:F}catch{return null}},k=function(h,E){return h&&E&&h.getFullYear()===E.getFullYear()&&h.getMonth()===E.getMonth()&&h.getDate()===E.getDate()},S=function(){e.innerHTML="";var h=r.getFullYear(),E=r.getMonth();l.textContent=r.toLocaleString(void 0,{month:"long",year:"numeric"});var F=new Date(h,E,1),B=new Date(F);B.setDate(F.getDate()-F.getDay());for(var b=0;b<42;b++){var N=new Date(B);N.setDate(B.getDate()+b);var O=document.createElement("button");O.type="button";var W=N.getMonth()!==E;O.className="text-sm px-2 py-1 rounded text-center w-8 h-8 flex items-center justify-center "+(W?"text-gray-400 dark:text-gray-500 ":"text-gray-900 dark:text-gray-100 ")+(k(N,w)?"bg-blue-600 text-white ":"hover:bg-gray-100 dark:hover:bg-gray-800 "),O.textContent=N.getDate(),O.addEventListener("click",(function(U){return function(){w=U,t.value=T(U),A(),t.dispatchEvent(new Event("change",{bubbles:!0}))}})(new Date(N))),e.appendChild(O)}},C=function(){i.classList.remove("hidden"),L(),document.addEventListener("keydown",M,!0),document.addEventListener("click",R,!0)},A=function(){i.classList.add("hidden"),document.removeEventListener("keydown",M,!0),document.removeEventListener("click",R,!0)},M=function(h){h.key==="Escape"&&A()},R=function(h){!i.contains(h.target)&&h.target!==t&&A()},L=function(){try{var h=t.getBoundingClientRect(),E=t.parentElement.getBoundingClientRect();i.style.left=Math.max(0,h.left-E.left)+"px"}catch{}};var m=_,v=T,g=D,y=k,u=S,f=C,p=A,x=M,q=R,I=L;if(!t||t._twDatepicker)return;var n=t.getAttribute("type")||"text";n!=="text"&&t.setAttribute("type","text"),t.setAttribute("inputmode","numeric"),t.setAttribute("placeholder","YYYY-MM-DD");var i=document.createElement("div");i.className="absolute z-50 mt-1 w-64 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl p-2 hidden",i.setAttribute("role","dialog");var d=document.createElement("div");d.className="flex items-center justify-between mb-2";var s=document.createElement("button");s.type="button",s.className="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800",s.innerHTML="&#x2039;";var o=document.createElement("button");o.type="button",o.className="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800",o.innerHTML="&#x203A;";var l=document.createElement("div");l.className="text-sm font-medium",d.appendChild(s),d.appendChild(l),d.appendChild(o);var e=document.createElement("div");e.className="grid grid-cols-7 gap-1";var c=["Su","Mo","Tu","We","Th","Fr","Sa"],a=document.createElement("div");a.className="grid grid-cols-7 gap-1 mb-1 text-[11px] text-gray-500 dark:text-gray-400",c.forEach(function(h){var E=document.createElement("div");E.className="text-center",E.textContent=h,a.appendChild(E)}),i.appendChild(d),i.appendChild(a),i.appendChild(e),t.parentElement.style.position=t.parentElement.style.position||"relative",t.parentElement.appendChild(i);var r=D(t.value)||new Date;r.setHours(0,0,0,0);var w=D(t.value);s.addEventListener("click",function(){r.setMonth(r.getMonth()-1),S()}),o.addEventListener("click",function(){r.setMonth(r.getMonth()+1),S()}),t.addEventListener("focus",function(){S(),C()}),t.addEventListener("click",function(){S(),C()}),t.addEventListener("blur",function(){}),t.addEventListener("input",function(){var h=D(t.value);h&&(w=h,r=new Date(h),r.setDate(1))}),t._twDatepicker={open:C,close:A}}catch{}};window.loadAdminManagement=async function(){try{let s=function(o){try{if(typeof window.initAdminManagement=="function"){o&&o();return}var l=document.querySelector("script[src$='/static/js/admin_management.js']");if(l){setTimeout(function(){s(o)},0);return}var e=document.createElement("script");e.src="/static/js/admin_management.js",e.onload=function(){o&&o()},document.head.appendChild(e)}catch{}};var n=s;window.startLoading&&window.startLoading(),window.updateAriaStatus&&window.updateAriaStatus("Loading admin management\u2026");let d=await(await fetch(P+"/Admin_management/",{headers:{"X-Requested-With":"XMLHttpRequest"}})).text();var t=document.getElementById("content-root");t&&(t.innerHTML=d),s(function(){try{window.initAdminManagement&&window.initAdminManagement()}catch{}});try{window.history&&window.history.pushState&&window.history.pushState({page:"admin_mgmt"},"",P+"/Admin_management/")}catch{}typeof window.setActiveSidebar=="function"&&window.setActiveSidebar(P+"/Admin_management/"),window.toggleSidebar&&window.toggleSidebar(!1),window.showNotification&&window.showNotification("Admin Management","info"),window.updateAriaStatus&&window.updateAriaStatus("Admin management loaded")}catch{window.updateAriaStatus&&window.updateAriaStatus("Failed to load admin management"),window.location.href=P+"/Admin_management/"}finally{window.stopLoading&&window.stopLoading()}};document.addEventListener("DOMContentLoaded",function(){try{var t=document.getElementById("themeToggle");t&&!t.getAttribute("data-csp-bound")&&(t.addEventListener("click",function(e){e.preventDefault();try{var c=document.documentElement.classList.contains("dark"),a=c?"light":"dark";typeof window.__setTheme=="function"&&window.__setTheme(a),window.updateAriaStatus&&window.updateAriaStatus(a==="dark"?"Dark mode enabled":"Dark mode disabled")}catch{}}),t.setAttribute("data-csp-bound","1"))}catch{}try{var n=document.querySelector("a[href='/dashboard/tables/']");n&&n.addEventListener("click",function(e){typeof window.loadTables=="function"&&(e.preventDefault(),window.loadTables())});try{var i=document.querySelector("a[href='"+P+"/Admin_management/']");i&&i.addEventListener("click",function(e){typeof window.loadAdminManagement=="function"&&(e.preventDefault(),window.loadAdminManagement())})}catch{}}catch{}try{(function(){try{var c=document.getElementById("chart-table-distribution");c&&typeof window.initDashboardCharts=="function"&&window.initDashboardCharts();var a=document.getElementById("donut-cards");a&&typeof window.initDashboardDonuts=="function"&&window.initDashboardDonuts();var r=document.getElementById("dashboardChartRefresh");r&&r.addEventListener("click",function(){typeof window.refreshDashboardCharts=="function"&&window.refreshDashboardCharts()}),typeof window.initDashboardStatsWS=="function"&&window.initDashboardStatsWS()}catch{}})();var d=document.getElementById("notifBtn");if(d&&!d.getAttribute("data-csp-bound")){try{d.removeAttribute("onclick")}catch{}d.setAttribute("data-csp-bound","1")}}catch{}try{var s=document.getElementById("userMenu"),o=s?s.previousElementSibling:null;if(s&&o&&!o.getAttribute("data-csp-bound")){try{o.removeAttribute("onclick")}catch{}o.addEventListener("click",function(e){e.preventDefault();var c=s.classList.contains("hidden");c?s.classList.remove("hidden"):s.classList.add("hidden");try{o.setAttribute("aria-expanded",c?"true":"false")}catch{}}),document.addEventListener("click",function(e){try{!s.contains(e.target)&&!o.contains(e.target)&&(s.classList.add("hidden"),o.setAttribute("aria-expanded","false"))}catch{}}),document.addEventListener("keydown",function(e){if(e.key==="Escape")try{s.classList.add("hidden"),o.setAttribute("aria-expanded","false")}catch{}}),o.setAttribute("data-csp-bound","1")}}catch{}try{var l=document.querySelector('header [aria-controls="sidebar"]');if(l&&!l.getAttribute("data-csp-bound")){try{l.removeAttribute("onclick")}catch{}l.addEventListener("click",function(e){e.preventDefault(),typeof window.toggleSidebar=="function"&&window.toggleSidebar(!0)}),l.setAttribute("data-csp-bound","1")}}catch{}try{typeof window.setActiveSidebar=="function"&&window.setActiveSidebar(window.location.pathname)}catch{}try{window.addEventListener("popstate",function(){try{if(location.pathname==="/dashboard/tables/")typeof window.loadTables=="function"&&window.loadTables(),typeof window.setActiveSidebar=="function"&&window.setActiveSidebar("/dashboard/tables/");else if(location.pathname==="/dashboard/"){if(window.__tablesAutoTimer){try{clearInterval(window.__tablesAutoTimer)}catch{}window.__tablesAutoTimer=null}typeof window.setActiveSidebar=="function"&&window.setActiveSidebar("/dashboard/"),window.location.href="/dashboard/"}}catch{}})}catch{}try{window.__tablesAutoTimer&&(clearInterval(window.__tablesAutoTimer),window.__tablesAutoTimer=null)}catch{}try{document.addEventListener("keydown",function(e){try{var c=e.target&&e.target.closest&&e.target.closest(".user-profile-card");if(!c)return;(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),typeof window.loadAdminProfile=="function"&&window.loadAdminProfile())}catch{}})}catch{}try{document.addEventListener("click",function(e){var c=e.target,a=c&&(c.id==="sidebar-overlay"?c:c.closest&&c.closest("#sidebar-overlay"));if(a){e.preventDefault(),typeof window.toggleSidebar=="function"&&window.toggleSidebar(!1);return}var r=c&&c.closest&&c.closest(".status-trigger");if(r){e.preventDefault();var w=document.getElementById("status-dropdown-menu");if(w){var m=w.classList.contains("hidden");w.classList.toggle("hidden");try{r.setAttribute("aria-expanded",m?"true":"false")}catch{}if(m){for(var v=w.querySelectorAll('button[role="menuitemradio"]'),g=(document.getElementById("current-status")||{}).textContent||"",y=0;y<v.length;y++){v[y].setAttribute("tabindex","-1");var u=v[y].getAttribute("data-status"),f=g.toLowerCase().indexOf(u)>=0;v[y].setAttribute("aria-checked",f?"true":"false")}v&&v[0]&&v[0].focus()}else try{r.focus()}catch{}}return}var p=c&&c.closest&&c.closest(".user-profile-card");if(p&&!(c.closest&&(c.closest(".status-dropdown")||c.closest("#status-dropdown-menu")))){e.preventDefault(),typeof window.loadAdminProfile=="function"&&window.loadAdminProfile();return}var x=c&&c.closest&&c.closest("#status-dropdown-menu button");if(x){e.preventDefault();var q=(x.textContent||"").toLowerCase(),I=q.indexOf("unavailable")>=0?"unavailable":"available";try{var _=document.getElementById("current-status"),T=document.getElementById("status-dropdown-menu");if(_){_.textContent="";let A=document.createElement("span");A.className="w-2 h-2 me-1 rounded-full";let M=document.createTextNode(I==="available"?"Available":"Unavailable");I==="available"?(_.className="inline-flex items-center bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300 text-xs font-medium px-2.5 py-0.5 rounded-full",A.classList.add("bg-green-500")):(_.className="inline-flex items-center bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300 text-xs font-medium px-2.5 py-0.5 rounded-full",A.classList.add("bg-red-500")),_.appendChild(A),_.appendChild(M)}try{for(var D=document.querySelectorAll('#status-dropdown-menu button[role="menuitemradio"]'),k=0;k<D.length;k++){var S=D[k].getAttribute("data-status");D[k].setAttribute("aria-checked",S===I?"true":"false")}}catch{}T&&T.classList.add("hidden");try{var C=document.querySelector(".status-trigger");C&&(C.setAttribute("aria-expanded","false"),C.focus())}catch{}}catch{}return}}),document.addEventListener("click",function(e){try{var c=document.getElementById("status-dropdown-menu"),a=document.querySelector(".status-trigger");if(!c||!a)return;if(!a.contains(e.target)&&!c.contains(e.target)){c.classList.add("hidden");try{a.setAttribute("aria-expanded","false")}catch{}}}catch{}})}catch{}});window.setActiveSidebar=function(t){try{var n=document.getElementById("sidebar");if(!n)return;var i=n.querySelectorAll("a[href]"),d=(t||"").replace(/\/$/,"/")||"/";i.forEach(function(s){s.classList.remove("bg-gray-100"),s.removeAttribute("aria-current")}),i.forEach(function(s){try{var o=s.getAttribute("href")||"",l=new URL(o,window.location.origin),e=(l.pathname||"").replace(/\/$/,"/")||"/";e===d&&(s.classList.add("bg-gray-100"),s.classList.add("dark:bg-gray-800"),s.setAttribute("aria-current","page"))}catch{}})}catch{}};(function(){function t(){try{var d=document.getElementById("sidebar"),s=document.querySelector("footer");if(!d||!s)return;var o=s.getBoundingClientRect(),l=window.innerHeight||document.documentElement.clientHeight,e=o.top<l;if(e){var c=Math.max(s.offsetHeight||0,0);d.style.bottom=c+"px"}else d.style.bottom="0px"}catch{}}var n;function i(){n&&cancelAnimationFrame(n),n=requestAnimationFrame(t)}window.addEventListener("scroll",i,{passive:!0}),window.addEventListener("resize",i);try{new ResizeObserver(t).observe(document.querySelector("footer"))}catch{}document.addEventListener("DOMContentLoaded",t),setTimeout(t,0)})();})();
//# sourceMappingURL=base.js.map
