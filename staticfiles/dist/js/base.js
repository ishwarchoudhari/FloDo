"use strict";(()=>{var N="/Super-Admin",B=N+"/auth";(function(){function t(){try{let i=localStorage.getItem("theme");if(i==="dark"||i==="light")return i}catch{}try{return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch{return"light"}}function r(i){try{let c=document.documentElement,u=document.body;if(i==="dark"){c.classList.add("dark");try{c.setAttribute("data-theme","dark")}catch{}u&&u.classList.add("dark")}else{c.classList.remove("dark");try{c.setAttribute("data-theme","light")}catch{}u&&u.classList.remove("dark")}let e=document.getElementById("themeToggle");if(e){e.setAttribute("aria-pressed",i==="dark"?"true":"false");let s=e.querySelector('[data-icon="sun"]'),a=e.querySelector('[data-icon="moon"]');s&&a&&(i==="dark"?(s.classList.remove("hidden"),a.classList.add("hidden")):(s.classList.add("hidden"),a.classList.remove("hidden")))}}catch{}}function o(i){try{localStorage.setItem("theme",i)}catch{}try{document.cookie="theme="+encodeURIComponent(i)+"; Path=/; Max-Age=31536000"}catch{}r(i)}let d=t();r(d);try{let i=window.matchMedia("(prefers-color-scheme: dark)");i&&typeof i.addEventListener=="function"&&i.addEventListener("change",c=>{try{let u=localStorage.getItem("theme");u!=="dark"&&u!=="light"&&r(c.matches?"dark":"light")}catch{}})}catch{}window.__setTheme=o;try{let i=function(){try{var c=document.getElementById("themeToggle");if(!c||c.getAttribute("data-theme-bound")==="1")return;var u=function(){return document.documentElement.classList.contains("dark")?"dark":"light"};c.addEventListener("click",function(){try{var e=u()==="dark"?"light":"dark";o(e)}catch{}}),c.setAttribute("data-theme-bound","1")}catch{}};i(),document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",i),window.__themeToggleDelegated||(document.addEventListener("click",function(c){try{var u=c.target&&(c.target.closest?c.target.closest("#themeToggle"):null);if(!u)return;var e=document.documentElement.classList.contains("dark");o(e?"light":"dark");try{u.setAttribute("aria-pressed",e?"false":"true")}catch{}}catch{}}),window.__themeToggleDelegated=!0)}catch{}})();(function(){function t(){try{typeof window.initAdminOverview=="function"&&window.initAdminOverview()}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()})();window.updateAriaStatus=function(t){var r=document.getElementById("aria-status");r&&(r.textContent=t||"")};window.initDashboardStatsWS=function(){try{if(window.__dashWS&&(window.__dashWS.readyState===0||window.__dashWS.readyState===1))return;var t=window.location.protocol==="https:"?"wss://":"ws://",r=t+window.location.host+"/ws/notifications/",o=new WebSocket(r);window.__dashWS=o,o.onopen=function(){},o.onmessage=function(d){try{var i=JSON.parse(d.data||"{}");typeof window.refreshDashboardCharts=="function"&&window.refreshDashboardCharts()}catch{}},o.onclose=function(){setTimeout(function(){try{window.initDashboardStatsWS()}catch{}},2500)},o.onerror=function(){try{o.close()}catch{}}}catch{}};window.__dashboardChart=null;window.initDashboardCharts=function(){try{let o=function(){try{return JSON.parse(t.getAttribute("data-stats")||"[]")||[]}catch{return[]}},d=function(){var e=document.documentElement.classList.contains("dark");return e?{bg:"transparent",axis:"#9CA3AF",grid:"#374151",bar:"#60A5FA",text:"#E5E7EB"}:{bg:"transparent",axis:"#6B7280",grid:"#E5E7EB",bar:"#2563EB",text:"#111827"}},i=function(){t.innerHTML=""},c=function(){var e=o();if(!e||!e.length){t.innerHTML='<div class="text-sm text-gray-500 dark:text-gray-400">No data</div>';return}i();var s=t.getBoundingClientRect(),a=Math.max(300,Math.floor(s.width)),n=Math.max(220,Math.floor(s.height)),l={t:18,r:12,b:36,l:110},m=a-l.l-l.r,w=n-l.t-l.b,h=e.map(function(q){return String(q.label||"")}),p=e.map(function(q){return Math.max(0,Number(q.count)||0)}),y=Math.max.apply(null,p.concat([1])),v=document.createElementNS("http://www.w3.org/2000/svg","svg");v.setAttribute("viewBox","0 0 "+a+" "+n),v.setAttribute("width","100%"),v.setAttribute("height","100%");var L=document.createElementNS(v.namespaceURI,"g");L.setAttribute("transform","translate("+l.l+","+l.t+")");for(var _=4,C=d(),k=0;k<=_;k++){var f=Math.round(m*k/_),g=document.createElementNS(v.namespaceURI,"line");g.setAttribute("x1",f),g.setAttribute("y1",0),g.setAttribute("x2",f),g.setAttribute("y2",w),g.setAttribute("stroke",C.grid),g.setAttribute("stroke-width","1"),g.setAttribute("opacity","0.6"),L.appendChild(g)}for(var A=10,E=Math.floor((w-A*(h.length-1))/h.length),T=0;T<h.length;T++){var x=p[T],S=Math.round(x/y*m),M=T*(E+A),b=document.createElementNS(v.namespaceURI,"rect");b.setAttribute("x","0"),b.setAttribute("y",String(M)),b.setAttribute("width",String(Math.max(1,S))),b.setAttribute("height",String(E)),b.setAttribute("rx","6"),b.setAttribute("ry","6"),b.setAttribute("fill",C.bar),b.setAttribute("class","transition-all duration-200"),L.appendChild(b);var D=document.createElementNS(v.namespaceURI,"text");D.setAttribute("x",String(-8)),D.setAttribute("y",String(M+E/2+4)),D.setAttribute("text-anchor","end"),D.setAttribute("fill",C.text),D.setAttribute("font-size","12"),D.textContent=h[T],L.appendChild(D);var I=document.createElementNS(v.namespaceURI,"text");I.setAttribute("x",String(Math.max(12,S+6))),I.setAttribute("y",String(M+E/2+4)),I.setAttribute("fill",C.text),I.setAttribute("font-size","12"),I.textContent=p[T],L.appendChild(I)}v.appendChild(L),t.appendChild(v)},u=function(){window.__dashboardChartRaf&&cancelAnimationFrame(window.__dashboardChartRaf),window.__dashboardChartRaf=requestAnimationFrame(c)};var t=document.getElementById("chart-table-distribution");if(!t)return;window.__dashboardChart={render:c},c(),window.addEventListener("resize",u);try{var r=window.__setTheme;r&&!r._patchedForChart&&(window.__setTheme=function(e){r(e);try{window.__dashboardChart&&window.__dashboardChart.render()}catch{}},window.__setTheme._patchedForChart=!0)}catch{}}catch{}};window.refreshDashboardCharts=async function(){try{var t=document.getElementById("chart-table-distribution");if(!t)return;try{let d=await fetch("/dashboard/api/stats/table_distribution/",{headers:{"X-Requested-With":"XMLHttpRequest"}});if(d.ok){var r=await d.json();Array.isArray(r)?t.setAttribute("data-stats",JSON.stringify(r)):r&&Array.isArray(r.results)&&t.setAttribute("data-stats",JSON.stringify(r.results))}}catch{}try{var o=document.getElementById("donut-cards");o&&t&&o.setAttribute("data-stats",t.getAttribute("data-stats")||"[]")}catch{}window.__dashboardChart&&window.__dashboardChart.render(),window.__dashboardDonuts&&typeof window.__dashboardDonuts.render=="function"&&window.__dashboardDonuts.render()}catch{}};window.__dashboardDonuts=null;window.initDashboardDonuts=function(){try{let o=function(){try{return JSON.parse(t.getAttribute("data-stats")||"[]")||[]}catch{return[]}},d=function(){var a=document.documentElement.classList.contains("dark");return a?{text:"#E5E7EB",track:"#374151",users:"#60A5FA",artists:"#34D399",bookings:"#FBBF24"}:{text:"#111827",track:"#E5E7EB",users:"#2563EB",artists:"#10B981",bookings:"#F59E0B"}},i=function(a){var n=String(a||"").trim().toLowerCase();return n==="user"?"users":n==="verified-artist"||n==="artist"||n==="artists"?"artists":n==="booking"||n==="bookings"?"bookings":null},c=function(){for(var a=o(),n={users:0,artists:0,bookings:0},l=0;l<a.length;l++){var m=i(a[l].label);m&&(n[m]+=Math.max(0,Number(a[l].count)||0))}return n},u=function(a,n,l,m){var w=document.getElementById(a);if(w){w.innerHTML="";var h=Math.max(120,Math.min(w.clientWidth||160,w.clientHeight||160)),p=Math.floor(h/2-8),y=10,v=2*Math.PI*p,L=d(),_=document.createElementNS("http://www.w3.org/2000/svg","svg");_.setAttribute("viewBox","0 0 "+h+" "+h),_.setAttribute("width","100%"),_.setAttribute("height","100%");var C=h/2,k=h/2,f=document.createElementNS(_.namespaceURI,"circle");f.setAttribute("cx",C),f.setAttribute("cy",k),f.setAttribute("r",p),f.setAttribute("fill","none"),f.setAttribute("stroke",L.track),f.setAttribute("stroke-width",y),_.appendChild(f);var g=l>0?n/l:0;g=Math.max(0,Math.min(1,g));var A=document.createElementNS(_.namespaceURI,"circle");A.setAttribute("cx",C),A.setAttribute("cy",k),A.setAttribute("r",p),A.setAttribute("fill","none"),A.setAttribute("stroke",m),A.setAttribute("stroke-width",y),A.setAttribute("stroke-linecap","round"),A.setAttribute("stroke-dasharray",v.toString()),A.setAttribute("stroke-dashoffset",String(v*(1-g))),A.setAttribute("transform","rotate(-90 "+C+" "+k+")"),_.appendChild(A);var E=document.createElementNS(_.namespaceURI,"text");E.setAttribute("x",C),E.setAttribute("y",k+4),E.setAttribute("text-anchor","middle"),E.setAttribute("fill",L.text),E.setAttribute("font-size","14"),E.setAttribute("font-weight","700"),E.textContent=l>0?Math.round(g*100)+"%":"\u2014",_.appendChild(E),w.appendChild(_)}},e=function(){var a=c(),n=a.users+a.artists+a.bookings,l=d();u("donut-users",a.users,n,l.users),u("donut-artists",a.artists,n,l.artists),u("donut-bookings",a.bookings,n,l.bookings)},s=function(){window.__dashboardDonutRaf&&cancelAnimationFrame(window.__dashboardDonutRaf),window.__dashboardDonutRaf=requestAnimationFrame(e)};var t=document.getElementById("donut-cards");if(!t)return;window.__dashboardDonuts={render:e},e(),window.addEventListener("resize",s);try{var r=window.__setTheme;r&&!r._patchedForDonut&&(window.__setTheme=function(a){r(a);try{window.__dashboardDonuts&&window.__dashboardDonuts.render()}catch{}},window.__setTheme._patchedForDonut=!0)}catch{}}catch{}};(function(){function r(a){return document.getElementById(a)}function o(a){try{return a=String(a||""),a.trim().charAt(0).toUpperCase()||"?"}catch{return"?"}}function d(a){try{let n=document.createElement("div");return n.textContent=String(a??""),n.innerHTML}catch{return String(a||"")}}function i(a){var n=document.createElement("li");n.className="p-2.5 rounded-xl border bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition flex items-center gap-3.5";var l=document.createElement("div");if(l.className="w-9 h-9 rounded-full overflow-hidden bg-gray-300 dark:bg-gray-700 flex items-center justify-center text-sm font-semibold shrink-0 relative ring-1 ring-gray-900/5 dark:ring-white/10",a.avatar){var m=document.createElement("img");m.src=a.avatar,m.alt="Avatar",m.loading="lazy",m.className="w-full h-full object-cover",l.appendChild(m)}else l.textContent=o(a.name||a.user_name||a.username||a.full_name||"");var w=document.createElement("span");w.className="absolute -right-0 -bottom-0 w-3 h-3 rounded-full border-2 border-white dark:border-gray-800 bg-green-500";var h=document.createElement("span");h.className="absolute -right-0 -bottom-0 w-3 h-3 rounded-full bg-green-400/60 dark:bg-green-300/50 animate-ping",l.appendChild(h),l.appendChild(w);var p=document.createElement("div");p.className="flex-1 min-w-0";var y=document.createElement("div");y.className="text-[13px] md:text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",y.textContent=a.full_name||a.username||a.user_name||"Admin",p.appendChild(y);var v=document.createElement("button");return v.type="button",v.className="ml-auto px-2.5 py-1 text-xs font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700",v.textContent="Message",v.addEventListener("click",function(L){L.preventDefault();try{if(typeof window.openMessageOverlay=="function"){window.openMessageOverlay(a);return}typeof window.loadAdminManagement=="function"&&(window.loadAdminManagement(),setTimeout(function(){try{typeof window.openMessageOverlay=="function"&&window.openMessageOverlay(a)}catch{}},700))}catch{}}),n.appendChild(l),n.appendChild(p),n.appendChild(v),n}async function c(){try{let n=await(await fetch("/dashboard/api/admins/",{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json();return(n&&n.results?n.results:Array.isArray(n)?n:[]).filter(function(w){return String(w&&w.status).toLowerCase()==="online"})}catch{return[]}}function u(a){try{var n=r("online-admins-list");if(!n)return;if(n.setAttribute("aria-busy","true"),n.innerHTML="",!a||!a.length){var l=document.createElement("li");l.className="text-xs text-gray-500 dark:text-gray-400 px-2 py-1",l.textContent="No one online",n.appendChild(l)}else{var m=document.createDocumentFragment();a.forEach(function(w){m.appendChild(i(w))}),n.appendChild(m)}n.setAttribute("aria-busy","false")}catch{}}async function e(){u(await c())}window.refreshOnlineAdmins=e;function s(){try{if(!r("right-sidebar"))return;try{var a=window.matchMedia&&window.matchMedia("(min-width: 768px)");if(a&&a.matches){var n=r("right-sidebar");n&&n.classList.remove("hidden");var l=document.getElementById("content-root");l&&!l.classList.contains("md:mr-64")&&l.classList.add("md:mr-64")}}catch{}e(),window.__onlineAdminsTimer&&clearInterval(window.__onlineAdminsTimer),window.__onlineAdminsTimer=setInterval(e,8e3);var m=document.getElementById("toggleRightSidebar");m&&m.addEventListener("click",function(){var w=r("right-sidebar");w&&w.classList.toggle("hidden")})}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s(),(function(){function n(){try{var w=document.getElementById("right-sidebar"),h=document.querySelector("footer");if(!w||!h)return;var p=h.getBoundingClientRect(),y=window.innerHeight||document.documentElement.clientHeight,v=p.top<y;w.style.bottom=v?(h.offsetHeight||0)+"px":"0px"}catch{}}var l;function m(){l&&cancelAnimationFrame(l),l=requestAnimationFrame(n)}window.addEventListener("scroll",m,{passive:!0}),window.addEventListener("resize",m);try{new ResizeObserver(m).observe(document.querySelector("footer"))}catch{}document.addEventListener("DOMContentLoaded",n),setTimeout(n,0)})()})();(function(){try{window.__TABLE_LABELS_DEFAULT=window.__TABLE_LABELS_DEFAULT||{1:"Admin",2:"User",3:"Verified-Artist",4:"Payment",5:"Artist Service",6:"Artist Application",7:"Artist Availability",8:"Artist-Calendar",9:"Booking",10:"Message"},typeof window.getTableLabel!="function"&&(window.getTableLabel=function(r){var o=parseInt(r,10),d=window.TABLE_LABELS||window.__TABLE_LABELS_DEFAULT||{};return d[o]||"Table "+o})}catch{}})();(function(){try{var r=document.querySelector("[data-admin-avatar-url]"),o=r?r.getAttribute("data-admin-avatar-url"):"";o&&(window.__admin_avatar_url=o)}catch{}})();window.loadTables=async function(){try{let u=function(){try{let n=function(m){try{if(typeof window.refreshTable=="function"&&typeof window.setActiveTable=="function"){m&&m();return}var w=document.querySelector("script[data-dash-js]");if(w){setTimeout(function(){n(m)},0);return}var h=document.createElement("script");h.src="/static/js/dashboard.js?v=dev",h.setAttribute("data-dash-js","1"),h.onload=function(){m&&m()},document.head.appendChild(h)}catch{}},e=document.getElementById("tablePicker"),s=document.getElementById("loadTableBtn"),a=document.getElementById("refreshActiveBtn"),l=e?e.value:1;n(()=>{typeof window.setActiveTable=="function"&&window.setActiveTable(l)}),s&&s.addEventListener("click",()=>n(()=>window.setActiveTable(e.value))),a&&a.addEventListener("click",()=>n(()=>window.refreshTable(parseInt(e.value)))),e&&e.addEventListener("change",()=>n(()=>window.setActiveTable(e.value))),(function(){try{let T=function(){y.classList.remove("hidden"),p.setAttribute("aria-expanded","true")},x=function(){y.classList.add("hidden"),p.setAttribute("aria-expanded","false")},S=function(){y.classList.contains("hidden")?T():x()},M=function(b){if(b){h.value=String(b),v.textContent=window.getTableLabel?window.getTableLabel(b):"Table "+b;var D=document.createEvent("HTMLEvents");D.initEvent("change",!0,!1),h.dispatchEvent(D),x()}};var w=document.getElementById("tablePickerWrapper");if(!w||w.getAttribute("data-initialized")==="1")return;var h=document.getElementById("tablePicker"),p=document.getElementById("tablePickerDisplay"),y=document.getElementById("tablePickerList"),v=document.getElementById("tablePickerSelectedText");if(!h||!p||!y||!v)return;v.textContent=(function(){var b=h&&h.value?h.value:h&&h.options[0]?h.options[0].value:"1";return window.getTableLabel?window.getTableLabel(b):"Table "+b})();try{for(var L=y.querySelectorAll('li[role="option"]'),_=0;_<L.length;_++){var C=L[_].getAttribute("data-value"),k=L[_].querySelector('[data-role="label"]');k&&(k.textContent=window.getTableLabel(C))}}catch{}try{for(var f=document.querySelectorAll("[data-table-card]"),g=0;g<f.length;g++){var A=f[g].getAttribute("data-table-card"),E=f[g].querySelector("h2.font-semibold");E&&(E.textContent=window.getTableLabel(A))}}catch{}p.addEventListener("click",function(){S()}),y.addEventListener("click",function(b){var D=b.target.closest('li[role="option"]');D&&M(D.getAttribute("data-value"))}),p.addEventListener("keydown",function(b){(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),S()),b.key==="Escape"&&x()}),y.addEventListener("keydown",function(b){b.key==="Escape"&&x()}),document.addEventListener("click",function(b){w.contains(b.target)||x()}),w.setAttribute("data-initialized","1")}catch{}})();try{document.title=(document.title||"").replace(/\s·\s.*$/,"")+" \xB7 Tables"}catch{}window.showNotification&&window.showNotification("Tables","info");try{window.history&&window.history.pushState&&window.history.pushState({page:"tables"},"",N+"/tables/")}catch{}typeof window.setActiveSidebar=="function"&&window.setActiveSidebar(N+"/tables/"),window.__tablesAutoTimer&&(clearInterval(window.__tablesAutoTimer),window.__tablesAutoTimer=null),window.__tablesAutoTimer=setInterval(function(){try{var m=document.getElementById("tablePicker"),w=m?parseInt(m.value,10):1,h=typeof window.__tablesPauseUntil<"u"?window.__tablesPauseUntil:0;if(Date.now()<=(h||0))return;typeof refreshTable=="function"&&refreshTable(w)}catch{}},12e4)}catch{window.location.href="/dashboard/tables/"}};window.startLoading&&window.startLoading(),window.updateAriaStatus&&window.updateAriaStatus("Loading tables\u2026");let i=await fetch(N+"/tables/",{headers:{"X-Requested-With":"XMLHttpRequest"}});try{var t=i.headers&&i.headers.get("X-Label-Map");t&&(window.TABLE_LABELS=JSON.parse(t))}catch{}let c=await i.text();var r=document.getElementById("content-root");if(r&&(r.innerHTML=c),typeof window.refreshTable!="function"||typeof window.refreshLogs!="function"){var o=document.querySelector("script[data-dash-js]");if(o)setTimeout(u,0);else{var d=document.createElement("script");d.src="/static/js/dashboard.js?v=dev",d.async=!0,d.setAttribute("data-dash-js","1"),d.onload=u,d.onerror=function(){window.location.href=N+"/tables/"},document.head.appendChild(d)}}else u();window.toggleSidebar&&window.toggleSidebar(!1),window.updateAriaStatus&&window.updateAriaStatus("Tables loaded")}catch{window.updateAriaStatus&&window.updateAriaStatus("Failed to load tables"),window.showNotification&&window.showNotification("Failed to load tables","error"),window.location.href=N+"/tables/"}finally{window.stopLoading&&window.stopLoading()}};window.navToTables=function(t){try{return t&&t.preventDefault&&t.preventDefault(),window.loadTables&&window.loadTables(),!1}catch{return!0}};window.toggleSidebar=function(t){var r=document.getElementById("sidebar"),o=document.getElementById("sidebar-overlay");if(r){var d=r.classList.contains("hidden"),i=t===!0||t===void 0&&d?!0:t===!1?!1:!d;i?(r.classList.remove("hidden"),o&&o.classList.remove("hidden")):(r.classList.add("hidden"),o&&o.classList.add("hidden"))}};document.addEventListener("keydown",function(t){t.key==="Escape"&&window.toggleSidebar(!1)});window.loadAdminProfile=async function(){try{window.startLoading&&window.startLoading(),window.updateAriaStatus&&window.updateAriaStatus("Loading profile\u2026");let o=await(await fetch(B+"/profile/",{headers:{"X-Requested-With":"XMLHttpRequest"}})).text();var t=document.getElementById("content-root");t&&(t.innerHTML=o),(function(){try{let n=document.getElementById("content-root");if(!n)return;let l=n.querySelector("div.border-b button");l&&l.addEventListener("click",function(){typeof window.profileEnterEditMode=="function"&&window.profileEnterEditMode()});let m=n.querySelector('#profile-edit-mode button[type="button"]:not(.bg-gray-800)');m&&m.addEventListener("click",function(){typeof window.profileCancelEdit=="function"&&window.profileCancelEdit()});let w=n.querySelector("#avatar-input");w&&w.addEventListener("change",function(){typeof window.profileUploadAvatar=="function"&&window.profileUploadAvatar(w)});let h=n.querySelector("#avatar-input-edit");h&&h.addEventListener("change",function(){typeof window.profileUploadAvatar=="function"&&window.profileUploadAvatar(h)}),n.querySelectorAll("button").forEach(function(v){(v.textContent||"").trim().toLowerCase()==="delete"&&v.addEventListener("click",function(){typeof window.profileDeleteAvatar=="function"&&window.profileDeleteAvatar()})});let p=n.querySelector("#profile-edit-form");p&&p.addEventListener("submit",function(v){typeof window.profileSave=="function"&&window.profileSave(v)});let y=n.querySelector("#password-form");y&&y.addEventListener("submit",function(v){typeof window.profileChangePassword=="function"&&window.profileChangePassword(v)});try{let v=n.querySelector('#profile-edit-form input[name="birth_date"]');v&&attachTailwindDatepicker(v)}catch{}try{var i=n.querySelector(".w-36.h-36 img, img[alt='Avatar']"),c=document.querySelector(".user-profile-card");if(c){var u=c.querySelector(".w-12.h-12.rounded-full.overflow-hidden"),e=u?u.querySelector("img"):null,s=i&&i.getAttribute("src");if(s){if(e)e.src=s;else if(u){u.innerHTML="";var a=document.createElement("img");a.alt="Profile",a.loading="lazy",a.className="w-full h-full object-cover",a.src=s,u.appendChild(a)}try{c.setAttribute("data-admin-avatar-url",s)}catch{}}else u&&e&&u.removeChild(e)}}catch{}}catch{}})(),window.updateAriaStatus&&window.updateAriaStatus("Profile loaded"),window.toggleSidebar&&window.toggleSidebar(!1),window.showNotification&&window.showNotification("Profile","info")}catch{window.updateAriaStatus&&window.updateAriaStatus("Failed to load profile"),window.showNotification&&window.showNotification("Failed to load profile","error")}finally{window.stopLoading&&window.stopLoading()}};window.profileEnterEditMode=function(){var t=document.getElementById("profile-view-mode"),r=document.getElementById("profile-edit-mode");!t||!r||(t.classList.add("hidden"),r.classList.remove("hidden"),window.updateAriaStatus&&window.updateAriaStatus("Edit mode enabled"))};window.profileCancelEdit=function(){var t=document.getElementById("profile-view-mode"),r=document.getElementById("profile-edit-mode");!t||!r||(r.classList.add("hidden"),t.classList.remove("hidden"),window.updateAriaStatus&&window.updateAriaStatus("Edit mode cancelled"))};window.profileSave=async function(t){t&&t.preventDefault&&t.preventDefault();var r=document.getElementById("profile-edit-form");if(!r)return;let o=new FormData(r);try{(await(await fetch(B+"/profile/update/",{method:"POST",headers:{"X-CSRFToken":window.getCookie&&window.getCookie("csrftoken")},body:o})).json()).success?(window.updateAriaStatus&&window.updateAriaStatus("Profile saved"),window.showNotification&&window.showNotification("Profile updated","success"),window.loadAdminProfile&&window.loadAdminProfile()):window.showNotification&&window.showNotification("Save failed","error")}catch{window.showNotification&&window.showNotification("Network error","error")}};window.profileUploadAvatar=async function(t){if(!t||!t.files||!t.files[0])return;let r=new FormData;r.append("avatar",t.files[0]);try{let a=await(await fetch(B+"/profile/avatar/",{method:"POST",headers:{"X-CSRFToken":window.getCookie&&window.getCookie("csrftoken")},body:r})).json();if(a.success){window.updateAriaStatus&&window.updateAriaStatus("Avatar updated");try{var o=document.querySelector(".user-profile-card");if(o){var d=o.querySelector(".w-12.h-12.rounded-full.overflow-hidden"),i=d?d.querySelector("img"):null,c=URL.createObjectURL(t.files[0]);if(i)i.src=c;else if(d){d.innerHTML="";var u=document.createElement("img");u.alt="Profile",u.loading="lazy",u.className="w-full h-full object-cover",u.src=c,d.appendChild(u)}try{o.setAttribute("data-admin-avatar-url",c)}catch{}}}catch{}window.loadAdminProfile&&window.loadAdminProfile()}else{var e=a&&(a.error||a.message)||"Avatar upload failed";window.showNotification&&window.showNotification(e,"error")}}catch{window.showNotification&&window.showNotification("Avatar upload error","error")}};window.profileDeleteAvatar=async function(){try{if((await(await fetch(B+"/profile/avatar/delete/",{method:"POST",headers:{"X-CSRFToken":window.getCookie&&window.getCookie("csrftoken")}})).json()).success){window.updateAriaStatus&&window.updateAriaStatus("Avatar removed");try{var t=document.querySelector(".user-profile-card"),r=t&&t.querySelector(".w-12.h-12.rounded-full.overflow-hidden"),o=r&&r.querySelector("img");r&&o&&r.removeChild(o),t&&t.setAttribute("data-admin-avatar-url","")}catch{}window.loadAdminProfile&&window.loadAdminProfile()}else window.showNotification&&window.showNotification("Avatar delete failed","error")}catch{window.showNotification&&window.showNotification("Avatar delete error","error")}};window.profileChangePassword=async function(t){t&&t.preventDefault&&t.preventDefault();var r=document.getElementById("password-form");if(!r)return;let o=new FormData(r);try{let i=await(await fetch(B+"/profile/password/",{method:"POST",headers:{"X-CSRFToken":window.getCookie&&window.getCookie("csrftoken")},body:o})).json();i.success?(window.updateAriaStatus&&window.updateAriaStatus("Password updated"),window.showNotification&&window.showNotification("Password updated","success"),r.reset()):window.showNotification&&window.showNotification(i.error||"Password update failed","error")}catch{window.showNotification&&window.showNotification("Password update error","error")}};window.attachTailwindDatepicker=function(t){try{let m=function(f){return(f<10?"0":"")+f},w=function(f){return f?f.getFullYear()+"-"+m(f.getMonth()+1)+"-"+m(f.getDate()):""},h=function(f){try{if(!f)return null;var g=String(f).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!g)return null;var A=new Date(parseInt(g[1],10),parseInt(g[2],10)-1,parseInt(g[3],10));return isNaN(A.getTime())?null:A}catch{return null}},p=function(f,g){return f&&g&&f.getFullYear()===g.getFullYear()&&f.getMonth()===g.getMonth()&&f.getDate()===g.getDate()},y=function(){e.innerHTML="";var f=n.getFullYear(),g=n.getMonth();u.textContent=n.toLocaleString(void 0,{month:"long",year:"numeric"});var A=new Date(f,g,1),E=new Date(A);E.setDate(A.getDate()-A.getDay());for(var T=0;T<42;T++){var x=new Date(E);x.setDate(E.getDate()+T);var S=document.createElement("button");S.type="button";var M=x.getMonth()!==g;S.className="text-sm px-2 py-1 rounded text-center w-8 h-8 flex items-center justify-center "+(M?"text-gray-400 dark:text-gray-500 ":"text-gray-900 dark:text-gray-100 ")+(p(x,l)?"bg-blue-600 text-white ":"hover:bg-gray-100 dark:hover:bg-gray-800 "),S.textContent=x.getDate(),S.addEventListener("click",(function(b){return function(){l=b,t.value=w(b),L(),t.dispatchEvent(new Event("change",{bubbles:!0}))}})(new Date(x))),e.appendChild(S)}},v=function(){o.classList.remove("hidden"),k(),document.addEventListener("keydown",_,!0),document.addEventListener("click",C,!0)},L=function(){o.classList.add("hidden"),document.removeEventListener("keydown",_,!0),document.removeEventListener("click",C,!0)},_=function(f){f.key==="Escape"&&L()},C=function(f){!o.contains(f.target)&&f.target!==t&&L()},k=function(){try{var f=t.getBoundingClientRect(),g=t.parentElement.getBoundingClientRect();o.style.left=Math.max(0,f.left-g.left)+"px"}catch{}};if(!t||t._twDatepicker)return;var r=t.getAttribute("type")||"text";r!=="text"&&t.setAttribute("type","text"),t.setAttribute("inputmode","numeric"),t.setAttribute("placeholder","YYYY-MM-DD");var o=document.createElement("div");o.className="absolute z-50 mt-1 w-64 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl p-2 hidden",o.setAttribute("role","dialog");var d=document.createElement("div");d.className="flex items-center justify-between mb-2";var i=document.createElement("button");i.type="button",i.className="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800",i.innerHTML="&#x2039;";var c=document.createElement("button");c.type="button",c.className="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800",c.innerHTML="&#x203A;";var u=document.createElement("div");u.className="text-sm font-medium",d.appendChild(i),d.appendChild(u),d.appendChild(c);var e=document.createElement("div");e.className="grid grid-cols-7 gap-1";var s=["Su","Mo","Tu","We","Th","Fr","Sa"],a=document.createElement("div");a.className="grid grid-cols-7 gap-1 mb-1 text-[11px] text-gray-500 dark:text-gray-400",s.forEach(function(f){var g=document.createElement("div");g.className="text-center",g.textContent=f,a.appendChild(g)}),o.appendChild(d),o.appendChild(a),o.appendChild(e),t.parentElement.style.position=t.parentElement.style.position||"relative",t.parentElement.appendChild(o);var n=h(t.value)||new Date;n.setHours(0,0,0,0);var l=h(t.value);i.addEventListener("click",function(){n.setMonth(n.getMonth()-1),y()}),c.addEventListener("click",function(){n.setMonth(n.getMonth()+1),y()}),t.addEventListener("focus",function(){y(),v()}),t.addEventListener("click",function(){y(),v()}),t.addEventListener("blur",function(){}),t.addEventListener("input",function(){var f=h(t.value);f&&(l=f,n=new Date(f),n.setDate(1))}),t._twDatepicker={open:v,close:L}}catch{}};window.loadAdminManagement=async function(){try{let d=function(i){try{if(typeof window.initAdminManagement=="function"){i&&i();return}var c=document.querySelector("script[src$='/static/js/admin_management.js']");if(c){setTimeout(function(){d(i)},0);return}var u=document.createElement("script");u.src="/static/js/admin_management.js",u.onload=function(){i&&i()},document.head.appendChild(u)}catch{}};window.startLoading&&window.startLoading(),window.updateAriaStatus&&window.updateAriaStatus("Loading admin management\u2026");let o=await(await fetch(N+"/Admin_management/",{headers:{"X-Requested-With":"XMLHttpRequest"}})).text();var t=document.getElementById("content-root");t&&(t.innerHTML=o),d(function(){try{window.initAdminManagement&&window.initAdminManagement()}catch{}});try{window.history&&window.history.pushState&&window.history.pushState({page:"admin_mgmt"},"",N+"/Admin_management/")}catch{}typeof window.setActiveSidebar=="function"&&window.setActiveSidebar(N+"/Admin_management/"),window.toggleSidebar&&window.toggleSidebar(!1),window.showNotification&&window.showNotification("Admin Management","info"),window.updateAriaStatus&&window.updateAriaStatus("Admin management loaded")}catch{window.updateAriaStatus&&window.updateAriaStatus("Failed to load admin management"),window.location.href=N+"/Admin_management/"}finally{window.stopLoading&&window.stopLoading()}};document.addEventListener("DOMContentLoaded",function(){try{var t=document.getElementById("themeToggle");t&&!t.getAttribute("data-csp-bound")&&(t.addEventListener("click",function(e){e.preventDefault();try{var s=document.documentElement.classList.contains("dark"),a=s?"light":"dark";typeof window.__setTheme=="function"&&window.__setTheme(a),window.updateAriaStatus&&window.updateAriaStatus(a==="dark"?"Dark mode enabled":"Dark mode disabled")}catch{}}),t.setAttribute("data-csp-bound","1"))}catch{}try{var r=document.querySelector("a[href='/dashboard/tables/']");r&&r.addEventListener("click",function(e){typeof window.loadTables=="function"&&(e.preventDefault(),window.loadTables())});try{var o=document.querySelector("a[href='"+N+"/Admin_management/']");o&&o.addEventListener("click",function(e){typeof window.loadAdminManagement=="function"&&(e.preventDefault(),window.loadAdminManagement())})}catch{}}catch{}try{(function(){try{var s=document.getElementById("chart-table-distribution");s&&typeof window.initDashboardCharts=="function"&&window.initDashboardCharts();var a=document.getElementById("donut-cards");a&&typeof window.initDashboardDonuts=="function"&&window.initDashboardDonuts();var n=document.getElementById("dashboardChartRefresh");n&&n.addEventListener("click",function(){typeof window.refreshDashboardCharts=="function"&&window.refreshDashboardCharts()}),typeof window.initDashboardStatsWS=="function"&&window.initDashboardStatsWS()}catch{}})();var d=document.getElementById("notifBtn");if(d&&!d.getAttribute("data-csp-bound")){try{d.removeAttribute("onclick")}catch{}d.setAttribute("data-csp-bound","1")}}catch{}try{var i=document.getElementById("userMenu"),c=i?i.previousElementSibling:null;if(i&&c&&!c.getAttribute("data-csp-bound")){try{c.removeAttribute("onclick")}catch{}c.addEventListener("click",function(e){e.preventDefault();var s=i.classList.contains("hidden");s?i.classList.remove("hidden"):i.classList.add("hidden");try{c.setAttribute("aria-expanded",s?"true":"false")}catch{}}),document.addEventListener("click",function(e){try{!i.contains(e.target)&&!c.contains(e.target)&&(i.classList.add("hidden"),c.setAttribute("aria-expanded","false"))}catch{}}),document.addEventListener("keydown",function(e){if(e.key==="Escape")try{i.classList.add("hidden"),c.setAttribute("aria-expanded","false")}catch{}}),c.setAttribute("data-csp-bound","1")}}catch{}try{var u=document.querySelector('header [aria-controls="sidebar"]');if(u&&!u.getAttribute("data-csp-bound")){try{u.removeAttribute("onclick")}catch{}u.addEventListener("click",function(e){e.preventDefault(),typeof window.toggleSidebar=="function"&&window.toggleSidebar(!0)}),u.setAttribute("data-csp-bound","1")}}catch{}try{typeof window.setActiveSidebar=="function"&&window.setActiveSidebar(window.location.pathname)}catch{}try{window.addEventListener("popstate",function(){try{if(location.pathname==="/dashboard/tables/")typeof window.loadTables=="function"&&window.loadTables(),typeof window.setActiveSidebar=="function"&&window.setActiveSidebar("/dashboard/tables/");else if(location.pathname==="/dashboard/"){if(window.__tablesAutoTimer){try{clearInterval(window.__tablesAutoTimer)}catch{}window.__tablesAutoTimer=null}typeof window.setActiveSidebar=="function"&&window.setActiveSidebar("/dashboard/"),window.location.href="/dashboard/"}}catch{}})}catch{}try{window.__tablesAutoTimer&&(clearInterval(window.__tablesAutoTimer),window.__tablesAutoTimer=null)}catch{}try{document.addEventListener("keydown",function(e){try{var s=e.target&&e.target.closest&&e.target.closest(".user-profile-card");if(!s)return;(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),typeof window.loadAdminProfile=="function"&&window.loadAdminProfile())}catch{}})}catch{}try{document.addEventListener("click",function(e){var s=e.target,a=s&&(s.id==="sidebar-overlay"?s:s.closest&&s.closest("#sidebar-overlay"));if(a){e.preventDefault(),typeof window.toggleSidebar=="function"&&window.toggleSidebar(!1);return}var n=s&&s.closest&&s.closest(".status-trigger");if(n){e.preventDefault();var l=document.getElementById("status-dropdown-menu");if(l){var m=l.classList.contains("hidden");l.classList.toggle("hidden");try{n.setAttribute("aria-expanded",m?"true":"false")}catch{}if(m){for(var w=l.querySelectorAll('button[role="menuitemradio"]'),h=(document.getElementById("current-status")||{}).textContent||"",p=0;p<w.length;p++){w[p].setAttribute("tabindex","-1");var y=w[p].getAttribute("data-status"),v=h.toLowerCase().indexOf(y)>=0;w[p].setAttribute("aria-checked",v?"true":"false")}w&&w[0]&&w[0].focus()}else try{n.focus()}catch{}}return}var L=s&&s.closest&&s.closest(".user-profile-card");if(L&&!(s.closest&&(s.closest(".status-dropdown")||s.closest("#status-dropdown-menu")))){e.preventDefault(),typeof window.loadAdminProfile=="function"&&window.loadAdminProfile();return}var _=s&&s.closest&&s.closest("#status-dropdown-menu button");if(_){e.preventDefault();var C=(_.textContent||"").toLowerCase(),k=C.indexOf("unavailable")>=0?"unavailable":"available";try{var f=document.getElementById("current-status"),g=document.getElementById("status-dropdown-menu");if(f){f.textContent="";let S=document.createElement("span");S.className="w-2 h-2 me-1 rounded-full";let M=document.createTextNode(k==="available"?"Available":"Unavailable");k==="available"?(f.className="inline-flex items-center bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300 text-xs font-medium px-2.5 py-0.5 rounded-full",S.classList.add("bg-green-500")):(f.className="inline-flex items-center bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300 text-xs font-medium px-2.5 py-0.5 rounded-full",S.classList.add("bg-red-500")),f.appendChild(S),f.appendChild(M)}try{for(var A=document.querySelectorAll('#status-dropdown-menu button[role="menuitemradio"]'),E=0;E<A.length;E++){var T=A[E].getAttribute("data-status");A[E].setAttribute("aria-checked",T===k?"true":"false")}}catch{}g&&g.classList.add("hidden");try{var x=document.querySelector(".status-trigger");x&&(x.setAttribute("aria-expanded","false"),x.focus())}catch{}}catch{}return}}),document.addEventListener("click",function(e){try{var s=document.getElementById("status-dropdown-menu"),a=document.querySelector(".status-trigger");if(!s||!a)return;if(!a.contains(e.target)&&!s.contains(e.target)){s.classList.add("hidden");try{a.setAttribute("aria-expanded","false")}catch{}}}catch{}})}catch{}});window.setActiveSidebar=function(t){try{var r=document.getElementById("sidebar");if(!r)return;var o=r.querySelectorAll("a[href]"),d=(t||"").replace(/\/$/,"/")||"/";o.forEach(function(i){i.classList.remove("bg-gray-100"),i.removeAttribute("aria-current")}),o.forEach(function(i){try{var c=i.getAttribute("href")||"",u=new URL(c,window.location.origin),e=(u.pathname||"").replace(/\/$/,"/")||"/";e===d&&(i.classList.add("bg-gray-100"),i.classList.add("dark:bg-gray-800"),i.setAttribute("aria-current","page"))}catch{}})}catch{}};(function(){function t(){try{var d=document.getElementById("sidebar"),i=document.querySelector("footer");if(!d||!i)return;var c=i.getBoundingClientRect(),u=window.innerHeight||document.documentElement.clientHeight,e=c.top<u;if(e){var s=Math.max(i.offsetHeight||0,0);d.style.bottom=s+"px"}else d.style.bottom="0px"}catch{}}var r;function o(){r&&cancelAnimationFrame(r),r=requestAnimationFrame(t)}window.addEventListener("scroll",o,{passive:!0}),window.addEventListener("resize",o);try{new ResizeObserver(t).observe(document.querySelector("footer"))}catch{}document.addEventListener("DOMContentLoaded",t),setTimeout(t,0)})();})();
//# sourceMappingURL=base.js.map
