(()=>{function h(e){let t=null;if(document.cookie&&document.cookie!==""){let o=document.cookie.split(";");for(let n=0;n<o.length;n++){let a=o[n].trim();if(a.substring(0,e.length+1)===e+"="){t=decodeURIComponent(a.substring(e.length+1));break}}}return t}function b(e){let t=document.getElementById(e);t&&t.classList.toggle("hidden")}var w=[],f=!1;function C(){let e=document.getElementById("toastContainer");return e||(e=document.createElement("div"),e.id="toastContainer",e.className="fixed top-4 left-0 right-0 z-50 flex justify-center items-start pointer-events-none",document.body.appendChild(e)),e}function S(e,t,o){let n="bg-blue-600",a="\u2139\uFE0F";t==="success"&&(n="bg-green-600",a="\u2714\uFE0F"),t==="error"&&(n="bg-red-600",a="\u26A0\uFE0F");let s=document.createElement("div");s.className="pointer-events-auto";let i=document.createElement("div");i.setAttribute("role","status"),i.setAttribute("aria-live","polite"),i.className=`${n} text-white px-4 py-3 rounded shadow-lg max-w-sm w-[min(92vw,28rem)]`,i.innerHTML=`
    <div class="flex items-start gap-2">
      <span class="text-lg leading-none">${a}</span>
      <div class="flex-1">
        <div class="font-medium">${e}</div>
        ${o?`<div class="opacity-90 text-sm mt-0.5">${o}</div>`:""}
      </div>
    </div>`,s.style.transition="transform 220ms ease, opacity 220ms ease",s.style.transform="translateY(-10px)",s.style.opacity="0",C().appendChild(s),s.appendChild(i),requestAnimationFrame(()=>{s.style.transform="translateY(0)",s.style.opacity="1"});let c=setTimeout(()=>y(s),3e3);s.addEventListener("click",()=>{clearTimeout(c),y(s)})}function y(e){e.style.transform="translateY(-10px)",e.style.opacity="0",setTimeout(()=>{e.remove(),f=!1,p()},220)}function p(){if(f)return;let e=w.shift();e&&(f=!0,S(e.message,e.type,e.details))}function k(e,t="info",o=""){w.push({message:e,type:t,details:o}),p()}window.getCookie=h;window.toggleDropdown=b;window.showNotification=k;var l=0,r=null;function v(){let e=document.getElementById("globalProgressBar");return e||(e=document.createElement("div"),e.id="globalProgressBar",e.className="fixed top-0 left-0 h-0.5 bg-blue-600 dark:bg-blue-400 z-[60] transition-[width,opacity] duration-300 ease-out",e.style.width="0%",e.style.opacity="0",document.body.appendChild(e)),e}function T(){let e=v();l++,l===1&&(e.style.opacity="1",e.style.width="0%",requestAnimationFrame(()=>{e.style.width="80%"}),r&&clearTimeout(r),r=setTimeout(()=>{e.style.width="90%"},4e3))}function _(){let e=v();l=Math.max(0,l-1),l===0&&(r&&(clearTimeout(r),r=null),e.style.width="100%",setTimeout(()=>{e.style.opacity="0"},200),setTimeout(()=>{e.style.width="0%"},600))}async function E(e){try{return T(),await e}finally{_()}}window.startLoading=T;window.stopLoading=_;window.withLoading=E;document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("logoutForm");e&&e.addEventListener("submit",async t=>{t.preventDefault();try{let n=await(await fetch(e.getAttribute("action")||"/logout/",{method:"POST",headers:{"X-CSRFToken":h("csrftoken")}})).json();window.location.href=n&&n.redirect?n.redirect:"/login/"}catch{window.location.href="/login/"}})});function m(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let o=0;o<5;o++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function R(){try{return JSON.parse(localStorage.getItem("uidMap")||"{}")}catch{return{}}}function x(e){try{localStorage.setItem("uidMap",JSON.stringify(e))}catch{}}function L(e){let t=R();if(t[e])return t[e];let o=m(),n=new Set(Object.values(t));for(;n.has(o);)o=m();return t[e]=o,x(t),o}window.generateUniqueID=m;window.getPersistentUID=L;async function I(e,t){t=t||{};let o=(t.method||"GET").toUpperCase(),n=o==="GET"||o==="HEAD"||o==="OPTIONS"||o==="TRACE",a=typeof e=="string"?e:e&&e.url||"";if((!/^https?:\/\//i.test(a)||a.indexOf(location.origin)===0)&&!n){t.headers=t.headers||{};var i=(function(){try{var u=h("csrftoken");if(u)return u}catch{}try{var c=document.querySelector('meta[name="csrf-token"]');if(c&&(c.content||"").trim())return c.content.trim()}catch{}try{var d=document.getElementById("csrf-token-global");if(d&&(d.value||d.content))return d.value||d.content}catch{}return""})();t.headers instanceof Headers?(!t.headers.has("X-CSRFToken")&&i&&t.headers.set("X-CSRFToken",i),t.headers.has("X-Requested-With")||t.headers.set("X-Requested-With","XMLHttpRequest")):(!t.headers["X-CSRFToken"]&&i&&(t.headers["X-CSRFToken"]=i),t.headers["X-Requested-With"]||(t.headers["X-Requested-With"]="XMLHttpRequest")),t.credentials=t.credentials||"same-origin"}return fetch(e,t)}window.fetchWithCSRF=I;})();
//# sourceMappingURL=common.js.map
