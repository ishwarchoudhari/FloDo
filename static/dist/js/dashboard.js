(()=>{function p(a){try{return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}catch{return a}}function T(){try{if(typeof window.getCookie=="function"){let i=window.getCookie("csrftoken");if(i)return i}let a="csrftoken=",n=(document.cookie||"").split(";");for(let i=0;i<n.length;i++){let o=n[i].trim();if(o.startsWith(a))return decodeURIComponent(o.substring(a.length))}try{let i=document.querySelector('input[name="csrfmiddlewaretoken"]');if(i&&i.value)return String(i.value)}catch{}return""}catch{return""}}async function A(a,n=1,i=""){let o=`/dashboard/api/table/${a}/?page=${n}&per_page=10&q=${encodeURIComponent(i)}`,r=await fetch(o,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}});return r.status===403?{success:!1,error:"Forbidden"}:r.json()}function x(a,n){let i=document.querySelector(`#table-${a} tbody`);if(!i)return;i.innerHTML="",(n.results||[]).forEach(t=>{let l=t.unique_id||t.id||t.pk||`${t.name}|${t.city}|${t.phone}`,f=window.getPersistentUID?window.getPersistentUID(`t${a}:${l}`):t.unique_id||l,d=t.id||t.pk||t.unique_id,s=document.createElement("tr");s.className="border-b",s.innerHTML=`
      <td class="py-2 pr-2">${p(f)}</td>
      <td class="py-2 pr-2"><span data-field="name" class="block">${p(t.name??"")}</span></td>
      <td class="py-2 pr-2"><span data-field="city" class="block">${p(t.city??"")}</span></td>
      <td class="py-2 pr-2"><span data-field="phone" class="block">${p(t.phone??"")}</span></td>
      <td class="py-2 pr-2 space-x-2 whitespace-nowrap">
        <button class="px-2 py-1 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-700" data-action="edit" data-id="${d}" aria-label="Edit row ${f}">Edit</button>
        <button class="px-2 py-1 bg-red-600 text-white rounded hidden focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-600" data-action="delete" data-id="${d}" aria-label="Delete row ${f}">Delete</button>
        <button class="px-2 py-1 bg-blue-600 text-white rounded hidden focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-600" data-action="save" data-id="${d}" aria-label="Save changes to row ${f}">Save</button>
      </td>`,i.appendChild(s)});function o(t){if(!t)return;t.classList.remove("bg-yellow-50"),t.querySelectorAll("td").forEach(d=>{let s=d.querySelector("input[data-field]");if(s){let c=s.value,u=s.dataset.field;d.innerHTML="";let h=document.createElement("span");h.setAttribute("data-field",u),h.className="block",h.textContent=c,d.appendChild(h)}});let l=t.querySelector('button[data-action="edit"]'),f=t.querySelectorAll('button[data-action="delete"], button[data-action="save"]');l&&l.classList.remove("hidden"),f.forEach(d=>d.classList.add("hidden")),t.classList.remove("editing")}function r(t){let l=t.closest("tbody").querySelector("tr.editing");l&&l!==t&&o(l),t.classList.add("editing","bg-yellow-50"),t.querySelectorAll("span[data-field]").forEach(c=>{let u=c.getAttribute("data-field"),h=c.textContent||"",w=c.parentElement;w.innerHTML="";let m=document.createElement("input");m.className="border rounded px-2 py-1 w-full",m.value=h,m.setAttribute("data-field",u),w.appendChild(m)});let f=t.querySelector('button[data-action="edit"]'),d=t.querySelectorAll('button[data-action="delete"], button[data-action="save"]');f&&f.classList.add("hidden"),d.forEach(c=>c.classList.remove("hidden"));let s=t.querySelector("input[data-field]");s&&s.focus(),t.querySelectorAll("input[data-field]").forEach(c=>{c.onkeydown=u=>{if(u=u||window.event,u.key==="Enter"){let h=t.querySelector('button[data-action="save"]');h&&h.click()}else u.key==="Escape"&&o(t)}}),typeof window.noteTablesFormActivity=="function"&&window.noteTablesFormActivity()}i.querySelectorAll('button[data-action="edit"]').forEach(t=>{t.addEventListener("click",()=>{let l=t.closest("tr");r(l)})}),i.querySelectorAll('button[data-action="save"]').forEach(t=>{t.addEventListener("click",async()=>{let l=t.getAttribute("data-id"),f=t.closest("tr"),d=f.querySelectorAll("input[data-field]"),s=f.querySelector('input[data-field="name"]')?.value?.trim()||"",c=f.querySelector('input[data-field="city"]')?.value?.trim()||"",u=f.querySelector('input[data-field="phone"]')?.value?.trim()||"",h=/^[A-Za-z ]+$/.test(s)&&s.length>0,w=/^[A-Za-z ]+$/.test(c)&&c.length>0,m=/^\d{10}$/.test(u);if(!h||!w||!m){let y="Validation failed:";h||(y+=" Name must contain only letters and spaces."),w||(y+=" City must contain only letters and spaces."),m||(y+=" Phone must be exactly 10 digits."),typeof showNotification=="function"&&showNotification("Invalid input","error",y.trim());return}let g=new FormData;d.forEach(y=>g.append(y.dataset.field,y.value.trim()));let L=t.textContent;t.disabled=!0,t.setAttribute("aria-busy","true"),t.textContent="Saving...",t.classList.add("opacity-50","cursor-not-allowed");let b=await S(a,l,g);if(t.disabled=!1,t.removeAttribute("aria-busy"),t.textContent=L,t.classList.remove("opacity-50","cursor-not-allowed"),b.success){let y=b.data||{},E=`Row #${y.id||l}: ${[y.name||"",y.city||"",y.phone||""].filter(Boolean).join(" \u2022 ")}`;showNotification("Saved","success",E),o(f),typeof _=="function"&&_();try{typeof window.bumpNotificationsNow=="function"&&window.bumpNotificationsNow()}catch{}try{typeof window.__tablesPauseUntil<"u"&&(window.__tablesPauseUntil=0),window.__tablesInactivityTimer&&(clearTimeout(window.__tablesInactivityTimer),window.__tablesInactivityTimer=null)}catch{}}else showNotification("Save failed","error",b.error||"");v(a)})}),i.querySelectorAll('button[data-action="delete"]').forEach(t=>{t.addEventListener("click",async()=>{let l=t.getAttribute("data-id");if(!window.confirm("Delete row "+l+"? This action cannot be undone."))return;let d=t.textContent;t.disabled=!0,t.setAttribute("aria-busy","true"),t.textContent="Deleting...",t.classList.add("opacity-50","cursor-not-allowed");let s=await C(a,l);if(t.disabled=!1,t.removeAttribute("aria-busy"),t.textContent=d,t.classList.remove("opacity-50","cursor-not-allowed"),s.success){let c=`Row #${l}`;showNotification("Deleted","success",c),typeof _=="function"&&_();try{typeof window.bumpNotificationsNow=="function"&&window.bumpNotificationsNow()}catch{}try{typeof window.__tablesPauseUntil<"u"&&(window.__tablesPauseUntil=0),window.__tablesInactivityTimer&&(clearTimeout(window.__tablesInactivityTimer),window.__tablesInactivityTimer=null)}catch{}}else showNotification("Delete failed","error",s.error||"");v(a)})});let e=document.getElementById(`pagination-${a}`);e&&(e.textContent=`Page ${n.page} of ${n.num_pages} \u2014 Total ${n.total}`)}async function k(a,n){try{n.append("csrfmiddlewaretoken",T())}catch{}let i=()=>fetch(`/dashboard/api/table/${a}/row/`,{method:"POST",headers:{"X-CSRFToken":T(),"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",body:n});return(await(window.withLoading?window.withLoading(i()):i())).json()}async function S(a,n,i){i=i||new FormData,i.append("_method","PUT");try{i.append("csrfmiddlewaretoken",T())}catch{}let o=()=>fetch(`/dashboard/api/table/${a}/row/${n}/`,{method:"POST",headers:{"X-CSRFToken":T(),"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",body:i});return(await(window.withLoading?window.withLoading(o()):o())).json()}async function C(a,n){let i=new FormData;i.append("_method","DELETE");try{i.append("csrfmiddlewaretoken",T())}catch{}let o=()=>fetch(`/dashboard/api/table/${a}/row/${n}/`,{method:"POST",headers:{"X-CSRFToken":T(),"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",body:i});return(await(window.withLoading?window.withLoading(o()):o())).json()}async function v(a){let n=document.getElementById(`search-${a}`)?.value||"",i=await A(a,1,n);i.success&&x(a,i)}function $(a){try{let n=parseInt(a,10)||1,i=document.getElementById("tablePicker");if(i&&(i.value=String(n)),n===1){i&&(i.value=String(2));try{typeof showNotification=="function"&&showNotification("Table 1 is managed in Admin Management. Showing Table 2 here.","info")}catch{}typeof v=="function"&&v(2);return}try{let o=document.getElementById("tablePickerWrapper"),r=document.getElementById("tablePickerSelectedText"),e=document.getElementById("tablePickerList"),t={};try{t=JSON.parse(o?.getAttribute("data-label-map")||"{}")}catch{t={}}let l=t[String(n)]||`Table ${n}`;r&&(r.textContent=l),e&&e.querySelectorAll('li[role="option"]').forEach(d=>{let s=d.getAttribute("data-value");d.classList.toggle("active",String(s)===String(n))});let f=document.getElementById("activeTableInfo");f&&(f.textContent=`Active: ${l}`)}catch{}try{document.querySelectorAll("[data-table-card]").forEach(o=>{parseInt(o.getAttribute("data-table-card"),10)===n?o.classList.remove("hidden"):o.classList.add("hidden")})}catch{}typeof v=="function"&&v(n)}catch{}}function I(a){let n=document.getElementById(`add-name-${a}`),i=document.getElementById(`add-city-${a}`),o=document.getElementById(`add-phone-${a}`),r=(n?.value||"").trim(),e=(i?.value||"").trim(),t=(o?.value||"").trim(),l=/^[A-Za-z ]+$/.test(r)&&r.length>0,f=/^[A-Za-z ]+$/.test(e)&&e.length>0,d=/^\d{10}$/.test(t);if(!l||!f||!d){let w="Validation failed:";l||(w+=" Name must contain only letters and spaces."),f||(w+=" City must contain only letters and spaces."),d||(w+=" Phone must be exactly 10 digits."),typeof showNotification=="function"&&showNotification("Invalid input","error",w.trim()),n&&n.focus();return}let s=new FormData;s.append("name",r||""),s.append("city",e||""),s.append("phone",t||"");let c=n?n.closest("div"):null,u=c?c.querySelector("button"):null,h=u?u.textContent:"";u&&(u.disabled=!0,u.setAttribute("aria-busy","true"),u.textContent="Adding...",u.classList.add("opacity-50","cursor-not-allowed")),n&&(n.disabled=!0),i&&(i.disabled=!0),o&&(o.disabled=!0),k(a,s).then(w=>{if(w.success){let m=w.data||{},g=`Row #${m.id||""}: ${[m.name||"",m.city||"",m.phone||""].filter(Boolean).join(" \u2022 ")}`;showNotification("Row added","success",g);try{typeof window.bumpNotificationsNow=="function"&&window.bumpNotificationsNow()}catch{}try{typeof window.__tablesPauseUntil<"u"&&(window.__tablesPauseUntil=0),window.__tablesInactivityTimer&&(clearTimeout(window.__tablesInactivityTimer),window.__tablesInactivityTimer=null)}catch{}v(a),typeof _=="function"&&_(),n&&(n.value=""),i&&(i.value=""),o&&(o.value=""),n&&n.focus()}else showNotification("Add failed","error",w.error||"")}).catch(()=>{showNotification("Add failed","error","Network error")}).finally(()=>{u&&(u.disabled=!1,u.removeAttribute("aria-busy"),u.textContent=h||"Add",u.classList.remove("opacity-50","cursor-not-allowed")),n&&(n.disabled=!1),i&&(i.disabled=!1),o&&(o.disabled=!1)})}async function _(){let a="";try{let e=document.querySelector("[data-log-filter].is-active");e&&(a=e.getAttribute("data-log-filter")||"")}catch{a=""}let n=new URLSearchParams;n.set("per_page","10"),a&&n.set("table_name",a);let o=await(await fetch(`/dashboard/api/logs/?${n.toString()}`,{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json(),r=document.querySelector("#logs-table tbody");r.innerHTML="",(o.results||[]).forEach(e=>{let t=document.createElement("tr");t.className="border-b",t.innerHTML=`
      <td class="py-2 pr-2">${p(e.timestamp)}</td>
      <td class="py-2 pr-2">${p(e.table_name)}</td>
      <td class="py-2 pr-2">${p(e.action)}</td>
      <td class="py-2 pr-2">${p(e.row_id)}</td>
      <td class="py-2 pr-2">${p(e.admin_user||"-")}</td>`,r.appendChild(t)})}window.fetchTableData=A;window.updateTableDisplay=x;window.createTableRow=k;window.updateTableRow=S;window.deleteTableRow=C;window.refreshTable=v;window.setActiveTable=$;window.addRow=I;window.refreshLogs=_;function P(a,n){let i;return function(){let o=this,r=arguments;clearTimeout(i),i=setTimeout(function(){a.apply(o,r)},n)}}window.__handleLiveSearch||(window.__handleLiveSearch=P(function(a){try{if(!a||!a.id||a.id.indexOf("search-")!==0)return;let n=parseInt(a.id.slice(7),10);isNaN(n)||v(n)}catch{}},250));document.addEventListener("input",function(a){let n=a&&(a.target||a.srcElement);!n||n.tagName!=="INPUT"||n.id&&n.id.indexOf("search-")===0&&window.__handleLiveSearch(n)});document.addEventListener("click",function(a){try{let n=a.target&&a.target.closest("button");if(!n)return;if(n.hasAttribute("data-log-filter")){a.preventDefault();try{let c=n.parentElement;c&&c.querySelectorAll("[data-log-filter]").forEach(u=>{u.classList.remove("is-active"),u.setAttribute("aria-pressed","false")})}catch{}n.classList.add("is-active"),n.setAttribute("aria-pressed","true"),typeof window.refreshLogs=="function"&&window.refreshLogs();return}let i=n.classList&&n.classList.contains("bg-green-600"),o=n.getAttribute&&n.getAttribute("onclick")||"",r=/addRow\s*\(/.test(o),e=/refreshTable\s*\(/.test(o),t=(n.textContent||"").trim().toLowerCase(),l=t==="refresh",f=t==="search";if(!(i||r||e||l))return;let d=NaN,s=n.closest&&n.closest("[data-table-card]");if(s&&(d=parseInt(s.getAttribute("data-table-card"),10)),isNaN(d)){let c=o,u=c.match(/addRow\s*\(\s*parseInt\(\s*'?(\d+)'?\s*,\s*10\s*\)\s*\)/);u||(u=c.match(/refreshTable\s*\(\s*parseInt\(\s*'?(\d+)'?\s*,\s*10\s*\)\s*\)/)),u&&(d=parseInt(u[1],10))}if(isNaN(d)){let c=document.getElementById("tablePicker");c&&(d=parseInt(c.value,10))}if(isNaN(d))return;if(a.preventDefault(),a.stopPropagation&&a.stopPropagation(),i||r)typeof window.addRow=="function"&&window.addRow(d);else if(e||l)try{window.location.reload(!0)}catch{window.location.reload()}else f&&typeof window.refreshTable=="function"&&window.refreshTable(d)}catch{}});(function(){async function a(){try{let o=new URL("/api/v1/logs/",window.location.origin);o.searchParams.set("table_name","Client"),o.searchParams.set("per_page","8");let e=await(await fetch(o.toString(),{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json();return e&&e.results?e.results:[]}catch{return[]}}function n(o){let r=document.getElementById("client-activity-card");if(!r)return;if(r.innerHTML="",!o||o.length===0){let t=document.createElement("div");t.className="text-sm text-gray-500",t.textContent="No recent client activity.",r.appendChild(t);return}let e=document.createElement("ul");e.className="space-y-2",o.forEach(t=>{let l=document.createElement("li");l.className="flex items-start gap-2";let f=document.createElement("span");f.className="inline-flex items-center px-2 py-0.5 rounded text-[11px] font-semibold "+(t.action==="CREATE"?"bg-emerald-50 text-emerald-700":t.action==="LOGIN"?"bg-blue-50 text-blue-700":t.action==="LOGOUT"?"bg-gray-100 text-gray-700":"bg-indigo-50 text-indigo-700"),f.textContent=t.action||"";let d=document.createElement("div");d.className="text-sm text-gray-800 dark:text-gray-200",d.innerHTML=`<div><strong>${p(t.table_name||"Client")}</strong> \xB7 ${p(t.row_id||"")}</div><div class="text-xs text-gray-500">${p(t.timestamp||"")}</div>`,l.appendChild(f),l.appendChild(d),e.appendChild(l)}),r.appendChild(e)}window.hydrateClientActivityCard=function(){a().then(n).catch(()=>{})};let i=180*1e3;window.__tablesPauseUntil=0,window.__tablesInactivityTimer=null,window.noteTablesFormActivity=function(){try{window.__tablesPauseUntil=Date.now()+i,window.__tablesInactivityTimer&&(clearTimeout(window.__tablesInactivityTimer),window.__tablesInactivityTimer=null)}catch{}},document.addEventListener("focusin",function(o){let r=o.target;r&&(r.id&&r.id.indexOf("add-")===0||r.matches("input[data-field]"))&&window.noteTablesFormActivity()}),document.addEventListener("input",function(o){let r=o.target;r&&(r.id&&r.id.indexOf("add-")===0||r.matches("input[data-field]"))&&window.noteTablesFormActivity()})})();(function(){window.refreshClientLogs=async function(){try{let r=function(s){try{let c=new Date(s),h=Math.max(0,Math.floor((new Date-c)/1e3));if(h<10)return"just now";if(h<60)return`${h}s ago`;let w=Math.floor(h/60);if(w<60)return`${w} min ago`;let m=Math.floor(w/60);if(m<24)return`${m} h ago`;let g=Math.floor(m/24);return g<7?`${g} d ago`:c.toLocaleString()}catch{return s}};var n=r;let i=document.getElementById("client-logs-table");if(!i)return;let o=i.querySelector("tbody");if(!o)return;(function(){try{if(document.getElementById("notifGlowStyles"))return;let c=document.createElement("style");c.id="notifGlowStyles",c.textContent=`
@keyframes notifPulse{0%{box-shadow:0 0 0 0 rgba(59,130,246,.28)}70%{box-shadow:0 0 0 10px rgba(59,130,246,0)}100%{box-shadow:0 0 0 0 rgba(59,130,246,0)}}
@keyframes notifGlowOut{0%{background-color:rgba(59,130,246,0.06)}100%{background-color:transparent}}
.notif-new{background-color:rgba(59,130,246,0.06); animation:notifPulse 1800ms ease-out infinite}
.dark .notif-new{background-color:rgba(59,130,246,0.12)}
.notif-fade{animation:notifGlowOut 600ms ease-out 1}`,document.head.appendChild(c)}catch{}})();let e=new URL("/api/v1/logs/",window.location.origin);e.searchParams.set("table_name","Client"),e.searchParams.set("per_page","8");let l=await(await fetch(e.toString(),{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json().catch(()=>({})),f=l&&l.results?l.results:[];if(o.innerHTML="",!f.length){let s=document.createElement("tr");s.innerHTML='<td class="py-3 text-gray-500 dark:text-gray-300" colspan="6">No recent client activity.</td>',o.appendChild(s);return}let d=Date.now();f.forEach(s=>{let c=document.createElement("tr"),u=!1;try{u=Math.abs(d-new Date(s.timestamp).getTime())<=60*1e3}catch{}c.className="border-b "+(u?"notif-new":"");let h=s.row_details||{},w=h.full_name||h.name||"",m=h.email||"",g=h.location||h.city||"",L=h.phone||"",b=(s.action||"").toUpperCase(),y="";b==="CREATE"?y='<svg class="w-4 h-4 text-emerald-600 inline-block align-[-2px] mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293A1 1 0 106.293 10.707l2 2a1 1 0 001.414 0l3.999-4z"/></svg>':b==="LOGIN"?y='<svg class="w-4 h-4 text-blue-600 inline-block align-[-2px] mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M3 4a2 2 0 012-2h6a2 2 0 012 2v3h-2V4H5v12h6v-3h2v3a2 2 0 01-2 2H5a2 2 0 01-2-2V4z"/><path d="M12 11h-5v-2h5V6l5 4-5 4v-3z"/></svg>':b==="LOGOUT"?y='<svg class="w-4 h-4 text-gray-600 inline-block align-[-2px] mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M7 4a2 2 0 012-2h3a2 2 0 012 2v3h-2V4H9v12h3v-3h2v3a2 2 0 01-2 2H9a2 2 0 01-2-2V4z"/><path d="M13 11H5V9h8V6l5 4-5 4v-3z"/></svg>':b==="PASSWORD_RESET"?y='<svg class="w-4 h-4 text-indigo-600 inline-block align-[-2px] mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10 2a4 4 0 00-4 4v2H5a3 3 0 00-3 3v4a3 3 0 003 3h10a3 3 0 003-3v-4a3 3 0 00-3-3h-1V6a4 4 0 00-4-4zm-2 6V6a2 2 0 114 0v2H8z"/></svg>':b==="FORGOT_PASSWORD"?y='<svg class="w-4 h-4 text-amber-600 inline-block align-[-2px] mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM9 14h2v2H9v-2zm1-9a3 3 0 00-3 3h2a1 1 0 112 0c0 .667-.333 1.111-1.2 1.8C9.333 10.4 9 11 9 12h2c0-.5.167-.8.8-1.3.866-.7 2.2-1.5 2.2-3.7a3 3 0 00-3-3z"/></svg>':b==="ARTIST_APPLY"&&(y='<svg class="w-4 h-4 text-violet-600 inline-block align-[-2px] mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M4 3a2 2 0 00-2 2v10l4-2 4 2 4-2 4 2V5a2 2 0 00-2-2H4z"/></svg>'),c.innerHTML=`
          <td class="py-2 pr-2">${p(r(s.timestamp||""))}</td>
          <td class="py-2 pr-2">${p(w)}</td>
          <td class="py-2 pr-2">${p(m)}</td>
          <td class="py-2 pr-2">${p(g)}</td>
          <td class="py-2 pr-2">${p(L)}</td>
          <td class="py-2 pr-2">${y}${p(b)}</td>`,o.appendChild(c)})}catch{}};let a=180*1e3;window.__tablesPauseUntil=0,window.__tablesInactivityTimer=null,window.noteTablesFormActivity=function(){try{window.__tablesPauseUntil=Date.now()+a,window.__tablesInactivityTimer&&(clearTimeout(window.__tablesInactivityTimer),window.__tablesInactivityTimer=null)}catch{}},document.addEventListener("focusin",function(n){let i=n.target;i&&(i.id&&i.id.indexOf("add-")===0||i.matches("input[data-field]"))&&window.noteTablesFormActivity()}),document.addEventListener("input",function(n){let i=n.target;i&&(i.id&&i.id.indexOf("add-")===0||i.matches("input[data-field]"))&&window.noteTablesFormActivity()})})();(function(){typeof window.__autoPauseUntil>"u"&&(window.__autoPauseUntil=0),Object.defineProperty(window,"__tablesPauseUntil",{get(){return window.__autoPauseUntil},set(e){window.__autoPauseUntil=e}});function n(){return Date.now()<=(window.__autoPauseUntil||0)}window.__refreshTablesInFlight=!1,window.__refreshLogsInFlight=!1;function i(){try{if(n())return;var e=document.getElementById("tablePicker"),t=e?parseInt(e.value,10):1;!window.__refreshTablesInFlight&&typeof window.refreshTable=="function"&&(window.__refreshTablesInFlight=!0,Promise.resolve(window.refreshTable(t)).catch(()=>{}).finally(()=>{window.__refreshTablesInFlight=!1})),!window.__refreshLogsInFlight&&typeof window.refreshLogs=="function"&&(window.__refreshLogsInFlight=!0,Promise.resolve(window.refreshLogs()).catch(()=>{}).finally(()=>{window.__refreshLogsInFlight=!1}))}catch{}}function o(){try{if(window.__tablesAutoTimer){try{clearInterval(window.__tablesAutoTimer)}catch{}window.__tablesAutoTimer=null}window.__tablesAutoTimer=setInterval(i,3e3)}catch{}}function r(){try{let e=document.getElementById("tablePicker"),t=document.getElementById("loadTableBtn"),l=document.getElementById("refreshActiveBtn"),f=e?e.value:1;typeof window.setActiveTable=="function"&&window.setActiveTable(f),t&&t.addEventListener("click",()=>window.setActiveTable(e.value)),l&&l.addEventListener("click",()=>{try{window.location.reload(!0)}catch{window.location.reload()}}),e&&e.addEventListener("change",()=>window.setActiveTable(e.value));try{document.title=(document.title||"").replace(/\s·\s.*$/,"")+" \xB7 Tables"}catch{}typeof window.setActiveSidebar=="function"&&window.setActiveSidebar("/dashboard/tables/");try{let d=document.getElementById("tablePickerWrapper"),s=document.getElementById("tablePickerList"),c=document.getElementById("tablePickerDisplay"),u=document.getElementById("tablePickerSelectedText"),h={};try{h=JSON.parse(d?.getAttribute("data-label-map")||"{}")}catch{h={}}s&&s.querySelectorAll('li[role="option"]').forEach(w=>{let m=w.getAttribute("data-value"),g=w.querySelector('[data-role="label"]');g&&(g.textContent=h[String(m)]||`Table ${m}`)}),document.querySelectorAll("[data-table-card]").forEach(w=>{let m=parseInt(w.getAttribute("data-table-card"),10),g=w.querySelector("h2");g&&(g.textContent=h[String(m)]||`Table ${m}`)}),d&&e&&(d.classList.remove("hidden"),e.classList.add("hidden")),u&&e&&(u.textContent=h[String(e.value)]||`Table ${e.value}`),c&&s&&(c.addEventListener("click",function(){s.classList.contains("hidden")?(s.classList.remove("hidden"),c.setAttribute("aria-expanded","true")):(s.classList.add("hidden"),c.setAttribute("aria-expanded","false"))}),s.addEventListener("click",function(w){let m=w.target&&w.target.closest('li[role="option"]');if(!m)return;let g=m.getAttribute("data-value");e&&(e.value=String(parseInt(g,10)||1)),u&&e&&(u.textContent=h[String(e.value)]||`Table ${e.value}`),typeof window.setActiveTable=="function"&&window.setActiveTable(e.value),s.classList.add("hidden"),c.setAttribute("aria-expanded","false")}),document.addEventListener("click",function(w){try{let m=w.target;if(!m)return;d&&!d.contains(m)&&!c.contains(m)&&(s.classList.add("hidden"),c.setAttribute("aria-expanded","false"))}catch{}}),document.addEventListener("keydown",function(w){w.key==="Escape"&&(s.classList.add("hidden"),c.setAttribute("aria-expanded","false"))}))}catch{}o(),window.addEventListener("beforeunload",function(){try{window.__tablesAutoTimer&&(clearInterval(window.__tablesAutoTimer),window.__tablesAutoTimer=null)}catch{}})}catch{}}if(window.initTablesFullPage=r,document.readyState==="loading")document.addEventListener("DOMContentLoaded",function(){document.getElementById("tablePicker")&&r();try{typeof window.initAdminOverview=="function"&&window.initAdminOverview()}catch{}try{document.getElementById("client-activity-card")&&hydrateClientActivityCard()}catch{}try{document.getElementById("client-logs-table")&&refreshClientLogs()}catch{}try{if(!window.__clientLogsWrapped&&typeof window.bumpNotificationsNow=="function"){let e=window.bumpNotificationsNow;window.bumpNotificationsNow=function(){try{e&&e()}catch{}try{document.getElementById("client-logs-table")&&refreshClientLogs()}catch{}},window.__clientLogsWrapped=!0}}catch{}});else{document.getElementById("tablePicker")&&r();try{typeof window.initAdminOverview=="function"&&window.initAdminOverview()}catch{}try{document.getElementById("client-logs-table")&&refreshClientLogs()}catch{}try{if(!window.__clientLogsWrapped&&typeof window.bumpNotificationsNow=="function"){let e=window.bumpNotificationsNow;window.bumpNotificationsNow=function(){try{e&&e()}catch{}try{document.getElementById("client-logs-table")&&refreshClientLogs()}catch{}},window.__clientLogsWrapped=!0}}catch{}}})();(function(){async function a(){try{let r=new URL("/dashboard/api/admins/",window.location.origin),t=await(await fetch(r.toString(),{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json();return t&&t.success?t.results||[]:[]}catch{return[]}}function n(r){let e=String(r||"").toLowerCase()==="online";return`<span class="inline-flex items-center"><span class="w-2.5 h-2.5 rounded-full mr-2 ${e?"bg-green-500":"bg-red-500"}"></span>${e?"Online":"Offline"}</span>`}function i(r){let e=document.getElementById("admin-overview");if(!e)return;let t=document.createElement("div");t.className="flex items-center justify-between mb-3 text-gray-900 dark:text-gray-100";let l=document.createElement("h3");l.className="text-lg font-semibold",l.textContent="Admins Overview";let f=document.createElement("a");if(f.className="px-3 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-900",f.href="/dashboard/Admin_management/",f.textContent="Admin Management",t.appendChild(l),t.appendChild(f),!r||r.length===0){e.innerHTML="",e.appendChild(t);let s=document.createElement("div");s.className="text-sm text-gray-500",s.textContent="No admins to display. You may not have permission or there is no data yet.",e.appendChild(s);return}let d=document.createElement("div");d.className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",(r||[]).forEach(s=>{let c=document.createElement("div");c.className="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md transition p-4 cursor-pointer",c.setAttribute("role","link"),c.setAttribute("tabindex","0"),c.addEventListener("click",function(){window.location.href="/dashboard/Admin_management/"}),c.addEventListener("keydown",function(m){(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),window.location.href="/dashboard/Admin_management/")});let u=s.full_name||s.username||"",h=s.user_name||"",w=s.status||"offline";c.innerHTML=`
        <div class="flex items-start justify-between">
          <div>
            <div class="text-xs text-gray-500 dark:text-gray-400">ID #${p(s.id)}</div>
            <div class="text-base font-semibold text-gray-900 dark:text-gray-100">${p(u)}</div>
            <div class="text-xs text-gray-600 dark:text-gray-300 break-all">${p(h)}</div>
          </div>
          <div class="text-sm">${n(w)}</div>
        </div>
      `,d.appendChild(c)}),e.innerHTML="",e.appendChild(t),e.appendChild(d)}async function o(){if(!document.getElementById("admin-overview"))return;let e=await a();i(e)}window.initAdminOverview=o})();})();
//# sourceMappingURL=dashboard.js.map
