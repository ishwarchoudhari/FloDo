(()=>{async function f(e){return(await fetchWithCSRF("/login/",{method:"POST",body:e})).json()}async function p(e){return(await fetchWithCSRF("/signup/",{method:"POST",body:e})).json()}async function y(){return(await fetchWithCSRF("/logout/",{method:"POST"})).json()}window.loginUser=f;window.signupUser=p;window.logoutUser=y;document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("loginForm");if(!e)return;let o=document.getElementById("loginLoader"),t=document.getElementById("loginError"),a=document.getElementById("loginBtn"),d=document.getElementById("btnSpinner"),r=document.getElementById("btnText");function l(c){!a||!d||!r||(c?(a.disabled=!0,a.classList.add("opacity-80","cursor-not-allowed"),d.classList.remove("hidden"),r.textContent="Signing in\u2026"):(a.disabled=!1,a.classList.remove("opacity-80","cursor-not-allowed"),d.classList.add("hidden"),r.textContent="Sign in"))}e.addEventListener("submit",async c=>{c.preventDefault(),t&&(t.classList.add("hidden"),t.textContent=""),l(!0);try{let i=new FormData(e),w=(i.get("username")||"").trim(),g=i.get("password")||"";if(!w||!g){t&&(t.textContent="Please enter both username and password.",t.classList.remove("hidden")),l(!1);return}let s=await f(i);if(s&&s.success){window.updateAriaStatus&&window.updateAriaStatus("Login successful. Redirecting to dashboard."),o&&(o.classList.remove("hidden"),o.classList.add("flex")),e.parentElement&&e.parentElement.classList.add("opacity-0","translate-y-2");try{let n=document.getElementById("loading");n||(n=document.createElement("div"),n.id="loading",n.textContent="Please wait...");let u=e&&e.closest(".w-full.max-w-lg"),h=u&&u.parentElement||document.body,m=e&&e.parentElement?e.parentElement:null;m&&m.classList.add("hidden"),n.classList.remove("hidden"),n.isConnected||h.appendChild(n);try{n.scrollIntoView({block:"center",behavior:"smooth"})}catch{}}catch{}setTimeout(()=>{window.location.href=s.redirect||"/dashboard/"},3e3)}else{let n=s&&(s.error||s.detail)||"Invalid username or password";t&&(t.textContent=n,t.classList.remove("hidden")),window.updateAriaStatus&&window.updateAriaStatus("Login failed. "+n),e.parentElement&&(e.parentElement.classList.add("motion-safe:animate-[shake_0.3s]"),setTimeout(()=>e.parentElement.classList.remove("motion-safe:animate-[shake_0.3s]"),350))}}catch{t&&(t.textContent="Network error. Please try again.",t.classList.remove("hidden")),window.updateAriaStatus&&window.updateAriaStatus("Network error during login.")}finally{l(!1)}})});})();
//# sourceMappingURL=auth.js.map
