{
  "version": 3,
  "sources": ["../../js/admin_management.js"],
  "sourcesContent": ["/* static/js/admin_management.js */\r\n(function(){\r\n  function qs(sel, root){ return (root||document).querySelector(sel); }\r\n  function qsa(sel, root){ return Array.prototype.slice.call((root||document).querySelectorAll(sel)); }\r\n  function csrf(){\r\n    try {\r\n      // 1) If a helper exists, use it but fall back if it returns empty\r\n      if (typeof window.getCookie === 'function'){\r\n        const v = window.getCookie('csrftoken');\r\n        if (v) return v;\r\n      }\r\n      // 2) Parse document.cookie\r\n      const name = 'csrftoken=';\r\n      const parts = (document.cookie || '').split(';');\r\n      for (let i=0;i<parts.length;i++){\r\n        const c = parts[i].trim();\r\n        if (c.startsWith(name)) return decodeURIComponent(c.substring(name.length));\r\n      }\r\n      // 3) Fallback: look for hidden input value if present in page\r\n      try {\r\n        const el = document.querySelector('input[name=\"csrfmiddlewaretoken\"]');\r\n        if (el && el.value) return String(el.value);\r\n      } catch(_){ }\r\n      return '';\r\n    } catch(_){ return ''; }\r\n  }\r\n  function notify(msg, type){ if (window.showNotification) window.showNotification(msg, type||'info'); }\r\n  function escapeHtml(s){ const div=document.createElement('div'); div.textContent=String(s==null?'':s); return div.innerHTML; }\r\n  // Client-side cache and pagination (DRF-compatible)\r\n  let __adminsCache = [];\r\n  let __nextUrl = null; // DRF provides absolute/relative `next` URL; if present, we show Load more\r\n  // Abort controller for list fetches to prevent piling requests during rapid typing\r\n  let __adminFetchCtl = null;\r\n\r\n  // Focus trap utilities (safe no-ops if anything fails)\r\n  function getFocusable(root){\r\n    try {\r\n      return Array.prototype.slice.call(root.querySelectorAll(\r\n        'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex]:not([tabindex=\"-1\"])'\r\n      )).filter(function(el){ return el.offsetParent !== null || el === document.activeElement; });\r\n    } catch(_) { return []; }\r\n  }\r\n  function setupFocusTrap(container){\r\n    try {\r\n      if (!container || container._focusTrapHandlers) return;\r\n      const focusables = getFocusable(container);\r\n      const first = focusables[0];\r\n      const last = focusables[focusables.length - 1];\r\n      function onKeydown(e){\r\n        if (e.key !== 'Tab') return;\r\n        const f = getFocusable(container);\r\n        const firstEl = f[0], lastEl = f[f.length-1];\r\n        if (!firstEl || !lastEl) return;\r\n        if (e.shiftKey){\r\n          if (document.activeElement === firstEl){ e.preventDefault(); lastEl.focus(); }\r\n        } else {\r\n          if (document.activeElement === lastEl){ e.preventDefault(); firstEl.focus(); }\r\n        }\r\n      }\r\n      function onFocusin(e){\r\n        if (!container.contains(e.target)){\r\n          const f = getFocusable(container); if (f[0]) f[0].focus();\r\n        }\r\n      }\r\n      document.addEventListener('keydown', onKeydown, true);\r\n      document.addEventListener('focusin', onFocusin, true);\r\n      // initial focus\r\n      try { if (first) first.focus(); } catch(_){ }\r\n      container._focusTrapHandlers = { onKeydown, onFocusin };\r\n    } catch(_) { /* no-op */ }\r\n  }\r\n  function teardownFocusTrap(container){\r\n    try {\r\n      if (!container || !container._focusTrapHandlers) return;\r\n      const { onKeydown, onFocusin } = container._focusTrapHandlers;\r\n      document.removeEventListener('keydown', onKeydown, true);\r\n      document.removeEventListener('focusin', onFocusin, true);\r\n      delete container._focusTrapHandlers;\r\n    } catch(_) { /* no-op */ }\r\n  }\r\n\r\n  // ------------------ Recover Password Mini-Dialog ------------------\r\n  function openRecoverPasswordDialog(u){\r\n    const portal = qs('#admin-add-portal');\r\n    if (!portal) { notify('Portal not found', 'error'); return; }\r\n    portal.classList.remove('pointer-events-none');\r\n    const host = document.createElement('div');\r\n    host.setAttribute('data-recover-host','');\r\n    const uname = (u.full_name||u.username||u.user_name||'').toString();\r\n    host.innerHTML = `\r\n      <div class=\"fixed inset-0 z-40 bg-black/40 opacity-0 transition-opacity duration-200\" data-overlay></div>\r\n      <div class=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n        <div class=\"w-[90vw] sm:w-full max-w-xl transform scale-95 opacity-0 transition-all duration-200\">\r\n          <div class=\"bg-white dark:bg-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl overflow-hidden\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Recover Password\">\r\n            <div class=\"px-6 py-4 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between\">\r\n              <h3 class=\"text-lg font-semibold\">Recover Password</h3>\r\n              <button type=\"button\" class=\"text-gray-500 hover:text-gray-900 dark:hover:text-white text-2xl leading-none\" data-cancel aria-label=\"Close\">&times;</button>\r\n            </div>\r\n            <div class=\"px-6 py-5 space-y-5\">\r\n              <div class=\"rounded-lg p-3 border border-yellow-200 bg-yellow-50 text-yellow-800 dark:border-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200 text-sm\">\r\n                <strong class=\"font-semibold\">Caution:</strong> Changing this password will immediately update the admin\u2019s credentials. Share the new password securely and ensure it meets your policy.\r\n              </div>\r\n              <div class=\"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm\">\r\n                <div class=\"flex items-baseline gap-2\"><span class=\"text-gray-500 dark:text-gray-400\">ID:</span><span class=\"font-medium\">${escapeHtml(u.id)}</span></div>\r\n                <div class=\"flex items-baseline gap-2\"><span class=\"text-gray-500 dark:text-gray-400\">Username:</span><span class=\"font-medium break-all\">${escapeHtml(u.user_name||'\u2014')}</span></div>\r\n                <div class=\"flex items-baseline gap-2\"><span class=\"text-gray-500 dark:text-gray-400\">Name:</span><span class=\"font-medium break-all\">${escapeHtml(uname)}</span></div>\r\n                <div class=\"flex items-baseline gap-2\"><span class=\"text-gray-500 dark:text-gray-400\">City:</span><span class=\"font-medium\">${escapeHtml(u.city||'\u2014')}</span></div>\r\n                <div class=\"flex items-baseline gap-2\"><span class=\"text-gray-500 dark:text-gray-400\">Phone:</span><span class=\"font-medium\">${escapeHtml(u.phone||'\u2014')}</span></div>\r\n              </div>\r\n              <div class=\"space-y-3\">\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Enter new password</span>\r\n                  <input type=\"password\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" data-new-pass autocomplete=\"new-password\" />\r\n                </label>\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Confirm password</span>\r\n                  <input type=\"password\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" data-confirm-pass autocomplete=\"new-password\" />\r\n                </label>\r\n                <p class=\"text-xs text-gray-500 dark:text-gray-400\">Minimum 12 characters, including upper, lower, digit, and symbol.</p>\r\n                <p class=\"text-xs text-red-600 dark:text-red-400 hidden\" data-error></p>\r\n              </div>\r\n              <div class=\"flex items-center justify-end gap-3\">\r\n                <button type=\"button\" class=\"px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700\" data-cancel>Cancel</button>\r\n                <button type=\"button\" class=\"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\" data-save disabled>Save</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n    portal.appendChild(host);\r\n    // Animate in\r\n    requestAnimationFrame(function(){ const ov=qs('[data-overlay]',host); const box=qs('.transform',host); if(ov) ov.classList.add('opacity-100'); if(box){ box.classList.remove('scale-95','opacity-0'); box.classList.add('scale-100','opacity-100'); }});\r\n    // Handlers\r\n    const ov = qs('[data-overlay]', host);\r\n    const btnCancel = host.querySelector('[data-cancel]');\r\n    const btnSave = host.querySelector('[data-save]');\r\n    const inpNew = host.querySelector('[data-new-pass]');\r\n    const inpConf = host.querySelector('[data-confirm-pass]');\r\n    const errEl = host.querySelector('[data-error]');\r\n    function cleanup(){ try { teardownFocusTrap(host); host.remove(); } catch(_){} }\r\n    function close(){ const box=qs('.transform',host); const ovl=qs('[data-overlay]',host); if(ovl) ovl.classList.remove('opacity-100'); if(box){ box.classList.remove('scale-100','opacity-100'); box.classList.add('scale-95','opacity-0'); } setTimeout(cleanup,200); }\r\n    function validate(){\r\n      try {\r\n        const p = (inpNew.value||''); const c = (inpConf.value||'');\r\n        const ok_len = p.length >= 12;\r\n        const ok_up = /[A-Z]/.test(p);\r\n        const ok_low = /[a-z]/.test(p);\r\n        const ok_dig = /\\d/.test(p);\r\n        const ok_sym = /[^A-Za-z0-9]/.test(p);\r\n        const ok_match = p === c && p.length>0;\r\n        const policy = ok_len && ok_up && ok_low && ok_dig && ok_sym;\r\n        const ok = policy && ok_match;\r\n        if (btnSave) btnSave.disabled = !ok;\r\n        if (!ok_match && (p||c)) { errEl.textContent = 'Passwords do not match.'; errEl.classList.remove('hidden'); }\r\n        else if ((p||'').length && !policy) { errEl.textContent = 'Password too weak. Follow the policy.'; errEl.classList.remove('hidden'); }\r\n        else { errEl.textContent=''; errEl.classList.add('hidden'); }\r\n      } catch(_){ }\r\n    }\r\n    if (inpNew) inpNew.addEventListener('input', validate);\r\n    if (inpConf) inpConf.addEventListener('input', validate);\r\n    if (ov) ov.addEventListener('click', close);\r\n    // Bind all cancel buttons (header X and footer Cancel)\r\n    try { host.querySelectorAll('[data-cancel]').forEach(function(btn){\r\n      btn.addEventListener('click', function(e){ e.preventDefault(); e.stopPropagation(); close(); });\r\n    }); } catch(_){ if (btnCancel) btnCancel.addEventListener('click', close); }\r\n    document.addEventListener('keydown', function onKey(e){ if(e.key==='Escape'){ document.removeEventListener('keydown', onKey); close(); } });\r\n    if (btnSave) btnSave.addEventListener('click', async function(){\r\n      try {\r\n        const p = (inpNew && inpNew.value) || '';\r\n        const c = (inpConf && inpConf.value) || '';\r\n        if (!p || p !== c) { notify('Passwords must match', 'error'); return; }\r\n        // Spinner state\r\n        const orig = btnSave.innerHTML; btnSave.disabled = true; btnSave.classList.add('opacity-70','cursor-wait');\r\n        btnSave.innerHTML = '<svg class=\"animate-spin -ml-1 mr-2 h-4 w-4 inline\" viewBox=\"0 0 24 24\"><circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle><path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z\"></path></svg>Saving...';\r\n        const fd = new FormData(); fd.append('_method','PUT'); fd.append('action','recover_password'); fd.append('password', p);\r\n        const doFetch = () => fetch(`/dashboard/api/admins/${u.id}/`, { method:'POST', headers: { 'X-CSRFToken': csrf() }, body: fd });\r\n        const res = await (window.withLoading ? window.withLoading(doFetch()) : doFetch());\r\n        let data = null; try { data = await res.json(); } catch(_){ data = res.ok ? {success:true}: {success:false}; }\r\n        if (res.ok && data && data.success){\r\n          notify(`Password changed for ${(u.full_name||u.username||u.user_name||u.id)}`, 'success');\r\n          try { if (typeof window.bumpNotificationsNow==='function') window.bumpNotificationsNow(); } catch(_){ }\r\n          close();\r\n        } else {\r\n          notify((data && data.error) || `Failed (HTTP ${res.status})`, 'error');\r\n          btnSave.innerHTML = orig; btnSave.classList.remove('opacity-70','cursor-wait'); btnSave.disabled = false;\r\n        }\r\n      } catch(err){\r\n        notify('Network error', 'error');\r\n        btnSave.innerHTML = 'Save'; btnSave.classList.remove('opacity-70','cursor-wait'); btnSave.disabled = false;\r\n      }\r\n    });\r\n    // Focus management\r\n    try { inpNew && inpNew.focus(); } catch(_){ }\r\n    setupFocusTrap(host);\r\n  }\r\n\r\n  async function fetchAdmins(q){\r\n    const url = new URL('/dashboard/api/admins/', window.location.origin);\r\n    if (q) url.searchParams.set('q', q);\r\n    try {\r\n      // Cancel any in-flight request before starting a new one\r\n      try { if (__adminFetchCtl) { __adminFetchCtl.abort(); } } catch(_){ }\r\n      __adminFetchCtl = (typeof AbortController !== 'undefined') ? new AbortController() : null;\r\n      const res = await fetch(url, {\r\n        headers: { 'X-Requested-With': 'XMLHttpRequest' },\r\n        signal: (__adminFetchCtl && __adminFetchCtl.signal) || undefined,\r\n        cache: 'no-store',\r\n        credentials: 'same-origin'\r\n      });\r\n      if (!res.ok) throw new Error('Failed to load admins');\r\n      return res.json();\r\n    } finally {\r\n      // Release controller after completion\r\n      try { __adminFetchCtl = null; } catch(_){ }\r\n    }\r\n  }\r\n\r\n  // Remove a card from UI and cache by id\r\n  function removeAdminFromUI(id){\r\n    try {\r\n      const grid = qs('#admin-card-grid');\r\n      if (grid){\r\n        const card = grid.querySelector(`[data-id=\"${id}\"]`);\r\n        if (card) card.remove();\r\n      }\r\n    } catch(_){ }\r\n    try {\r\n      if (Array.isArray(__adminsCache)){\r\n        __adminsCache = __adminsCache.filter(function(x){ return String(x && x.id) !== String(id); });\r\n      }\r\n    } catch(_){ }\r\n  }\r\n\r\n  // ------------------ Big Confirmation Dialog Helper ------------------\r\n  function openConfirmDialog(opts){\r\n    opts = opts || {};\r\n    const title = opts.title || 'Confirm';\r\n    const message = opts.message || 'Are you sure?';\r\n    const confirmText = opts.confirmText || 'Confirm';\r\n    const confirmClass = opts.confirmClass || 'bg-blue-600 hover:bg-blue-700';\r\n    const onConfirm = typeof opts.onConfirm === 'function' ? opts.onConfirm : null; // optional async handler\r\n    const portal = qs('#admin-add-portal');\r\n    if (!portal) { notify('Portal not found', 'error'); return Promise.resolve(false); }\r\n    portal.classList.remove('pointer-events-none');\r\n    // Create a host that sits on top of any existing modal content in the same portal\r\n    const host = document.createElement('div');\r\n    host.setAttribute('data-confirm-host','');\r\n    host.innerHTML = `\r\n      <div class=\"fixed inset-0 z-[60] bg-black/50 opacity-0 transition-opacity duration-200\" data-overlay></div>\r\n      <div class=\"fixed inset-0 z-[70] flex items-center justify-center p-3\">\r\n        <div class=\"w-full max-w-2xl transform scale-95 opacity-0 transition-all duration-200\">\r\n          <div class=\"bg-white dark:bg-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl\" role=\"dialog\" aria-modal=\"true\" aria-label=\"${escapeHtml(title)}\">\r\n            <div class=\"px-6 py-5 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between\">\r\n              <h3 class=\"text-xl font-semibold text-gray-900 dark:text-gray-100\">${escapeHtml(title)}</h3>\r\n              <button type=\"button\" class=\"text-gray-500 hover:text-gray-900 dark:hover:text-white\" data-cancel aria-label=\"Close\">&times;</button>\r\n            </div>\r\n            <div class=\"px-6 py-5\">\r\n              <p class=\"text-sm text-gray-700 dark:text-gray-300\">${escapeHtml(message)}</p>\r\n              <div class=\"mt-6 flex items-center gap-3 justify-end\">\r\n                <button type=\"button\" class=\"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-800 dark:text-gray-100\" data-cancel>Cancel</button>\r\n                <button type=\"button\" class=\"px-4 py-2 rounded-lg text-white ${confirmClass}\" data-confirm>${escapeHtml(confirmText)}</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n    portal.appendChild(host);\r\n    return new Promise(function(resolve){\r\n      requestAnimationFrame(function(){\r\n        const ov = qs('[data-overlay]', host);\r\n        const box = qs('.transform', host);\r\n        if (ov) ov.classList.add('opacity-100');\r\n        if (box){ box.classList.remove('scale-95','opacity-0'); box.classList.add('scale-100','opacity-100'); }\r\n      });\r\n      function cleanup(val){\r\n        const ov = qs('[data-overlay]', host);\r\n        const box = qs('.transform', host);\r\n        if (ov) ov.classList.remove('opacity-100');\r\n        if (box){ box.classList.remove('scale-100','opacity-100'); box.classList.add('scale-95','opacity-0'); }\r\n        setTimeout(function(){ try { host.remove(); } catch(_) {} resolve(val); }, 200);\r\n      }\r\n      function onEsc(e){ if (e.key === 'Escape') { document.removeEventListener('keydown', onEsc); cleanup(false); } }\r\n      document.addEventListener('keydown', onEsc);\r\n      const overlay = qs('[data-overlay]', host);\r\n      if (overlay) overlay.addEventListener('click', function(){ document.removeEventListener('keydown', onEsc); cleanup(false); });\r\n      const btnCancel = host.querySelector('[data-cancel]');\r\n      const btnConfirm = host.querySelector('[data-confirm]');\r\n      if (btnCancel) btnCancel.addEventListener('click', function(){ document.removeEventListener('keydown', onEsc); cleanup(false); });\r\n      if (btnConfirm) btnConfirm.addEventListener('click', async function(){\r\n        document.removeEventListener('keydown', onEsc);\r\n        if (onConfirm){\r\n          try {\r\n            // Visual loading state\r\n            const originalHtml = btnConfirm.innerHTML;\r\n            btnConfirm.disabled = true;\r\n            btnConfirm.classList.add('opacity-70','cursor-wait','pointer-events-none');\r\n            btnConfirm.innerHTML = '<svg class=\"animate-spin -ml-1 mr-2 h-4 w-4 inline\" viewBox=\"0 0 24 24\"><circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle><path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z\"></path></svg>' + escapeHtml(confirmText || 'Please wait\u2026');\r\n            const ok = await onConfirm();\r\n            btnConfirm.innerHTML = originalHtml;\r\n            btnConfirm.classList.remove('opacity-70','cursor-wait','pointer-events-none');\r\n            btnConfirm.disabled = false;\r\n            cleanup(!!ok);\r\n            return;\r\n          } catch(err){\r\n            console.error('Confirm onConfirm error:', err);\r\n            notify((err && err.message) ? String(err.message) : 'Action failed', 'error');\r\n            cleanup(false);\r\n            return;\r\n          }\r\n        }\r\n        cleanup(true);\r\n      });\r\n      // Focus management scoped to host\r\n      try { if (btnConfirm) btnConfirm.focus(); } catch(_){ }\r\n      setupFocusTrap(host);\r\n    });\r\n  }\r\n\r\n  // ------------------ Profile Dialog (Expanded Card as Modal) ------------------\r\n  function openProfileOverlay(u, cardEl){\r\n    const portal = qs('#admin-add-portal');\r\n    if (!portal) { notify('Portal not found', 'error'); return Promise.resolve(); }\r\n    // Add animated left-border highlight to the originating card\r\n    try { cardEl.classList.add('transition-all','duration-500','border-l-4','border-indigo-500'); } catch(_){ }\r\n    portal.classList.remove('pointer-events-none');\r\n    // Skeleton + Details view (non-edit)\r\n    const skeleton = `\r\n      <div class=\"fixed inset-0 z-40 bg-black/40 opacity-0 transition-opacity duration-200\" data-overlay></div>\r\n      <div class=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n        <div class=\"w-[90vw] sm:w-full max-w-xl transform scale-95 opacity-0 transition-all duration-200\">\r\n          <div class=\"bg-card text-card-foreground border-border bg-white dark:bg-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl overflow-hidden\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Loading profile\">\r\n            <div class=\"px-6 py-4 border-b border-gray-100 dark:border-gray-700\">\r\n              <div class=\"h-6 w-40 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\r\n            </div>\r\n            <div class=\"px-6 py-8 space-y-6\">\r\n              <div class=\"grid sm:grid-cols-2 gap-6\">\r\n                <div class=\"h-4 w-64 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\r\n                <div class=\"h-4 w-56 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\r\n                <div class=\"h-4 w-40 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\r\n                <div class=\"h-4 w-44 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\r\n              </div>\r\n              <div class=\"pt-6 flex items-center gap-3 justify-center\">\r\n                <div class=\"h-9 w-24 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\r\n                <div class=\"h-9 w-20 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\r\n                <div class=\"h-9 w-20 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n    const content = `\r\n      <div class=\"fixed inset-0 z-40 bg-black/40 opacity-0 transition-opacity duration-200\" data-overlay></div>\r\n      <div class=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n        <div class=\"w-[90vw] sm:w-full max-w-xl transform scale-95 opacity-0 transition-all duration-200\">\r\n          <div class=\"bg-card text-card-foreground border-border bg-white dark:bg-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl overflow-hidden\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Admin profile\">\r\n            <div class=\"px-6 py-2 relative border-b border-gray-100 dark:border-gray-700\">\r\n              <div class=\"grid grid-cols-3 items-center\">\r\n                <div class=\"justify-self-start text-2xl font-extrabold\">${escapeHtml(u.full_name || u.username)}</div>\r\n                <div class=\"justify-self-center\">\r\n                  <span class=\"inline-flex items-center text-sm px-3 py-1.5 rounded-full ${u.status==='online'?'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300':'bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300'}\">${escapeHtml(u.role||'Admin')} \u2022 ${u.status==='online'?'Online':'Offline'}</span>\r\n                </div>\r\n                <div class=\"justify-self-end flex items-center gap-2 relative\">\r\n                  <button type=\"button\" class=\"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800\" aria-haspopup=\"menu\" aria-expanded=\"false\" aria-label=\"Options\" data-menu-trigger>\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-5 h-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path d=\"M6 10a2 2 0 11-4 0 2 2 0 014 0zm6 0a2 2 0 11-4 0 2 2 0 014 0zm6 0a2 2 0 11-4 0 2 2 0 014 0z\"/></svg>\r\n                  </button>\r\n                  <div class=\"absolute right-0 top-10 w-40 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg py-1 hidden\" data-menu>\r\n                    <button class=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700\" data-mode=\"edit\">${svgIcon('edit')}<span>Edit</span></button>\r\n                    <button class=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700\" data-act=\"pause\">${svgIcon('pause')}<span>Pause</span></button>\r\n                    <button class=\"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30\" data-act=\"delete\">${svgIcon('trash')}<span>Delete</span></button>\r\n                  </div>\r\n                  <button type=\"button\" class=\"p-1.5 rounded-full text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 text-3xl leading-none\" title=\"Close\" aria-label=\"Close\" data-close>&times;</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"px-6 py-8 space-y-8\" data-view>\r\n              ${u.updated_at ? `<div class=\\\"text-xs text-gray-500 dark:text-gray-400\\\">Last updated: ${timeSince(new Date(u.updated_at))} ago</div>` : ''}\r\n              <div class=\"space-y-6\">\r\n                <div class=\"space-y-3\">\r\n                  <h4 class=\"text-sm font-semibold text-gray-600 dark:text-gray-300\">Personal Info</h4>\r\n                  <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    <div class=\"flex items-baseline gap-2\"><span class=\"text-sm text-gray-500 dark:text-gray-400\">ID:</span><span class=\"text-base font-medium\">${escapeHtml(u.id)}</span></div>\r\n                    <div class=\"flex items-baseline gap-2\"><span class=\"text-sm text-gray-500 dark:text-gray-400\">Username:</span><span class=\"text-base font-medium break-all\">${escapeHtml(u.user_name||'\u2014')}</span></div>\r\n                    <div class=\"flex items-baseline gap-2\"><span class=\"text-sm text-gray-500 dark:text-gray-400\">Email:</span><span class=\"text-base font-medium break-all\">${escapeHtml(u.email||'\u2014')}</span></div>\r\n                    <div class=\"flex items-baseline gap-2\"><span class=\"text-sm text-gray-500 dark:text-gray-400\">Phone:</span><span class=\"text-base font-medium\">${escapeHtml(u.phone||'\u2014')}</span></div>\r\n                    <div class=\"flex items-baseline gap-2\"><span class=\"text-sm text-gray-500 dark:text-gray-400\">City:</span><span class=\"text-base font-medium\">${escapeHtml(u.city||'\u2014')}</span></div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"space-y-3\">\r\n                  <h4 class=\"text-sm font-semibold text-gray-600 dark:text-gray-300\">Account Details</h4>\r\n                  <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    <div class=\"flex items-baseline gap-2\"><span class=\"text-sm text-gray-500 dark:text-gray-400\">Created:</span><span class=\"text-base font-medium\">${u.date_joined ? timeSince(new Date(u.date_joined)) + ' ago' : '\u2014'}</span></div>\r\n                    <div class=\"flex items-baseline gap-2\"><span class=\"text-sm text-gray-500 dark:text-gray-400\">Updated:</span><span class=\"text-base font-medium\">${u.updated_at ? timeSince(new Date(u.updated_at)) + ' ago' : '\u2014'}</span></div>\r\n                    <div class=\"flex items-baseline gap-2\"><span class=\"text-sm text-gray-500 dark:text-gray-400\">Password:</span><span class=\"text-base font-medium tracking-widest\">********</span></div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\" data-extra-fields></div>\r\n              </div>\r\n              <div class=\"pt-6 flex flex-wrap items-center justify-center gap-3\" data-actions>\r\n                <button class=\"px-4 py-2 text-base rounded-lg bg-blue-600 text-white hover:bg-blue-700 focus:ring-2 ring-offset-2 ring-blue-500 flex items-center gap-2\" data-act=\"message\" aria-label=\"Message\">${svgIcon('chat')}<span>Message</span><span class=\"hidden md:inline\"> (${escapeHtml(u.user_name||u.username||'')})</span></button>\r\n                <button class=\"px-4 py-2 text-base rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600\" type=\"button\" data-act=\"recover\" aria-label=\"Recover Password\">Recover Password</button>\r\n              </div>\r\n            </div>\r\n            <form class=\"px-6 py-8 space-y-8 hidden\" data-edit-form>\r\n              <div class=\"space-y-6\">\r\n                <div class=\"space-y-3\">\r\n                  <h4 class=\"text-sm font-semibold text-gray-600 dark:text-gray-300\">Personal Info</h4>\r\n                  <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    <label class=\"block w-full text-base\"><span class=\"block mb-1 text-sm text-gray-700 dark:text-gray-300\">Name</span>\r\n                      <input name=\"username\" type=\"text\" value=\"${escapeHtml(u.full_name || u.username || '')}\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" />\r\n                    </label>\r\n                    <label class=\"block w-full text-base\"><span class=\"block mb-1 text-sm text-gray-700 dark:text-gray-300\">City</span>\r\n                      <input name=\"city\" type=\"text\" value=\"${escapeHtml(u.city||'')}\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" />\r\n                    </label>\r\n                    <label class=\"block w-full text-base\"><span class=\"block mb-1 text-sm text-gray-700 dark:text-gray-300\">Phone</span>\r\n                      <input name=\"phone\" type=\"tel\" value=\"${escapeHtml(u.phone||'')}\" pattern=\"\\\\d{10}\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" />\r\n                    </label>\r\n                    <label class=\"block w-full text-base md:col-span-2\"><span class=\"block mb-1 text-sm text-gray-700 dark:text-gray-300\">Role</span>\r\n                      <select name=\"role\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\">\r\n                        <option value=\"admin\" ${String(u.role||'').toLowerCase()==='admin'?'selected':''}>Admin</option>\r\n                        <option value=\"user\" ${String(u.role||'').toLowerCase()==='user'?'selected':''}>User</option>\r\n                        <option value=\"super\" ${String(u.role||'').toLowerCase()==='super'?'selected':''}>Super</option>\r\n                      </select>\r\n                    </label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"pt-2 grid grid-cols-2 gap-3\">\r\n                <button type=\"submit\" class=\"px-4 py-2 text-base rounded-lg bg-blue-600 text-white shadow hover:bg-blue-700 focus:ring-2 ring-offset-2 ring-blue-500\">Save</button>\r\n                <button type=\"button\" class=\"px-4 py-2 text-base rounded-lg bg-gray-200 dark:bg-gray-800 dark:text-gray-100\" data-cancel>Cancel</button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n    // Render skeleton, then swap to content shortly for perception\r\n    portal.innerHTML = skeleton;\r\n    // Animate in\r\n    requestAnimationFrame(function(){\r\n      const ov = qs('[data-overlay]', portal);\r\n      const box = qs('.transform', portal);\r\n      if (ov) ov.classList.add('opacity-100');\r\n      if (box){ box.classList.remove('scale-95','opacity-0'); box.classList.add('scale-100','opacity-100'); }\r\n    });\r\n    // Swap skeleton -> content after a short delay for visible skeleton\r\n    setTimeout(function(){\r\n      portal.innerHTML = content;\r\n      requestAnimationFrame(function(){\r\n        const ov2 = qs('[data-overlay]', portal);\r\n        const box2 = qs('.transform', portal);\r\n        if (ov2) ov2.classList.add('opacity-100');\r\n        if (box2){ box2.classList.remove('scale-95','opacity-0'); box2.classList.add('scale-100','opacity-100'); }\r\n      });\r\n      // Populate any additional fields coming from backend safely\r\n      try { populateExtraFields(u, portal); } catch(_){ }\r\n      bindProfileOverlayHandlers();\r\n    }, 120);\r\n    function bindProfileOverlayHandlers(){\r\n      // Close handlers\r\n      function close(){\r\n        const ov = qs('[data-overlay]', portal);\r\n        const box = qs('.transform', portal);\r\n        if (ov) ov.classList.remove('opacity-100');\r\n        if (box){ box.classList.remove('scale-100','opacity-100'); box.classList.add('scale-95','opacity-0'); }\r\n        // Animate left border reverse on originating card (fade color then remove width)\r\n        try {\r\n          if (cardEl.classList.contains('border-indigo-500')){\r\n            cardEl.classList.remove('border-indigo-500');\r\n            cardEl.classList.add('border-indigo-500/0');\r\n          }\r\n        } catch(_) { }\r\n        setTimeout(function(){\r\n          portal.innerHTML='';\r\n          portal.classList.add('pointer-events-none');\r\n          document.removeEventListener('keydown', onEsc);\r\n          teardownFocusTrap(portal);\r\n          try { cardEl.classList.remove('border-l-4','border-indigo-500/0','transition-all','duration-500'); } catch(_){ }\r\n        }, 200);\r\n      }\r\n      function onEsc(e){ if (e.key === 'Escape') close(); }\r\n      document.addEventListener('keydown', onEsc);\r\n      const overlay = qs('[data-overlay]', portal);\r\n      if (overlay) overlay.addEventListener('click', close);\r\n      const closeBtn = qs('[data-close]', portal);\r\n      if (closeBtn) closeBtn.addEventListener('click', close);\r\n      // Options menu (three-dots): dropdown with outside-click close\r\n      const trig = qs('[data-menu-trigger]', portal);\r\n      const menu = qs('[data-menu]', portal);\r\n      let menuOpen = false;\r\n      function closeMenu(){\r\n        if (!menu || !trig) return; menu.classList.add('hidden'); trig.setAttribute('aria-expanded','false'); menuOpen = false;\r\n      }\r\n      function toggleMenu(e){\r\n        if (!menu || !trig) return; e && e.preventDefault();\r\n        const willOpen = menu.classList.contains('hidden');\r\n        if (willOpen){ menu.classList.remove('hidden'); trig.setAttribute('aria-expanded','true'); menuOpen = true; }\r\n        else { closeMenu(); }\r\n      }\r\n      if (trig && menu){\r\n        trig.addEventListener('click', toggleMenu);\r\n        // Close on outside click\r\n        document.addEventListener('click', function onDoc(ev){\r\n          if (!menuOpen) return; const t = ev.target; if (trig.contains(t) || menu.contains(t)) return; closeMenu();\r\n        });\r\n        // Close on Escape (already handled by modal close, but keep for menu-only use)\r\n        document.addEventListener('keydown', function onKey(ev){ if (ev.key === 'Escape'){ closeMenu(); } });\r\n      }\r\n      // Actions inside dialog\r\n      const view = qs('[data-view]', portal);\r\n      const editForm = qs('[data-edit-form]', portal);\r\n      portal.addEventListener('click', function(e){\r\n        const b = e.target && e.target.closest('[data-act], [data-mode]');\r\n        // Handle Cancel from edit mode\r\n        const cancelBtn = e.target && e.target.closest('[data-cancel]');\r\n        if (cancelBtn){\r\n          if (view && editForm){ editForm.classList.add('hidden'); view.classList.remove('hidden'); }\r\n          try { setEditActive(false); } catch(_){ }\r\n          e.preventDefault();\r\n          return;\r\n        }\r\n        if (!b) return;\r\n        e.preventDefault();\r\n        const act = b.getAttribute('data-act');\r\n        const mode = b.getAttribute('data-mode');\r\n        // Close kebab menu if open\r\n        try { const m = qs('[data-menu]', portal); if (m) m.classList.add('hidden'); const t = qs('[data-menu-trigger]', portal); if (t) t.setAttribute('aria-expanded','false'); } catch(_){ }\r\n        // Block clicks on disabled actions during edit\r\n        const isEditing = !!(editForm && !editForm.classList.contains('hidden'));\r\n        if (isEditing && b.hasAttribute('data-disabled-when-edit')) { return; }\r\n        if (act === 'message'){ close(); openMessageOverlay(u).catch(()=>{}); return; }\r\n        if (act === 'delete'){ openConfirmDialog({\r\n            title: 'Delete Admin',\r\n            message: 'This will permanently delete the admin from the database and cannot be undone. Are you sure?',\r\n            confirmText: 'Delete',\r\n            confirmClass: 'bg-red-600 hover:bg-red-700',\r\n            onConfirm: async function(){\r\n              try {\r\n                const okDel = await deleteAdmin(u.id, (u.full_name||u.username||u.user_name||'').toString());\r\n                if (okDel) { close(); }\r\n                return okDel;\r\n              } catch(err){ console.error('Delete error:', err); notify('Delete failed', 'error'); return false; }\r\n            }\r\n          }); return; }\r\n        if (act === 'pause'){ close(); pauseAdmin(u.id).catch(()=>{}); return; }\r\n        if (act === 'recover'){ openRecoverPasswordDialog(u); return; }\r\n        if (mode === 'edit'){\r\n          if (view && editForm){ view.classList.add('hidden'); editForm.classList.remove('hidden'); try { setEditActive(true); } catch(_){ } const first = editForm.querySelector('input,select,textarea'); try { first && first.focus(); } catch(_){ } }\r\n        }\r\n      });\r\n      if (editForm){\r\n        editForm.addEventListener('submit', async function(e){\r\n          e.preventDefault();\r\n          const fd = new FormData(editForm);\r\n          fd.append('_method', 'PUT');\r\n          const phone = (fd.get('phone')||'').toString().trim();\r\n          if (phone && !/^\\d{10}$/.test(phone)) { notify('Phone must be exactly 10 digits', 'error'); return; }\r\n          const doFetch = () => fetch(`/dashboard/api/admins/${u.id}/`, { method: 'POST', headers: { 'X-CSRFToken': csrf(), 'X-Requested-With': 'XMLHttpRequest' }, credentials: 'same-origin', body: fd });\r\n          const res = await (window.withLoading ? window.withLoading(doFetch()) : doFetch());\r\n          let data = null;\r\n          try { data = await res.json(); }\r\n          catch(_) { if (!res.ok) { notify(`Update failed (HTTP ${res.status})`, 'error'); return; } }\r\n          if (res.ok && data && data.success){ notify('Admin updated', 'success'); try { if (typeof window.bumpNotificationsNow==='function') window.bumpNotificationsNow(); } catch(_){ } close(); await refresh(); }\r\n          else { notify((data && data.error) || `Update failed${!res.ok?` (HTTP ${res.status})`:''}`, 'error'); }\r\n        });\r\n      }\r\n      // Focus trap\r\n      setupFocusTrap(portal);\r\n    }\r\n    return Promise.resolve();\r\n  }\r\n\r\n  // Toggle disabled/enabled state for actions while editing\r\n  function setEditActive(active){\r\n    try {\r\n      const portal = qs('#admin-add-portal');\r\n      if (!portal) return;\r\n      const nodes = portal.querySelectorAll('[data-disabled-when-edit]');\r\n      nodes.forEach(function(el){\r\n        if (active){\r\n          el.setAttribute('aria-disabled','true');\r\n          el.setAttribute('disabled','disabled');\r\n          el.classList.add('opacity-50','pointer-events-none','cursor-not-allowed');\r\n        } else {\r\n          el.removeAttribute('aria-disabled');\r\n          el.removeAttribute('disabled');\r\n          el.classList.remove('opacity-50','pointer-events-none','cursor-not-allowed');\r\n        }\r\n      });\r\n    } catch(_){ }\r\n  }\r\n\r\n  // Append any extra fields from the backend object `u` that are not explicitly rendered\r\n  function populateExtraFields(u, portal){\r\n    const wrap = qs('[data-extra-fields]', portal);\r\n    if (!wrap || !u || typeof u !== 'object') return;\r\n    const known = new Set(['id','user_name','username','full_name','email','phone','city','role','status','is_active','date_joined','created_at','updated_at','message_preview','tickets_solved','last_login','created_by','role_approved_by']);\r\n    const entries = Object.keys(u).filter(function(k){ return !known.has(k); }).sort();\r\n    if (!entries.length) return;\r\n    const frag = document.createDocumentFragment();\r\n    entries.forEach(function(k){\r\n      const val = u[k];\r\n      if (val === null || typeof val === 'undefined' || (typeof val === 'string' && val.trim() === '')) return;\r\n      const pretty = formatFieldValue(k, val);\r\n      const row = document.createElement('div');\r\n      row.className = 'flex items-center gap-2';\r\n      const label = document.createElement('span'); label.className = 'text-gray-500 dark:text-gray-400'; label.textContent = (k.replace(/_/g,' ').replace(/\\b\\w/g, c=>c.toUpperCase())) + ':';\r\n      const value = document.createElement('span'); value.className = 'font-medium break-all'; value.textContent = pretty;\r\n      row.appendChild(label); row.appendChild(value);\r\n      frag.appendChild(row);\r\n    });\r\n    wrap.appendChild(frag);\r\n  }\r\n\r\n  function formatFieldValue(key, val){\r\n    try {\r\n      if (typeof val === 'boolean') return val ? 'Yes' : 'No';\r\n      if (typeof val === 'number') return String(val);\r\n      if (val && typeof val === 'object'){\r\n        if (Array.isArray(val)) return val.join(', ');\r\n        // Object -> JSON short\r\n        const s = JSON.stringify(val);\r\n        return s.length > 120 ? s.slice(0,117) + '...' : s;\r\n      }\r\n      const s = String(val);\r\n      // ISO date detection\r\n      if (/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}/.test(s)){\r\n        try { return timeSince(new Date(s)) + ' ago'; } catch { return s; }\r\n      }\r\n      return s;\r\n    } catch { return String(val); }\r\n  }\r\n  async function fetchJson(url){\r\n    const res = await fetch(url, { headers: { 'X-Requested-With': 'XMLHttpRequest' } });\r\n    if (!res.ok) throw new Error('Request failed');\r\n    return res.json();\r\n  }\r\n\r\n  function renderSummary(results){\r\n    try {\r\n      const wrap = qs('#admin-summary');\r\n      if (!wrap) return;\r\n      const list = Array.isArray(results) ? results : [];\r\n      const total = list.length;\r\n      const online = list.filter(function(u){ return String(u.status||'').toLowerCase()==='online'; }).length;\r\n      const active = list.filter(function(u){ return !!u.is_active; }).length;\r\n      const paused = total - active;\r\n      // Build chips matching overview badge style\r\n      const frag = document.createDocumentFragment();\r\n      function chip(label, cls){\r\n        const span = document.createElement('span');\r\n        span.className = 'inline-flex items-center gap-1 text-xs font-medium px-2.5 py-1 rounded-full ' + cls;\r\n        span.textContent = label;\r\n        return span;\r\n      }\r\n      frag.appendChild(chip(`Total: ${total}`, 'bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300'));\r\n      frag.appendChild(chip(`Online: ${online}`, 'bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300'));\r\n      frag.appendChild(chip(`Active: ${active}`, 'bg-emerald-50 text-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-300'));\r\n      frag.appendChild(chip(`Paused: ${paused}`, 'bg-yellow-50 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300'));\r\n      wrap.innerHTML = '';\r\n      wrap.appendChild(frag);\r\n    } catch(_) { /* ignore */ }\r\n  }\r\n\r\n  function renderCards(results){\r\n    const grid = qs('#admin-card-grid');\r\n    const count = qs('#admin-count');\r\n    if (!grid) return;\r\n    // Use DocumentFragment to minimize reflows\r\n    const frag = document.createDocumentFragment();\r\n    // Add New Admin Card (+)\r\n    frag.appendChild(buildAddCard());\r\n    // Group: Active then Disabled (purely visual)\r\n    const list = Array.isArray(results) ? results : [];\r\n    const actives = list.filter(function(u){ return !!u.is_active; });\r\n    const disabled = list.filter(function(u){ return !u.is_active; });\r\n    if (actives.length){ frag.appendChild(buildSectionHeader('Active')); }\r\n    actives.forEach(function(u){ frag.appendChild(buildProfileCard(u)); });\r\n    if (disabled.length){ frag.appendChild(buildSectionHeader('Disabled')); }\r\n    disabled.forEach(function(u){ frag.appendChild(buildProfileCard(u)); });\r\n    grid.innerHTML = '';\r\n    grid.appendChild(frag);\r\n    if (count) count.textContent = `${(results||[]).length} admin(s)`;\r\n    // Summary chips just above grid\r\n    renderSummary(results);\r\n    renderLoadMore(grid);\r\n    startAllTimers();\r\n  }\r\n\r\n  function buildSectionHeader(title){\r\n    const h = document.createElement('div');\r\n    h.setAttribute('data-role','section-header');\r\n    h.className = 'col-span-full flex items-center gap-2 text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400 border-b border-gray-200 dark:border-gray-700 mt-2 mb-1';\r\n    h.innerHTML = `\r\n      <svg class=\"w-3 h-3\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\">\r\n        <path d=\"M7 5l5 5-5 5\" />\r\n      </svg>\r\n      <span>${escapeHtml(String(title || ''))}</span>\r\n    `;\r\n    return h;\r\n  }\r\n\r\n  function renderLoadMore(grid){\r\n    try {\r\n      // Remove existing load more if any\r\n      const prev = qs('[data-role=\"load-more-container\"]', grid.parentElement || grid);\r\n      if (prev) prev.remove();\r\n      if (!__nextUrl) return; // Only show if server indicates more pages\r\n      const wrap = document.createElement('div');\r\n      wrap.setAttribute('data-role','load-more-container');\r\n      wrap.className = 'flex justify-center mt-4';\r\n      const btn = document.createElement('button');\r\n      btn.className = 'px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-sm';\r\n      btn.type = 'button';\r\n      btn.textContent = 'Load more';\r\n      btn.addEventListener('click', function(){ loadMore().catch(()=>{}); });\r\n      wrap.appendChild(btn);\r\n      // Insert after grid\r\n      grid.parentElement.appendChild(wrap);\r\n    } catch(_) { }\r\n  }\r\n\r\n  function buildAddCard(){\r\n    const card = document.createElement('div');\r\n    card.className = 'group relative bg-white dark:bg-gray-900 dark:border-gray-700 rounded-xl shadow-sm border hover:shadow-md transition p-4 flex items-center justify-center min-h-[180px]';\r\n    card.innerHTML = `\r\n      <button type=\"button\" class=\"w-full h-full flex flex-col items-center justify-center text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white\" data-act=\"add-open\">\r\n        <svg class=\"w-12 h-12\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 4.5v15m7.5-7.5h-15\"/></svg>\r\n        <span class=\"mt-2 text-sm\">Add New Admin</span>\r\n      </button>\r\n    `;\r\n    const openBtn = card.querySelector('[data-act=\"add-open\"]');\r\n    openBtn.addEventListener('click', function(){ openAddOverlay(); });\r\n    return card;\r\n  }\r\n\r\n  function openAddOverlay(){\r\n    const portal = qs('#admin-add-portal');\r\n    if (!portal) { notify('Portal not found', 'error'); return; }\r\n    portal.classList.remove('pointer-events-none');\r\n    portal.innerHTML = `\r\n      <div class=\"fixed inset-0 bg-black/40 opacity-0 transition-opacity duration-200\" data-overlay></div>\r\n      <div class=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <div class=\"w-full max-w-xl transform scale-95 opacity-0 transition-all duration-200\">\r\n          <div class=\"bg-white dark:bg-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl overflow-hidden\">\r\n            <div class=\"px-5 py-4 flex items-center justify-between border-b border-gray-100 dark:border-gray-700\">\r\n              <h3 class=\"text-lg font-semibold\">Add New Admin</h3>\r\n              <div class=\"flex items-center gap-3\">\r\n                <button type=\"button\" class=\"text-sm px-2 py-1 rounded bg-gray-100 dark:bg-gray-800\" data-toggle-theme>Toggle Theme</button>\r\n                <button type=\"button\" class=\"text-gray-500 hover:text-gray-900 dark:hover:text-white\" title=\"Close\" data-close>&times;</button>\r\n              </div>\r\n            </div>\r\n            <form class=\"px-5 py-4 space-y-4\" data-add-form>\r\n              <div class=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Name</span>\r\n                  <input name=\"username\" type=\"text\" required class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" placeholder=\"Jane Admin\" />\r\n                </label>\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">City</span>\r\n                  <input name=\"city\" type=\"text\" required class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" placeholder=\"Pune\" />\r\n                </label>\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Phone</span>\r\n                  <input name=\"phone\" type=\"tel\" required pattern=\"\\\\d{10}\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" placeholder=\"10 digits\" />\r\n                </label>\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Password</span>\r\n                  <input name=\"password\" type=\"password\" required class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" placeholder=\"Strong password\" />\r\n                </label>\r\n                <label class=\"block text-sm sm:col-span-2\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Role</span>\r\n                  <select name=\"role\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\">\r\n                    <option value=\"admin\">Admin</option>\r\n                    <option value=\"user\">User</option>\r\n                    <option value=\"super\">Super</option>\r\n                  </select>\r\n                </label>\r\n              </div>\r\n              <div class=\"flex items-center gap-3 pt-2\">\r\n                <button type=\"submit\" class=\"px-4 py-2 rounded-lg bg-blue-600 text-white shadow hover:bg-blue-700 focus:ring-2 ring-offset-2 ring-blue-500\">Create</button>\r\n                <button type=\"button\" class=\"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-800 dark:text-gray-100\" data-close>Cancel</button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n    // animate in\r\n    requestAnimationFrame(function(){\r\n      const ov = qs('[data-overlay]', portal);\r\n      const boxWrap = qs('.transform', portal);\r\n      if (ov) ov.classList.add('opacity-100');\r\n      if (boxWrap){ boxWrap.classList.remove('scale-95','opacity-0'); boxWrap.classList.add('scale-100','opacity-100'); }\r\n    });\r\n\r\n    const closeBtns = qsa('[data-close]', portal);\r\n    closeBtns.forEach(function(btn){ btn.addEventListener('click', closeAddOverlay); });\r\n    const overlay = qs('[data-overlay]', portal);\r\n    if (overlay) overlay.addEventListener('click', closeAddOverlay);\r\n    document.addEventListener('keydown', escCloseOnce);\r\n\r\n    const toggle = qs('[data-toggle-theme]', portal);\r\n    if (toggle) toggle.addEventListener('click', function(){\r\n      try {\r\n        const isDark = document.documentElement.classList.contains('dark');\r\n        const newTheme = isDark ? 'light' : 'dark';\r\n        localStorage.setItem('theme', newTheme);\r\n        document.documentElement.classList.toggle('dark', newTheme === 'dark');\r\n      } catch(_){ }\r\n    });\r\n\r\n    const form = qs('[data-add-form]', portal);\r\n    if (form) form.addEventListener('submit', onSubmitAddForm);\r\n    // Focus trap for accessibility\r\n    setupFocusTrap(portal);\r\n  }\r\n\r\n  function escCloseOnce(e){ if (e.key === 'Escape') { closeAddOverlay(); } }\r\n\r\n  function closeAddOverlay(){\r\n    const portal = qs('#admin-add-portal');\r\n    if (!portal) return;\r\n    const ov = qs('[data-overlay]', portal);\r\n    const boxWrap = qs('.transform', portal);\r\n    // animate out\r\n    if (ov) ov.classList.remove('opacity-100');\r\n    if (boxWrap){ boxWrap.classList.remove('scale-100','opacity-100'); boxWrap.classList.add('scale-95','opacity-0'); }\r\n    setTimeout(function(){\r\n      portal.innerHTML = '';\r\n      portal.classList.add('pointer-events-none');\r\n      document.removeEventListener('keydown', escCloseOnce);\r\n      teardownFocusTrap(portal);\r\n    }, 200);\r\n  }\r\n\r\n  async function onSubmitAddForm(e){\r\n    e.preventDefault();\r\n    const form = e.currentTarget;\r\n    const fd = new FormData(form);\r\n    try { fd.append('csrfmiddlewaretoken', csrf()); } catch(_){ }\r\n    const phone = (fd.get('phone')||'').toString().trim();\r\n    if (!/^\\d{10}$/.test(phone)) { notify('Phone must be exactly 10 digits', 'error'); return; }\r\n    const doFetch = () => fetch('/dashboard/api/admins/', {\r\n      method: 'POST',\r\n      headers: {\r\n        'X-CSRFToken': csrf(),\r\n        'X-Requested-With': 'XMLHttpRequest'\r\n      },\r\n      credentials: 'same-origin',\r\n      body: fd\r\n    });\r\n    const res = await (window.withLoading ? window.withLoading(doFetch()) : doFetch());\r\n    let data = null;\r\n    try { data = await res.json(); }\r\n    catch(err){ if (!res.ok) { notify(`Create failed (HTTP ${res.status})`, 'error'); return; } }\r\n    if (res.ok && data && data.success){\r\n      notify('Admin created', 'success');\r\n      try { if (typeof window.bumpNotificationsNow==='function') window.bumpNotificationsNow(); } catch(_){ }\r\n      closeAddOverlay();\r\n      await refresh();\r\n    } else {\r\n      let msg = 'Create failed';\r\n      if (data && data.error) msg = data.error;\r\n      else if (!res.ok) msg = `Create failed (HTTP ${res.status})`;\r\n      notify(msg, 'error');\r\n    }\r\n  }\r\n\r\n  function buildProfileCard(u){\r\n    const statusLabel = u.status === 'online' ? 'Online' : 'Offline';\r\n    const card = document.createElement('div');\r\n    card.className = 'bg-white dark:bg-gray-900 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-xl shadow-sm border hover:shadow-md hover:-translate-y-0.5 focus-within:ring-2 focus-within:ring-indigo-500 transition transition-transform p-4 flex flex-col';\r\n    card.setAttribute('data-id', String(u.id));\r\n    const uname = (u.user_name || u.username || '').toString();\r\n    card.innerHTML = `\r\n      <div class=\"flex items-start justify-between\">\r\n        <div>\r\n          <div class=\"text-xs text-gray-500 dark:text-gray-400\">ID #${u.id}</div>\r\n          <h3 class=\"text-lg font-semibold\">${escapeHtml(u.full_name || u.username)}</h3>\r\n          <div class=\"text-xs text-gray-500 dark:text-gray-400\">${escapeHtml(u.role || 'Admin')}</div>\r\n        </div>\r\n        <div class=\"text-xs sm:text-sm font-medium\">\r\n          <span class=\"inline-flex items-center px-2.5 py-1 rounded-full ${u.status==='online'?'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300':'bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300'}\" title=\"${statusLabel}\">\r\n            ${u.status==='online' ? svgDot('green') : svgDot('red')}\r\n            <span class=\"ml-1 hidden sm:inline\">${statusLabel}</span>\r\n          </span>\r\n          <span class=\"block mt-1 text-center ${u.is_active? 'text-green-700 dark:text-green-400':'text-gray-500 dark:text-gray-400'}\">${u.is_active? 'Active':'Disabled'}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"mt-3 grid grid-cols-1 gap-2 text-sm\">\r\n        <div class=\"flex items-center gap-2\"><span class=\"text-gray-500 dark:text-gray-400\">Phone:</span><span class=\"font-medium\">${escapeHtml(u.phone||'\u2014')}</span></div>\r\n      </div>\r\n      <div class=\"mt-4 flex items-center gap-2\">\r\n        <button class=\"px-3 py-2 sm:px-4 sm:py-2 text-sm sm:text-[0.95rem] rounded-lg bg-blue-600 text-white hover:bg-blue-700 focus:ring-2 ring-offset-2 ring-blue-500 flex items-center gap-2\" data-act=\"message\" title=\"Message\" aria-label=\"Message\">\r\n          ${svgIcon('chat')}<span class=\"hidden xs:inline\">Message</span><span class=\"hidden md:inline\"> (${escapeHtml(uname)})</span>\r\n        </button>\r\n      </div>\r\n    `;\r\n    // Bind actions\r\n    card.addEventListener('click', function(ev){\r\n      const btn = ev.target && ev.target.closest('[data-act]');\r\n      const id = u.id;\r\n      if (btn){\r\n        const act = btn.getAttribute('data-act');\r\n        if (act === 'message') { openMessageOverlay(u).catch(()=>{}); }\r\n        else if (act === 'edit') { openEditOverlay(u).catch(()=>{}); }\r\n        else if (act === 'delete') {\r\n          openConfirmDialog({\r\n            title: 'Delete Admin',\r\n            message: 'This will permanently delete the admin from the database and cannot be undone. Are you sure?',\r\n            confirmText: 'Delete',\r\n            confirmClass: 'bg-red-600 hover:bg-red-700'\r\n          }).then(async function(ok){ if (ok) { try { await deleteAdmin(id, (u.full_name||u.username||u.user_name||'').toString()); } catch(_){ } }});\r\n        }\r\n        else if (act === 'pause') { pauseAdmin(id).catch(()=>{}); }\r\n        else if (act === 'recover') { notify('Recover Password is not available in frontend-only mode.', 'warning'); }\r\n        return;\r\n      }\r\n      // Card background click opens modal-style profile overlay\r\n      openProfileOverlay(u, card).catch(()=>{});\r\n    });\r\n    return card;\r\n  }\r\n\r\n  async function editAdmin(id){ /* legacy no-op preserved for compatibility */ }\r\n\r\n  function openEditOverlay(u){\r\n    const portal = qs('#admin-add-portal');\r\n    if (!portal) { notify('Portal not found', 'error'); return Promise.resolve(); }\r\n    portal.classList.remove('pointer-events-none');\r\n    portal.innerHTML = `\r\n      <div class=\"fixed inset-0 bg-black/40 opacity-0 transition-opacity duration-200\" data-overlay></div>\r\n      <div class=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <div class=\"w-full max-w-xl transform scale-95 opacity-0 transition-all duration-200\">\r\n          <div class=\"bg-white dark:bg-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl overflow-hidden\">\r\n            <div class=\"px-5 py-4 flex items-center justify-between border-b border-gray-100 dark:border-gray-700\">\r\n              <h3 class=\"text-lg font-semibold\">Edit Admin #${u.id}</h3>\r\n              <button type=\"button\" class=\"text-gray-500 hover:text-gray-900 dark:hover:text-white\" title=\"Close\" data-close>&times;</button>\r\n            </div>\r\n            <form class=\"px-5 py-4 space-y-4\" data-edit-form>\r\n              <div class=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Name</span>\r\n                  <input name=\"username\" type=\"text\" value=\"${escapeHtml(u.full_name || u.username || '')}\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" />\r\n                </label>\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">City</span>\r\n                  <input name=\"city\" type=\"text\" value=\"\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" placeholder=\"Leave blank to keep\" />\r\n                </label>\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Phone</span>\r\n                  <input name=\"phone\" type=\"tel\" value=\"${escapeHtml(u.phone||'')}\" pattern=\"\\\\d{10}\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" />\r\n                </label>\r\n                <label class=\"block text-sm\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">New Password</span>\r\n                  <input name=\"password\" type=\"password\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\" placeholder=\"Leave blank to keep\" />\r\n                </label>\r\n                <label class=\"block text-sm sm:col-span-2\">\r\n                  <span class=\"block mb-1 text-gray-700 dark:text-gray-300\">Role</span>\r\n                  <select name=\"role\" class=\"w-full border rounded-lg px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700\">\r\n                    <option value=\"admin\" ${String(u.role||'').toLowerCase()==='admin'?'selected':''}>Admin</option>\r\n                    <option value=\"user\" ${String(u.role||'').toLowerCase()==='user'?'selected':''}>User</option>\r\n                    <option value=\"super\" ${String(u.role||'').toLowerCase()==='super'?'selected':''}>Super</option>\r\n                  </select>\r\n                </label>\r\n              </div>\r\n              <div class=\"flex items-center gap-3 pt-2\">\r\n                <button type=\"submit\" class=\"px-4 py-2 rounded-lg bg-blue-600 text-white shadow hover:bg-blue-700 focus:ring-2 ring-offset-2 ring-blue-500\">Save</button>\r\n                <button type=\"button\" class=\"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-800 dark:text-gray-100\" data-close>Cancel</button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n    requestAnimationFrame(function(){\r\n      const ov = qs('[data-overlay]', portal);\r\n      const boxWrap = qs('.transform', portal);\r\n      if (ov) ov.classList.add('opacity-100');\r\n      if (boxWrap){ boxWrap.classList.remove('scale-95','opacity-0'); boxWrap.classList.add('scale-100','opacity-100'); }\r\n    });\r\n    qsa('[data-close]', portal).forEach(function(b){ b.addEventListener('click', closeAddOverlay); });\r\n    const form = qs('[data-edit-form]', portal);\r\n    if (form){\r\n      form.addEventListener('submit', async function(e){\r\n        e.preventDefault();\r\n        const fd = new FormData(form);\r\n        try { fd.append('csrfmiddlewaretoken', csrf()); } catch(_){ }\r\n        fd.append('_method', 'PUT');\r\n        const phone = (fd.get('phone')||'').toString().trim();\r\n        if (phone && !/^\\d{10}$/.test(phone)) { notify('Phone must be exactly 10 digits', 'error'); return; }\r\n        const doFetch = () => fetch(`/dashboard/api/admins/${u.id}/`, { \r\n          method: 'POST', \r\n          headers: { \r\n            'X-CSRFToken': csrf(), \r\n            'X-Requested-With': 'XMLHttpRequest' \r\n          }, \r\n          credentials: 'same-origin', \r\n          body: fd \r\n        });\r\n        const res = await (window.withLoading ? window.withLoading(doFetch()) : doFetch());\r\n        let data = null;\r\n        try { data = await res.json(); } \r\n        catch(_) { \r\n          if (!res.ok) { \r\n            notify(`Update failed (HTTP ${res.status})`, 'error'); \r\n            return; \r\n          } \r\n        }\r\n        if (res.ok && data && data.success){\r\n          notify('Admin updated', 'success');\r\n          closeAddOverlay();\r\n          await refresh();\r\n        } else {\r\n          notify((data && data.error) || `Update failed${!res.ok?` (HTTP ${res.status})`:''}`, 'error');\r\n        }\r\n      });\r\n    }\r\n    // Focus trap for accessibility\r\n    setupFocusTrap(portal);\r\n    return Promise.resolve();\r\n  }\r\n\r\n  async function deleteAdmin(id, name){\r\n    const fd = new FormData();\r\n    try { fd.append('csrfmiddlewaretoken', csrf()); } catch(_){ }\r\n    fd.append('_method', 'DELETE');\r\n    const doFetch = () => fetch(`/dashboard/api/admins/${id}/`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'X-CSRFToken': csrf(),\r\n        'X-Requested-With': 'XMLHttpRequest'\r\n      },\r\n      credentials: 'same-origin',\r\n      body: fd,\r\n    });\r\n    let res = await (window.withLoading ? window.withLoading(doFetch()) : doFetch());\r\n    let data = null;\r\n    try { data = await res.json(); }\r\n    catch(_) { \r\n      if (!res.ok) { \r\n        notify(`Delete failed (HTTP ${res.status})`, 'error'); \r\n        return false; \r\n      } \r\n    }\r\n\r\n    // Fallback: try actual HTTP DELETE if POST override wasn't accepted\r\n    if (!(res.ok && data && data.success)){\r\n      try {\r\n        res = await fetch(`/dashboard/api/admins/${id}/`, { \r\n          method: 'DELETE', \r\n          headers: { \r\n            'X-CSRFToken': csrf() \r\n          }, \r\n          credentials: 'same-origin' \r\n        });\r\n        try { data = await res.json(); } \r\n        catch(_) { \r\n          if (!res.ok) { \r\n            notify(`Delete failed (HTTP ${res.status})`, 'error'); \r\n            return false; \r\n          } \r\n        }\r\n      } catch(_){ \r\n        notify('Delete failed', 'error'); \r\n        return false; \r\n      }\r\n    }\r\n\r\n    if (res.ok && data && data.success){\r\n      const who = (name || '').toString().trim();\r\n      notify(`Admin/user ${who || id} Deleted Successfully`, 'success');\r\n      try { if (typeof window.bumpNotificationsNow==='function') window.bumpNotificationsNow(); } catch(_){ }\r\n      // Optimistically remove from UI immediately\r\n      try { removeAdminFromUI(id); } catch(_){ }\r\n      await refresh();\r\n      return true;\r\n    } else {\r\n      let msg = 'Delete failed';\r\n      if (data && data.error) msg = data.error;\r\n      else if (!res.ok) msg = `Delete failed (HTTP ${res.status})`;\r\n      notify(msg, 'error');\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async function pauseAdmin(id){\r\n    if (!await openConfirmDialog({\r\n      title: 'Pause Admin',\r\n      message: 'Are you sure you want to pause this admin?',\r\n      confirmText: 'Pause',\r\n      confirmClass: 'bg-yellow-600 hover:bg-yellow-700'\r\n    })) return;\r\n    const fd = new FormData();\r\n    try { fd.append('csrfmiddlewaretoken', csrf()); } catch(_){ }\r\n    fd.append('_method', 'PUT');\r\n    fd.append('action', 'pause');\r\n    const doFetch = () => fetch(`/dashboard/api/admins/${id}/`, { \r\n      method: 'POST', \r\n      headers: { \r\n        'X-CSRFToken': csrf(), \r\n        'X-Requested-With': 'XMLHttpRequest' \r\n      }, \r\n      credentials: 'same-origin', \r\n      body: fd \r\n    });\r\n    const res = await (window.withLoading ? window.withLoading(doFetch()) : doFetch());\r\n    let data = null;\r\n    try { data = await res.json(); } \r\n    catch(_) { \r\n      if (!res.ok) { \r\n        notify(`Pause failed (HTTP ${res.status})`, 'error'); \r\n        return; \r\n      } \r\n    }\r\n    if (res.ok && data && data.success){\r\n      notify('Admin paused', 'success');\r\n      try { if (typeof window.bumpNotificationsNow==='function') window.bumpNotificationsNow(); } catch(_){ }\r\n      await refresh();\r\n    } else {\r\n      notify((data && data.error) || `Pause failed${!res.ok?` (HTTP ${res.status})`:''}`, 'error');\r\n    }\r\n  }\r\n\r\n  async function refresh(){\r\n    const grid = qs('#admin-card-grid');\r\n    if (grid) showSkeletons(grid, 8);\r\n    const q = (qs('#admin-search') && qs('#admin-search').value.trim()) || '';\r\n    __adminsCache = [];\r\n    __nextUrl = null;\r\n    const data = await fetchAdmins(q);\r\n    // DRF-style pagination detection\r\n    if (data && (Array.isArray(data.results) || typeof data.results === 'object')){\r\n      __adminsCache = (data.results || []).slice();\r\n      __nextUrl = data.next || null;\r\n      renderCards(__adminsCache);\r\n    } else if (data && data.success){\r\n      __adminsCache = (data.results || []).slice();\r\n      __nextUrl = null;\r\n      renderCards(__adminsCache);\r\n    } else {\r\n      // Unknown shape; try to read as array directly\r\n      const arr = Array.isArray(data) ? data : [];\r\n      __adminsCache = arr.slice();\r\n      __nextUrl = null;\r\n      renderCards(__adminsCache);\r\n    }\r\n  }\r\n\r\n  async function loadMore(){\r\n    if (!__nextUrl) return;\r\n    try {\r\n      const grid = qs('#admin-card-grid');\r\n      if (grid) showSkeletons(grid, 4);\r\n      const data = await fetchJson(__nextUrl);\r\n      const pageResults = (data && data.results) ? data.results : [];\r\n      __nextUrl = (data && data.next) ? data.next : null;\r\n      // Append new items to cache and DOM without full re-render\r\n      __adminsCache = __adminsCache.concat(pageResults);\r\n      // Append cards\r\n      const frag = document.createDocumentFragment();\r\n      (pageResults||[]).forEach(function(u){ frag.appendChild(buildProfileCard(u)); });\r\n      if (grid){\r\n        // Remove skeletons (grid inner replaced earlier, so append directly)\r\n        grid.appendChild(frag);\r\n        renderLoadMore(grid);\r\n      }\r\n    } catch(_){ notify('Failed to load more', 'error'); }\r\n  }\r\n\r\n  // Live timers\r\n  let timerHandle = null;\r\n  function startAllTimers(){\r\n    if (timerHandle) { clearInterval(timerHandle); timerHandle = null; }\r\n    timerHandle = setInterval(function(){\r\n      qsa('[data-last-login]').forEach(function(el){\r\n        const v = el.getAttribute('data-last-login');\r\n        if (!v) { el.textContent = '\u2014'; return; }\r\n        const d = new Date(v);\r\n        if (isNaN(d.getTime())) { el.textContent = '\u2014'; return; }\r\n        el.textContent = timeSince(d);\r\n      });\r\n    }, 1000);\r\n  }\r\n  function timeSince(date){\r\n    const now = new Date();\r\n    const s = Math.max(0, Math.floor((now - date)/1000));\r\n    const h = Math.floor(s/3600);\r\n    const m = Math.floor((s%3600)/60);\r\n    const sec = s%60;\r\n    const parts = [];\r\n    if (h) parts.push(h+'h');\r\n    if (h || m) parts.push(m+'m');\r\n    parts.push(sec+'s');\r\n    return parts.join(' ');\r\n  }\r\n\r\n  function bind(){\r\n    const root = qs('#admin-mgmt-root');\r\n    if (!root || root.getAttribute('data-initialized')==='1') return;\r\n    const refreshBtn = qs('#admin-refresh');\r\n    if (refreshBtn) refreshBtn.addEventListener('click', function(){ refresh().catch(()=>{}); });\r\n    const search = qs('#admin-search');\r\n    if (search) search.addEventListener('input', debounce(function(){ refresh().catch(()=>{}); }, 250));\r\n    root.setAttribute('data-initialized','1');\r\n    refresh().catch(function(){ notify('Failed to load admins', 'error'); });\r\n\r\n    // Polling for status updates every 60s\r\n    if (!root._poller){\r\n      root._poller = setInterval(function(){ refresh().catch(()=>{}); }, 60000);\r\n    }\r\n\r\n    // Real-time updates via WebSocket (falls back to 60s polling)\r\n    try {\r\n      if (!root._ws_init){\r\n        root._ws_init = true;\r\n        const proto = (location.protocol === 'https:') ? 'wss' : 'ws';\r\n        const endpoint = `${proto}://${location.host}/ws/notifications/`;\r\n        let ws = null;\r\n        let reconnectDelay = 1000; // backoff start 1s\r\n        const maxDelay = 20000;    // cap at 20s\r\n        let lastRefreshAt = 0;\r\n\r\n        function scheduleReconnect(){\r\n          const delay = reconnectDelay;\r\n          reconnectDelay = Math.min(maxDelay, Math.floor(reconnectDelay * 1.8));\r\n          setTimeout(connect, delay);\r\n        }\r\n\r\n        function maybeRefresh(){\r\n          const now = Date.now();\r\n          if (now - lastRefreshAt < 800) return; // debounce bursts\r\n          lastRefreshAt = now;\r\n          refresh().catch(()=>{});\r\n        }\r\n\r\n        function connect(){\r\n          try {\r\n            ws = new WebSocket(endpoint);\r\n            ws.onopen = function(){\r\n              reconnectDelay = 1000;\r\n              // Pause 60s poller while WS is connected for snappier UX\r\n              try { if (root._poller) { clearInterval(root._poller); root._poller = null; } } catch(_){ }\r\n              try { window.__adminMgmtWS = ws; } catch(_){}\r\n            };\r\n            ws.onmessage = function(evt){\r\n              try {\r\n                const msg = JSON.parse(evt.data || '{}');\r\n                if (msg && msg.type === 'activity_log'){\r\n                  const p = msg.data || {};\r\n                  // Only refresh Admin Management on Table1-related events when detectable\r\n                  const tn = (p.table_name || '').toString();\r\n                  if (tn === 'Table1' || /admin/i.test(tn)) {\r\n                    maybeRefresh();\r\n                  } else {\r\n                    // Unknown table name; very low frequency fallback\r\n                    // Do not spam refresh for unrelated tables\r\n                  }\r\n                }\r\n              } catch(_){ }\r\n            };\r\n            ws.onerror = function(){ /* keep silent */ };\r\n            ws.onclose = function(){\r\n              // Resume 60s polling when WS drops\r\n              try { if (!root._poller) root._poller = setInterval(function(){ refresh().catch(()=>{}); }, 60000); } catch(_){ }\r\n              try { if (window.__adminMgmtWS === ws) { window.__adminMgmtWS = null; } } catch(_){}\r\n              scheduleReconnect();\r\n            };\r\n          } catch(_){ scheduleReconnect(); }\r\n        }\r\n\r\n        // Stagger slightly after initial fetch\r\n        setTimeout(connect, 300);\r\n      }\r\n    } catch(_){ /* ignore: polling remains */ }\r\n  }\r\n\r\n  function debounce(fn, wait){ let t; return function(){ const ctx=this, args=arguments; clearTimeout(t); t=setTimeout(function(){ fn.apply(ctx,args); }, wait); }; }\r\n\r\n  // Expose initializer for AJAX-injected partials\r\n  window.initAdminManagement = function(){ try { bind(); } catch(_){} };\r\n\r\n  // ------------------ Helpers: SVGs and Skeletons ------------------\r\n  function svgDot(color){\r\n    const cls = color === 'green' ? 'text-green-600' : 'text-red-600';\r\n    return `<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-4 h-4 ${cls}\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><circle cx=\"10\" cy=\"10\" r=\"6\" /></svg>`;\r\n  }\r\n  function svgIcon(name){\r\n    switch(name){\r\n      case 'chat':\r\n        return '<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M2 5.75A2.75 2.75 0 014.75 3h14.5A2.75 2.75 0 0122 5.75v8.5A2.75 2.75 0 0119.25 17H8.664l-3.66 3.05A1 1 0 013 19.25V17H4.75A2.75 2.75 0 012 14.25v-8.5z\"/></svg>';\r\n      case 'edit':\r\n        return '<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1.003 1.003 0 000-1.42l-2.34-2.34a1.003 1.003 0 00-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z\"/></svg>';\r\n      case 'trash':\r\n        return '<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M6 7h12v2H6V7zm1 3h10l-1 10H8L7 10zm3-5h4v2h-4V5z\"/></svg>';\r\n      case 'pause':\r\n        return '<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\"/></svg>';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n  function showSkeletons(root, n){\r\n    try {\r\n      const frag = document.createDocumentFragment();\r\n      for (let i=0;i<n;i++){\r\n        const sk = document.createElement('div');\r\n        sk.className = 'rounded-xl border shadow-sm p-4 bg-white dark:bg-gray-900 dark:border-gray-700 animate-pulse';\r\n        sk.innerHTML = `\r\n          <div class=\"h-4 w-20 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n          <div class=\"mt-3 space-y-2\">\r\n            <div class=\"h-5 w-40 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n            <div class=\"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n          </div>\r\n          <div class=\"mt-4 grid grid-cols-3 gap-2\">\r\n            <div class=\"h-8 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n            <div class=\"h-8 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n            <div class=\"h-8 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n          </div>`;\r\n        frag.appendChild(sk);\r\n      }\r\n      root.innerHTML = '';\r\n      root.appendChild(frag);\r\n    } catch(_) { }\r\n  }\r\n})();\r\n"],
  "mappings": "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",
  "names": ["qs", "sel", "root", "qsa", "csrf", "v", "name", "parts", "i", "c", "el", "notify", "msg", "type", "escapeHtml", "s", "div", "__adminsCache", "__nextUrl", "__adminFetchCtl", "getFocusable", "setupFocusTrap", "container", "onKeydown", "e", "f", "firstEl", "lastEl", "onFocusin", "focusables", "first", "last", "teardownFocusTrap", "openRecoverPasswordDialog", "u", "portal", "host", "uname", "ov", "box", "btnCancel", "btnSave", "inpNew", "inpConf", "errEl", "cleanup", "close", "ovl", "validate", "p", "ok_len", "ok_up", "ok_low", "ok_dig", "ok_sym", "ok_match", "policy", "ok", "btn", "onKey", "orig", "fd", "doFetch", "res", "data", "fetchAdmins", "q", "url", "removeAdminFromUI", "id", "grid", "card", "x", "openConfirmDialog", "opts", "title", "message", "confirmText", "confirmClass", "onConfirm", "resolve", "val", "onEsc", "overlay", "btnConfirm", "originalHtml", "err", "openProfileOverlay", "cardEl", "skeleton", "content", "svgIcon", "timeSince", "ov2", "box2", "populateExtraFields", "bindProfileOverlayHandlers", "closeBtn", "trig", "menu", "menuOpen", "closeMenu", "toggleMenu", "ev", "t", "view", "editForm", "b", "setEditActive", "act", "mode", "m", "okDel", "deleteAdmin", "pauseAdmin", "phone", "refresh", "active", "wrap", "known", "entries", "k", "frag", "pretty", "formatFieldValue", "row", "label", "value", "key", "fetchJson", "renderSummary", "results", "chip", "cls", "span", "list", "total", "online", "paused", "renderCards", "count", "buildAddCard", "actives", "disabled", "buildSectionHeader", "buildProfileCard", "renderLoadMore", "startAllTimers", "h", "prev", "loadMore", "openAddOverlay", "boxWrap", "closeAddOverlay", "escCloseOnce", "toggle", "newTheme", "form", "onSubmitAddForm", "statusLabel", "svgDot", "openEditOverlay", "editAdmin", "who", "showSkeletons", "pageResults", "timerHandle", "d", "date", "sec", "bind", "refreshBtn", "search", "debounce", "scheduleReconnect", "delay", "reconnectDelay", "maxDelay", "connect", "maybeRefresh", "now", "lastRefreshAt", "ws", "endpoint", "evt", "tn", "fn", "wait", "ctx", "args", "color", "n", "sk"]
}
