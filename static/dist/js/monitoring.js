(()=>{var n={metrics:{},init(){this.setupPerformanceObserver(),this.setupNetworkMonitoring(),this.setupErrorTracking(),this.trackPageMetrics()},setupPerformanceObserver(){new PerformanceObserver(r=>{for(let t of r.getEntries())this.recordMetric("performance",{name:t.name,duration:t.duration,startTime:t.startTime,entryType:t.entryType})}).observe({entryTypes:["paint","largest-contentful-paint","first-input"]})},setupNetworkMonitoring(){window.performance&&performance.getEntriesByType&&performance.getEntriesByType("resource").forEach(r=>{this.recordMetric("network",{name:r.name,duration:r.duration,size:r.transferSize,type:r.initiatorType})})},setupErrorTracking(){window.addEventListener("error",e=>{this.recordMetric("error",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,timestamp:new Date().toISOString()})})},trackPageMetrics(){window.addEventListener("load",()=>{let e=performance.timing,r={pageLoad:e.loadEventEnd-e.navigationStart,domReady:e.domComplete-e.domLoading,networkLatency:e.responseEnd-e.requestStart,processingTime:e.domComplete-e.responseEnd,backendTime:e.responseEnd-e.requestStart};this.recordMetric("page",r)})},recordMetric(e,r){this.metrics[e]||(this.metrics[e]=[]),this.metrics[e].push({...r,timestamp:new Date().toISOString()}),this.metrics[e].length>=10&&this.sendMetricsToServer(e)},async sendMetricsToServer(e){try{(await fetch("/api/metrics/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":document.querySelector("[name=csrfmiddlewaretoken]").value},body:JSON.stringify({category:e,metrics:this.metrics[e]})})).ok&&(this.metrics[e]=[])}catch(r){console.error("Failed to send metrics:",r)}}};document.addEventListener("DOMContentLoaded",()=>{n.init()});})();
//# sourceMappingURL=monitoring.js.map
