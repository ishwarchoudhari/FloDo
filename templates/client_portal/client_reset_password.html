{% extends "client_portal/base.html" %}
{% block title %}Reset Password{% endblock %}
{% block content %}
<section class="max-w-md mx-auto mt-8 font-semibold">
  <h1 class="text-2xl font-semibold mb-4">Reset password</h1>
  <form method="post" class="space-y-4 bg-white dark:bg-[#1f1f1f] border border-gray-200 dark:border-[#2a2a2a] rounded-2xl p-5 shadow-xl text-gray-900 dark:text-[#e5e5e5]">
    {% csrf_token %}
    <div>
      <label class="block text-sm text-gray-800 dark:text-[#e5e5e5]">New password</label>
      <!-- Added: password input with aria-describedby for strength hint -->
      <input id="reset-password" type="password" name="password" required aria-describedby="reset-pwd-hint" class="mt-1 w-full border rounded-full px-4 py-2.5 bg-white dark:bg-[#222222] border-gray-300 dark:border-[#333333] text-gray-900 dark:text-[#eaeaea] focus:outline-none focus:ring-2 focus:ring-emerald-500/60" />
      <!-- Added: simple strength meter bar (client-side UX only) -->
      <div class="mt-2" aria-live="polite"><!-- Added container for strength bar -->
        <div class="h-1.5 rounded-full bg-gray-200 dark:bg-[#2a2a2a] overflow-hidden"><!-- Added bar track -->
          <div id="reset-pwd-bar" class="h-1.5 bg-red-500 w-1/5 transition-all"></div><!-- Added bar fill -->
        </div>
        <p id="reset-pwd-hint" class="mt-1 text-xs text-gray-500">Use 8+ chars with upper, lower, number, and symbol.</p><!-- Added hint text -->
      </div>
    </div>
    <div class="flex items-center gap-3">
      <button class="px-5 py-2.5 rounded-full bg-emerald-600 text-white hover:bg-emerald-700">Update password</button>
    </div>
  </form>
</section>
{% block scripts %}
<!-- Added: tiny inline script to update strength meter (no backend impact) -->
<script nonce="{{ csp_nonce }}">
  // Added: update the strength bar in real-time
  (function(){
    function updateStrength(pwd){
      var score = 0; if(pwd.length >= 8) score++; if(/[a-z]/.test(pwd)) score++; if(/[A-Z]/.test(pwd)) score++; if(/\d/.test(pwd)) score++; if(/[^A-Za-z0-9]/.test(pwd)) score++;
      var bar = document.getElementById('reset-pwd-bar'); if(!bar) return;
      var widths = ['w-1/5','w-2/5','w-3/5','w-4/5','w-full'];
      bar.className = 'h-1.5 transition-all ' + (score<=2?'bg-red-500':score===3?'bg-amber-500':'bg-neutral-500') + ' ' + widths[Math.max(0, Math.min(score-1, 4))];
    }
    var input = document.getElementById('reset-password');
    if(input){ input.addEventListener('input', function(){ updateStrength(input.value||''); }); }
  })();
  </script>
{% endblock %}
{% endblock %}
